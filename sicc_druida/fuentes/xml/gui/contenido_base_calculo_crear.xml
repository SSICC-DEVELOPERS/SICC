<?xml version="1.0" encoding="ISO-8859-1" standalone="no"?>
<!--
   INDRA/CAR/sic3
   $Id: contenido_base_calculo_crear.xml,v 1.1 2009/12/03 18:44:21 pecbazalar Exp $
   contenido DTO

   DRUIDATARGET=/install/cvsiniciales
-->

<!DOCTYPE PAGINA SYSTEM "dtd/druida_3_0.dtd">

<PAGINA nombre="contenido_base_calculo_crear" cod="0664" titulo="Ingresar valores de descuento" 
estilos="estilosB3.css" colorf="#F0F0F0" msgle="" onload="onLoadPag();" xml:lang="es">

      <!--
           0233 Consultar descuentos
           0354 Modificar valores de descuentos
           0343 Eliminar descuentos
           0249 Crear valores de descuentos17/11/2005
           Inc 11034
           Se cambia el codigo 0249 por 0644
        --> 
        

<JAVASCRIPT>
  <![CDATA[ 
var arrLimpia = new Array();
    var btnBuscarHab = 'S';
    var vBCDM = 'N'; // Inicialmente No esta habilitado
    var vBCDUN= 'N';
    var vBCDN = 'N';
    var vBCDSG= 'N';
    var vBCDG = 'N';
    
	 var arrComboTipoOferta;
	 var arrComboCicloVida ;

    function onLoadPag()   {
		guardoConExito();
        DrdEnsanchaConMargenDcho('listado1',24);
        document.all["Cplistado1"].style.visibility='';
        document.all["CpLin1listado1"].style.visibility='';
        document.all["CpLin2listado1"].style.visibility='';
        document.all["CpLin3listado1"].style.visibility='';
        document.all["CpLin4listado1"].style.visibility='';
        document.all["separaDiv"].style.visibility='hidden';
        document.all["primera1Div"].style.visibility='hidden';
        document.all["ret1Div"].style.visibility='hidden';
        document.all["ava1Div"].style.visibility='hidden';
        document.all["btnBuscarDiv"].style.visibility='';
        document.all["btnEliminarDiv"].style.visibility='';
    
        DrdEnsanchaConMargenDcho('listado2',12);
        document.all["Cplistado2"].style.visibility='';
        document.all["CpLin1listado2"].style.visibility='';
        document.all["CpLin2listado2"].style.visibility='';
        document.all["CpLin3listado2"].style.visibility='';
        document.all["CpLin4listado2"].style.visibility='';
        document.all["separa2Div"].style.visibility='hidden';
        document.all["primera2Div"].style.visibility='hidden';
        document.all["ret2Div"].style.visibility='hidden';
        document.all["ava2Div"].style.visibility='hidden';
        document.all["btnSiguienteDiv"].style.visibility='';
		document.all["btnEliminar2Div"].style.visibility='';
        eval (ON_RSZ);  

        document.getElementById("InsertarP4").style.backgroundColor = "#496A9A";
        document.getElementById("InsertarP4").style.color = "#FFFFFF";
        
        seteaValoresMatriz();
        set('formulario.hidUltimoElementoEnLaLista','1');
        configurarMenuSecundario('formulario');
		fMostrarMensajeError();
        //btnProxy(1,'1');
        //btnProxy(4,'0');
		btnProxy(2,"1");
        
        if ( get('formulario.casoDeUso')=='consultar' || get('formulario.casoDeUso')=='modificar' ) {
			seleccionaComponenetes();
			if ( get('formulario.casoDeUso')=='consultar'){
               // btnProxy(1,'0');
                configurarPaginaConsulta();
                focalizaBotonHTML_XY('btnSiguiente');
            }
            if (get('formulario.casoDeUso')=='modificar' ){
                 if(get("formulario.VisibleBCDM")=="S")
                        marcaOnChange();
            }
        }
        else {
            set("formulario.cbTipoOferta",0);
            set("formulario.cbCicloVida",0);
        }
            
        tomarDatosPagina();    
        
        if(get("formulario.VisibleBCDM")=="S")
        {
            vBCDM = 'S';
        }

        if(get("formulario.VisibleBCDUN")=="S")
        {
            accion("formulario.cbUnidadNegocio",".disabled=true");
            vBCDUN = 'S';
        }
        if(get("formulario.VisibleBCDN")=="S")
        {
            accion("formulario.cbNegocio",".disabled=true");
            vBCDN = 'S';
        }
        if(get("formulario.VisibleBCDG")=="S")                
        {
            accion("formulario.cbGenerico",".disabled=true");
            vBCDG = 'S';
        }
        
        if(get("formulario.VisibleBCDSG")=="S")
        {
            accion("formulario.cbSupergenerico",".disabled=true");
            vBCDSG = 'S';
        }
        
        if ( get('formulario.casoDeUso')!='consultar')
            validaBotonBuscar();  


        marcaOnChange();
        
        if ( get('formulario.casoDeUso')!='consultar')
        {
            if(get("formulario.VisibleBCDM")=="S")
                focaliza("formulario.cbMarca");
            else
            if(get("formulario.VisibleBCDUN")=="S")
                focaliza("formulario.cbUnidadNegocio");
            else
            if(get("formulario.VisibleBCDN")=="S")
                focaliza("formulario.cbNegocio");               
            else
            if(get("formulario.VisibleBCDSG")=="S")
                focaliza("formulario.cbSupergenerico");
            else
            if(get("formulario.VisibleBCDG")=="S")                
                focaliza("formulario.cbGenerico");
            else            
                focaliza("formulario.ExclusionTipoOferta");
        }            
		onTabEliminar2();
    
    }

    function seteaValoresMatriz(){    
        //marca
        if(get("formulario.VisibleBCDM")=="N") {
			document.getElementById("lblMarca").style.visibility='hidden';        
            document.getElementById("cbMarca").style.visibility='hidden';        
		}
        if(get("formulario.ObligatorioBCDM")=="S")
                sicc_cambiar_estado("cbMarca",true);    
        if(get("formulario.ModificableBCDM")=="N")
                accion("formulario.cbMarca",".disabled=true");
            
        //unidad de negocio
        if(get("formulario.VisibleBCDUN")=="N") {
			document.getElementById("lblUnidadNegocio").style.visibility='hidden';        
            document.getElementById("cbUnidadNegocio").style.visibility='hidden';        
		}
        if(get("formulario.ObligatorioBCDUN")=="S")
                sicc_cambiar_estado("cbUnidadNegocio",true);        
        if(get("formulario.ModificableBCDUN")=="N")
                accion("formulario.cbUnidadNegocio",".disabled=true");    
            
        //negocio
        if(get("formulario.VisibleBCDN")=="N") {
			document.getElementById("lblNegocio").style.visibility='hidden';        
            document.getElementById("cbNegocio").style.visibility='hidden';        
		}
        if(get("formulario.ObligatorioBCDN")=="S")
                sicc_cambiar_estado("cbNegocio",true);        
        if(get("formulario.ModificableBCDN")=="N")
                accion("formulario.cbNegocio",".disabled=true");    
            
        //super generico
        if(get("formulario.VisibleBCDSG")=="N") {
			document.getElementById("lblSupergenerico").style.visibility='hidden';        
            document.getElementById("cbSupergenerico").style.visibility='hidden';        
		}        
        if(get("formulario.ObligatorioBCDSG")=="S") 
                sicc_cambiar_estado("cbSupergenerico",true);    
        if(get("formulario.ModificableBCDSG")=="N")
                accion("formulario.cbSupergenerico",".disabled=true");
            
        //generico
        if(get("formulario.VisibleBCDG")=="N") {
			document.getElementById("lblGenerico").style.visibility='hidden';        
            document.getElementById("cbGenerico").style.visibility='hidden';  
		}        
        if(get("formulario.ObligatorioBCDG")=="S") 
                sicc_cambiar_estado("cbGenerico",true);    
        if(get("formulario.ModificableBCDG")=="N")
                accion("formulario.cbGenerico",".disabled=true");            
    }

	function seleccionaComponenetes(){
			set("formulario.cbMarca",new Array(get("formulario.hidMarcasSel")));
			set("formulario.cbUnidadNegocio",new Array(get("formulario.hidUniNegSel")));
			set("formulario.cbNegocio",new Array(get("formulario.hidNegocioSel")));
			set("formulario.cbSupergenerico",new Array(get("formulario.hidSuperGenericoSel")));
			set("formulario.cbGenerico",new Array(get("formulario.hidGenericoSel")));
			//set("formulario.ExclusionTipoOferta",get("formulario.hidETO"));
			if(get("formulario.hidETO")=="true") set("formulario.ExclusionTipoOferta","S");
			  else set("formulario.ExclusionTipoOferta","N");
			
			var selTO = get("formulario.selTipoOferta"); 
			selTO = selTO.split(",");
			set("formulario.cbTipoOferta",selTO);
			var selCV = get("formulario.selCicloVida");
			selCV = selCV.split(",");
			set("formulario.cbCicloVida",selCV);
	}

    function configurarPaginaConsulta()
	{
		deshabilitarHabilitarBoton('botonContenido','btnBuscar','D');
		deshabilitarHabilitarBoton('botonContenido','btnEliminar','D');
		deshabilitarHabilitarBoton('botonContenido','btnAnadir','D');
		deshabilitarHabilitarBoton('botonContenido','btnEliminar2','D');
		accion('formulario.cbMarca','.disabled=true');
		accion('formulario.cbUnidadNegocio','.disabled=true');
		accion('formulario.cbNegocio','.disabled=true');
		accion('formulario.cbSupergenerico','.disabled=true');
		accion('formulario.cbGenerico','.disabled=true');
		accion('formulario.ExclusionTipoOferta','.disabled=true');
		
		//accion('formulario.cbTipoOferta','.disabled=true');
		//accion('formulario.cbCicloVida','.disabled=true');

		// incidencia DBLG500000573, permitir el scroll en el combo
		arrComboTipoOferta	  = get('formulario.cbTipoOferta'	);
		arrComboCicloVida	=	 get ('formulario.cbCicloVida');
    }
    
	 function cbTipoOfertaOnChange(){
	 	   if (get('formulario.casoDeUso')=='consultar' ){		
					set('formulario.cbTipoOferta',arrComboTipoOferta);	 
			}
	 }

	 function cbCicloVidaOnChange(){
	 	   if (get('formulario.casoDeUso')=='consultar' ){
					set('formulario.cbCicloVida',arrComboCicloVida);	 
			}
	 }

   function accionBuscarProductos() {
        if (!validaExclusion()){
            GestionarMensaje(1394,null,null,null);

            return false;
        }
        
        var obj = new Object();        
        obj.oidMarcaCorporativa = get('formulario.oidMarcaCorporativa');
        var whnd = mostrarModalSICC('LPBuscarProductosDTO','',obj,
                    null, 570);
        if(whnd!=null)
        {
            accion("formulario.cbMarca",".disabled=false");
            accion("formulario.cbUnidadNegocio",".disabled=false");
            accion("formulario.cbNegocio",".disabled=false");
            accion("formulario.cbGenerico",".disabled=false");
            accion("formulario.cbSupergenerico",".disabled=false");
        
            actualizaListado(whnd[0]);
            
            if (whnd[1] != '' && whnd[1] != null ) //Marca
            {
                set('formulario.cbMarca',whnd[1]);
            }
            
            if (whnd[2] != '' && whnd[2] != null ) //Unidad De Negocio
            {
                set('formulario.cbUnidadNegocio',whnd[2]);
            }

            accion("formulario.cbMarca",".disabled=true");
            accion("formulario.cbUnidadNegocio",".disabled=true");
            accion("formulario.cbNegocio",".disabled=true");
            accion("formulario.cbGenerico",".disabled=true");
            accion("formulario.cbSupergenerico",".disabled=true");     
        }
    }

	function actualizaListado(listaItems){
		var fila = listaItems.split('$');
		for(i=0;i<fila.length;i++){
			if (fila[i] != ''){
				var newRow = new Array();
				newRow = fila[i].split("|");
				listado1.insertar(newRow);
			}
		}
	}

	function actualizaListado2(){
	
	}

    function accionEliminar() {
        var vMostrarMensaje ='';
		var cantElementosL1 = listado1.codSeleccionados();		

		if ( cantElementosL1.length == 0){
			GestionarMensaje("4", null, null, null);
			return ;
		}
				
		if ( cantElementosL1.length > 0 )
        {
			listado1.eliminarSelecc();

            if(get("formulario.VisibleBCDM")=="S")
                accion("formulario.cbMarca",".disabled=false");
                
            if(get("formulario.VisibleBCDUN")=="S")
                accion("formulario.cbUnidadNegocio",".disabled=false");

            if(get("formulario.VisibleBCDN")=="S")
                accion("formulario.cbNegocio",".disabled=false");                

            if(get("formulario.VisibleBCDG")=="S")                
                accion("formulario.cbGenerico",".disabled=false");
            
            if(get("formulario.VisibleBCDSG")=="S")
                accion("formulario.cbSupergenerico",".disabled=false");

            if(btnBuscarHab =='N')
            {
                deshabilitarHabilitarBoton('botonContenido','btnBuscar','A');
                btnBuscarHab ='S';    
            }
        }
    }
   
	function accionEliminar2() {
        var vMostrarMensaje ='';
		var cantElementosL1 = listado2.codSeleccionados();		
  
		if ( cantElementosL1.length == 0){
			GestionarMensaje("4", null, null, null);
			return ;
		}
				
		if ( cantElementosL1.length > 0 )
			listado2.eliminarSelecc();
    }
  
  function accionAniadir(){
  
        var vExcluyeTipoOfe = get('formulario.ExclusionTipoOferta');
        var vTipoOfertaSel  = get('formulario.cbTipoOferta');

        var vCicloVidaSel   = get('formulario.cbCicloVida');
        
        if (vCicloVidaSel =='' || vCicloVidaSel == null)
        {
            GestionarMensaje('1201','Ciclo de Vida');
            focaliza('formulario.cbCicloVida');
            return false;
        }
        
        if (vExcluyeTipoOfe == 'N'){
          if(vTipoOfertaSel =='' || vTipoOfertaSel == null){
            GestionarMensaje('1415');
            focaliza('formulario.cbTipoOferta');
            return false;
          }
        }
        
        var codigo = listado1.codigos();
        
        if( codigo.length > 0  )
            armaCriterioDeProductos();
        else
            armaCriterioBloqueUno();
    }

  function armaCriterioBloqueUno() {
      
      var posi = parseInt(get('formulario.hidUltimoElementoEnLaLista'), 10);
      
      var codigo = listado2.generaCodigo( posi );
      //alert("codigo nuevo es: " + codigo);
      
      set('formulario.hidUltimoElementoEnLaLista', codigo);

            // ------------- Toma de datos -----------------
            var oidMarSel       = get('formulario.cbMarca','V');
            var desMarSel       = get('formulario.cbMarca','T');

            var oidUnidNegSel   = get('formulario.cbUnidadNegocio','V');
            var desUnidNegSel   = get('formulario.cbUnidadNegocio','T');

            var oidNegSel       = get('formulario.cbNegocio','V');
            var desNegSel       = get('formulario.cbNegocio','T');

            var oidSuperGenSel  = get('formulario.cbSupergenerico','V');
            var desSuperGenSel  = get('formulario.cbSupergenerico','T');

            var oidGenSel       = get('formulario.cbGenerico','V');
            var desGenSel       = get('formulario.cbGenerico','T');

            var vExcluyeTipoOfe = get('formulario.ExclusionTipoOferta');

            var vTipoOfertaSel  = get('formulario.cbTipoOferta');
            var vCicloVidaSel   = get('formulario.cbCicloVida');

                var oidT       = get('formulario.cbTipoOferta','V');
                var desT       = get('formulario.cbTipoOferta','T');
                var oidC       = get('formulario.cbCicloVida','V');
                var desC       = get('formulario.cbCicloVida','T');

            var vTope;
            
            if(vExcluyeTipoOfe =='N' && vTipoOfertaSel.length == 0){
                vTope = 1;
            }else{
                vTope = vTipoOfertaSel.length;
            }
            
            //jsilva
            //INCIDENCIA DBLG400000595
            if(vExcluyeTipoOfe=='S' && vTope==0){
            
                for (var j = 0; j < vCicloVidaSel.length; j++){
                      
                    if (oidC[j] != '' && oidC[j] !=null ){
                          
                        var datos = codigo + "|" + oidMarSel + "|" + desMarSel;
                        datos = datos + "|" + oidUnidNegSel + "|" + desUnidNegSel;
                        datos = datos + "|" + oidNegSel + "|" + desNegSel;
                        datos = datos + "|" + oidSuperGenSel + "|" + desSuperGenSel;
                        datos = datos + "|" + oidGenSel + "|" + desGenSel + "|" + vExcluyeTipoOfe;
                        datos = datos + "|" + '' + "|" + '';
                        
                        var oidCicloVida       = oidC[j];
                        var desCicloVida       = desC[j];
                        datos = datos + "|" + oidCicloVida + "|" + desCicloVida+ "|" +''+ "|" +'';

                        if (!existeFilaCriterio(datos)){
                          var newRow = new Array();
                          newRow = datos.split("|");
                          listado2.insertar(newRow);
                          codigo = listado2.generaCodigo(codigo);
                        }
                    }
                }
            
            }else{
            
                for (var i = 0; i < vTope; i++){
                  
                  var oidTipoOferta       = oidT[i];
                  var desTipoOferta       = desT[i];
                
                  for (var j = 0; j < vCicloVidaSel.length; j++){
                      
                      if (oidC[j] != '' && oidC[j] !=null )
                      {
                          var datos = codigo + "|" + oidMarSel + "|" + desMarSel;
                          datos = datos + "|" + oidUnidNegSel + "|" + desUnidNegSel;
                          datos = datos + "|" + oidNegSel + "|" + desNegSel;
                          datos = datos + "|" + oidSuperGenSel + "|" + desSuperGenSel;
                          datos = datos + "|" + oidGenSel + "|" + desGenSel + "|" + vExcluyeTipoOfe;
              
                          if (oidTipoOferta != null)
                              datos = datos + "|" + oidTipoOferta + "|" + desTipoOferta;
                          else
                              datos = datos + "|" + '' + "|" + '';
                  
                          var oidCicloVida       = oidC[j];
                          var desCicloVida       = desC[j];
                          datos = datos + "|" + oidCicloVida + "|" + desCicloVida+ "|" +''+ "|" +'';

                          if (!existeFilaCriterio(datos)){
                              var newRow = new Array();
                              newRow = datos.split("|");
                              listado2.insertar(newRow);
                              codigo = listado2.generaCodigo(codigo);
                          }
                      }
                  }
                }
            }
            
            
            var codigo = listado2.codigos();
            //alert("codigos del listado dps de ingresar una fila: " + codigo);
            
            
            set('formulario.hidUltimoElementoEnLaLista', codigo);
    
    }
    
    
    function existeFilaCriterio(datos)
    {
        var codigo = listado2.codigos();
        var newRow = new Array();
        newRow = datos.split("|");
        var flag = false;
        var a = 0;

        while( (a < codigo.length ) && (flag == false) ){
            
            if( newRow[1] ==listado2.extraeDato(codigo[a], 0)!="") {//oidMarca
              if( newRow[3] == cdos_trim(listado2.extraeDato(codigo[a], 2))){//oidUnidadNegocio
               if( newRow[5] == cdos_trim(listado2.extraeDato(codigo[a], 4))){//oidNegocio
                if( newRow[7] == cdos_trim(listado2.extraeDato(codigo[a], 6))){//oidSupergenerico
                 if( newRow[9] == cdos_trim(listado2.extraeDato(codigo[a], 8))){//oidGenerico
                  if( newRow[11] == cdos_trim(listado2.extraeDato(codigo[a], 10))){//Exclusión tipo oferta
                   if( newRow[12] == cdos_trim(listado2.extraeDato(codigo[a], 11))){//oidTipoOferta
                   if( newRow[14] == cdos_trim(listado2.extraeDato(codigo[a], 13))){//oidCicloVida
                        flag = true;
                   }
                  }
                 }
                }
               }
              }
             }
            }
            a++;
		}//while
        return flag;
    }

    function validaExclusion() {
        var codigo = listado1.codigos();
        if ( ( (get('formulario.cbMarca','V') != '') || 
					 (get('formulario.cbMarca','V') != '') ||
					 (get('formulario.cbUnidadNegocio','V') != '') ||
                (get('formulario.cbNegocio','V') != '') ||
					 (get('formulario.cbSupergenerico','V') != '') ||
					 (get('formulario.cbGenerico','V') !='' ))
                     ){
                     //&&(codigo.length > 0) ){

            return false;
        }
        return true;
    }

    function validaSeleccionDeValoresDeCombos(){
        //Tomar Oid seleccionados de los combos
        //-------------------------- M A R C A -------------------------------
		if ( (get('formulario.ObligatorioBCDM') == 'S') &&
			 (fValidarCOMBO('formulario.cbMarca')== false))
                return false;

		
		//----------------------- U N I D A D E S--------------------------
		if ( ( get('formulario.ObligatorioBCDUN') == 'S') &&
			 (fValidarCOMBO('formulario.cbUnidadNegocio') == false))
    			return false;
			
		//-------------------------- N E G O C I O ---------------------------
		if( ( get('formulario.ObligatorioBCDN') == 'S') &&
			 (fValidarCOMBO('formulario.cbNegocio')) )
    			return false;
	
		//--------------------- S U P E R G E N E R I C O --------------------
		if( ( get('formulario.ObligatorioBCDSG') == 'S')	&&
			(fValidarCOMBO('formulario.cbSupergenerico') == false) )
    			return false;	

		//------------------------ G E N E R I C O ---------------------------
		if( ( get('formulario.ObligatorioBCDG') == 'S') &&
			 (fValidarCOMBO('formulario.cbGenerico')== false) )
    			return false;

    }

    function armaCriterioDeProductos() {
      
      var cant = listado1.numSelecc();
		var cantTemporal = listado2.codigos().length;  // Cantidad de elementos en la lista destino
		var toAdd = "";
		var codigo = "";

		if ( cant == 0 ){
				GestionarMensaje('UIDTO0001');
		}else{
				codigo = listado1.codSeleccionados();
			
   				var posi = parseInt(get('formulario.hidUltimoElementoEnLaLista'), 10);
                for(var a = 0; a < codigo.length ; a++){
					var exTO= get("formulario.ExclusionTipoOferta");
					var to = get("formulario.cbTipoOferta");
					var toD = get("formulario.cbTipoOferta","T");
					var cv = get("formulario.cbCicloVida");
					var cvD = get("formulario.cbCicloVida","T");					
                    var datos = "";
					
                    datos = "||||||||||";                    
					datos = datos + "|" + exTO;

					//al no ser obligatorio el combo tipo oferta, al menos debo iterar una vez
					var numIterTiposOfertas = to.length;
					if (numIterTiposOfertas == 0) { 
						numIterTiposOfertas = 1;
						to = new Array("");
						toD = new Array("");
					}

					//itero sobre los valores del combo tipo oferta
					for(var j = 0; j < numIterTiposOfertas; j++){
						var datos1 = datos + "|" + to[j] + "|" + toD[j];

						//itero sobre los valores del combo ciclo vida
						for(var i = 0; i < cv.length; i++){
        					var codig = listado2.generaCodigo( posi);
							var dat = codig + datos1 + "|" + cv[i] + "|" + cvD[i] + "|" + codigo[a] + "|" + listado1.extraeDato(codigo[a], 0);
                            
							if(!existeFila(dat))
                            {
                                var newRow = new Array();
                                newRow = dat.split("|");
                                
                                listado2.insertar(newRow);
                                posi++;
                            }
						}
					}
                }
				GestionarMensaje("000000000000079", null,null,null);
		}

	}

       
    function existeFila(datos)
    {
        var codigo = listado2.codigos();
        var newRow = new Array();
        newRow = datos.split("|");
        var flag = false;
        var a = 0;
        
        while( (a < codigo.length ) && (flag == false) ){
            
            if( newRow[11] == cdos_trim(listado2.extraeDato(codigo[a], 10)) )
            {////Exclusión tipo oferta
                if( newRow[12] == cdos_trim(listado2.extraeDato(codigo[a], 11)))
                {//oidTipoOferta
                    if( newRow[14] == cdos_trim(listado2.extraeDato(codigo[a], 13)))
                    {//oidCicloVida
                        if( newRow[16] == cdos_trim(listado2.extraeDato(codigo[a], 15)))
                        {//oidProducto
                            flag = true;
                        }
                    }
                }
            }
            a++;
		}//while
        return flag;
    }

    function pasaListaTemporal(codigo, dato){
        var codigosTemporal = listado2.codigos();
        var match = rowMatch(codigo, codigosTemporal);
        if (match){
            //   muestraMsg = true;
        }else{
				var dat = verificoCampos();
            //datos = codigo + "|" + dat + "|" + datos;  // Agrega el codigo al String de valores. 
				datos = codigo;
				datos = datos + "|";    //oidMarca
				datos = datos + "|";
				datos = datos + "|";
				datos = datos + "|";    //oidUnidadNegocio
				datos = datos + "|";
            datos = datos + "|";    //oidNegocio
				datos = datos + "|";
            datos = datos + "|";    //oidSupergenerico
				datos = datos + "|";
            datos = datos + "|";    //oidGenerico
            datos = datos + "|" + dat;  
            datos = datos + "|" + dato;
				
            var newRow = new Array();
            newRow = datos.split("|");
				
            listado2.insertar(newRow);
        }
    }

	 function verificoCampos(){
			var exTO= get("formulario.ExclusionTipoOferta");
			var to = get("formulario.cbTipoOferta");
			var toD = get("formulario.cbTipoOferta","T");
			var cv = get("formulario.cbCicloVida");
			var cvD = get("formulario.cbCicloVida","T");
			var dat  = exTO + "|" + to + "|" + toD + "|" + cv  + "|" + cvD;
			
			return dat;
	 }

	function rowMatch(codigo, codigosTemporal){
        var flag = false;
        var i = 0;
        while ( (i < codigosTemporal.length) && (flag == false) ){
            if ( codigo == codigosTemporal[i] )
                flag = true;	
            i++;
        }
        return flag;
    }

    function tomaValoresListaCriterios() {
        if(sicc_validaciones_generales()) {  
            var listadoSeleccionado = '';
            if (listado2.datos.length > 0) {
                listadoSeleccionado = listado2string();
                set('formulario.hidDetalleCriterios', listadoSeleccionado);
				
				var productos = productos2string();
				set('formulario.hidDetalleProductos', productos);

                return true;
            }
        }
        else { 
			return false;
		}
    }

	function productos2string() {
		var codigo = listado1.codigos();
		var total = "";

		for(var a = 0; a < codigo.length ; a++){
    		var toAdd = "";

	        toAdd = "oid:"+ codigo[a];

		    if(listado1.extraeDato(codigo[a], 0)!= null && listado1.extraeDato(codigo[a], 0)!="")
			  toAdd = toAdd + "|" + "codigosap:" + listado1.extraeDato(codigo[a], 0);    //codigo sap

			if(listado1.extraeDato(codigo[a], 1)!= null && listado1.extraeDato(codigo[a], 1)!="")
		      toAdd = toAdd + "|" + "descripcion:"  + listado1.extraeDato(codigo[a], 1);    //descripcion
		
			total = total + "$" + toAdd;
		}	
		return total;
	}

    function listado2string(){
      var codigo = listado2.codigos();
      var total = "";
      for(var a = 0; a < codigo.length ; a++){
    		var toAdd = "";

        toAdd = "oid:"+ codigo[a];

        if(listado2.extraeDato(codigo[a], 0)!= null && listado2.extraeDato(codigo[a], 0)!="")
          toAdd = toAdd + "|" + "m:" + listado2.extraeDato(codigo[a], 0);    //oidMarca

		if(listado2.extraeDato(codigo[a], 2)!= null && listado2.extraeDato(codigo[a], 2)!="")
          toAdd = toAdd + "|" + "un:"  + listado2.extraeDato(codigo[a], 2);    //oidUnidadNegocio
        
		if(listado2.extraeDato(codigo[a], 4)!= null && listado2.extraeDato(codigo[a], 4)!="")
           toAdd = toAdd + "|" + "n:"  + listado2.extraeDato(codigo[a], 4);    //oidNegocio
        
		if(listado2.extraeDato(codigo[a], 6)!= null && listado2.extraeDato(codigo[a], 6)!="")
           toAdd = toAdd + "|" + "sg:"  + listado2.extraeDato(codigo[a], 6);    //oidSupergenerico
        
		if(listado2.extraeDato(codigo[a], 8)!= null && listado2.extraeDato(codigo[a], 8)!="")
           toAdd = toAdd + "|" + "g:"  + listado2.extraeDato(codigo[a], 8);    //oidGenerico
        
		if(listado2.extraeDato(codigo[a], 10)!= null && listado2.extraeDato(codigo[a], 10)!="")
           toAdd = toAdd + "|" + "eto:"  + listado2.extraeDato(codigo[a], 10);   //Exclusión tipo oferta
        
		if(listado2.extraeDato(codigo[a], 11)!= null && listado2.extraeDato(codigo[a], 11)!="")
           toAdd = toAdd + "|" + "to:"  + listado2.extraeDato(codigo[a], 11);   //oidTipoOferta
        
		if(listado2.extraeDato(codigo[a], 13)!= null && listado2.extraeDato(codigo[a], 13)!="")
           toAdd = toAdd + "|" + "cv:"  + listado2.extraeDato(codigo[a], 13);   //oidCicloVida
        
		if(listado2.extraeDato(codigo[a], 15)!= null && listado2.extraeDato(codigo[a], 15)!="")
	         toAdd = toAdd + "|" + "pr:"  + listado2.extraeDato(codigo[a], 15);   //oidProducto

		if(listado2.extraeDato(codigo[a], 1)!= null && listado2.extraeDato(codigo[a], 1)!="")
	         toAdd = toAdd + "|" + "descmarca:"  + listado2.extraeDato(codigo[a], 1);   //descripcion Marca

		if(listado2.extraeDato(codigo[a], 3)!= null && listado2.extraeDato(codigo[a], 3)!="")
	         toAdd = toAdd + "|" + "descunidad:"  + listado2.extraeDato(codigo[a], 3);   //descripcion unidad negocio

		if(listado2.extraeDato(codigo[a], 5)!= null && listado2.extraeDato(codigo[a], 5)!="")
	         toAdd = toAdd + "|" + "descnegocio:"  + listado2.extraeDato(codigo[a], 5);   //descripcion negocio

		if(listado2.extraeDato(codigo[a], 7)!= null && listado2.extraeDato(codigo[a], 7)!="")
	         toAdd = toAdd + "|" + "descsuper:"  + listado2.extraeDato(codigo[a], 7);   //descripcion supergenerico
		
		if(listado2.extraeDato(codigo[a], 9)!= null && listado2.extraeDato(codigo[a], 9)!="")
	         toAdd = toAdd + "|" + "descgenerico:"  + listado2.extraeDato(codigo[a], 9);   //descripcion generico

		if(listado2.extraeDato(codigo[a], 12)!= null && listado2.extraeDato(codigo[a], 12)!="")
	         toAdd = toAdd + "|" + "desctipo:"  + listado2.extraeDato(codigo[a], 12);   //descripcion tipo oferta

		if(listado2.extraeDato(codigo[a], 14)!= null && listado2.extraeDato(codigo[a], 14)!="")
	         toAdd = toAdd + "|" + "descciclo:"  + listado2.extraeDato(codigo[a], 14);   //descripcion ciclo vida

		if(listado2.extraeDato(codigo[a], 16)!= null && listado2.extraeDato(codigo[a], 16)!="")
	         toAdd = toAdd + "|" + "descproducto:"  + listado2.extraeDato(codigo[a], 16);   //descripcion producto
		
		total = total + "$" + toAdd;
		}	
		return total;
	}

    function fGuardar(){
      
          accionGuardar();
    }

	function accionSiguiente(){
    //Llamar a la LPMantenimientoBaseCalculo, Acción "siguiente"
        if (validacion())
        {
            ponerEnFalseTodos();
            tomaValoresListaCriterios();
            set('formulario.conectorAction', 'LPMantenimientoBaseCalculo');
            set('formulario.accion', 'siguiente');
            /*if  (get('formulario.casoDeUso') != 'consultar'){
              eval('formulario').oculto="S"; 
            }*/
            enviaSICC('formulario');
        }
  } 
   
    function tomarDatosPagina(){
			arrLimpia[0] = get("formulario.cbMarca");
			arrLimpia[1] = get("formulario.cbUnidadNegocio");
			arrLimpia[2] = get("formulario.cbNegocio");
			arrLimpia[3] = get("formulario.cbSupergenerico");
			arrLimpia[4] = get("formulario.cbGenerico");
			arrLimpia[5] = get("formulario.cbTipoOferta");
			arrLimpia[6] = get("formulario.cbCicloVida");
			arrLimpia[7] = get("formulario.ExclusionTipoOferta");
	 }

    function fLimpiar()
    {
        if (get('formulario.casoDeUso') != 'consultar' ){
            set("formulario.cbMarca",new Array(arrLimpia[0]));			
			set("formulario.cbUnidadNegocio",new Array(arrLimpia[1]));
			set("formulario.cbNegocio",new Array(arrLimpia[2]));
			set("formulario.cbSupergenerico",new Array(arrLimpia[3]));
			set("formulario.cbGenerico",new Array(arrLimpia[4]));
			set("formulario.cbTipoOferta",arrLimpia[5]);
			set("formulario.cbCicloVida",arrLimpia[6]);
			set("formulario.ExclusionTipoOferta",arrLimpia[7]);

            seteaValoresMatriz();
            
            if(get("formulario.VisibleBCDM")=="S"){
                focaliza("formulario.cbMarca");
            }
            else
            {
                if(get("formulario.VisibleBCDUN")=="S")
                    focaliza("formulario.cbUnidadNegocio");
                else if(get("formulario.VisibleBCDN")=="S")
                    focaliza("formulario.cbNegocio");
                else if(get("formulario.VisibleBCDG")=="S")                
                    focaliza("formulario.cbGenerico");
                else if(get("formulario.VisibleBCDSG")=="S")
                    focaliza("formulario.cbSupergenerico");
            }
        }
        deshabilitarHabilitarBoton('botonContenido','btnBuscar','A');
    }

    function accionMensajeDeExito(){
		if (get("formulario.accion") == "siguiente"){
			eval('formulario').oculto="N"; 
			set("formulario.conectorAction","LPMantenimientoBaseAplicacion");
			set("formulario.accion","");
			set("formulario.casoDeUso","modificar");
			enviaSICC("formulario");
		} else {
			window.close();
		}
        //GestionarMensaje("1282",null,null,null);
    }

	function accionError(){
		eval('formulario').oculto="N"; 
	}

	   function fVolver(){
		onClickPestanya('2');
		
		/*window.close();
        set("formulario.conectorAction","LPMantenimientoDTO");
        set("formulario.accion","volver");
        enviaSICC("formulario");*/
    }

    function navegaPestaniasDetalle(pestanya)
    {
        if (validacion())
        {
            tomaValoresListaCriterios();        
            set('formulario.conectorAction', 'LPMantenimientoBaseCalculo');
            set('formulario.accion', 'siguiente');
            if (pestanya == 4)
            {
                set("formulario.hidPestanya", "4");
                enviaSICC('formulario');  
            }
        }  
    }
    
    function cambiaEstado(){
        if(get('formulario.ExclusionTipoOferta')=='S')
   			sicc_cambiar_estado("cbTipoOferta",true);   
        else sicc_cambiar_estado("cbTipoOferta",false);       
   }

    function marcaOnChange()
    {
        var oidMarSel       = get('formulario.cbMarca','V');
        if ( oidMarSel!='' && oidMarSel != null )
        {
            if(get("formulario.VisibleBCDUN")=="S")
            {
                accion("formulario.cbUnidadNegocio",".disabled=false");
                vBCDUN = 'N';
            }
            
            if(get("formulario.VisibleBCDG")=="S")
            {
                accion("formulario.cbGenerico",".disabled=false");
                vBCDG= 'N';
            }
            
            if(get("formulario.VisibleBCDSG")=="S")
            {
                accion("formulario.cbSupergenerico",".disabled=false");
                vBCDSG= 'N';
            }
                
            deshabilitarHabilitarBoton('botonContenido','btnBuscar','D');
            btnBuscarHab ='N';
        }
        else
        {
            var datosNuevo = new Array();
            datosNuevo[0] = ["",""];    
            set("formulario.cbUnidadNegocio", datosNuevo);
            set("formulario.cbGenerico", datosNuevo);
            set("formulario.cbSupergenerico", datosNuevo);

            if(get("formulario.VisibleBCDUN")=="S")
            {
                accion("formulario.cbUnidadNegocio",".disabled=true");
                vBCDUN= 'S';
            }
            
            if(get("formulario.VisibleBCDG")=="S")  
            {
                accion("formulario.cbGenerico",".disabled=true");
                vBCDG= 'S';
            }
            
            if(get("formulario.VisibleBCDSG")=="S")
            {
                accion("formulario.cbSupergenerico",".disabled=true");
                vBCDSG= 'S';
            }
            unidadNegocioOnChange();    
        }
        NegocioOnChange();
    }

    function unidadNegocioOnChange()
    {
        var oidUniNegSel       = get('formulario.cbUnidadNegocio','V');
        if ( oidUniNegSel!='' && oidUniNegSel != null )
        {
            if(get("formulario.VisibleBCDN")=="S")
            {
                accion("formulario.cbNegocio",".disabled=false");
                vBCDN ="N";
            }

            btnBuscarHab ='N';    
        }
        else
        {
            var datosNuevo = new Array();
            datosNuevo[0] = ["",""];            
            set("formulario.cbNegocio", datosNuevo);
            if(get("formulario.VisibleBCDN")=="S")
            {
                accion("formulario.cbNegocio",".disabled=true");
                vBCDN ="S";
            }
        }
        NegocioOnChange();
    }

    function NegocioOnChange()
    {
        validaBotonBuscar();
    }

    function validaBotonBuscar()
    {
        var oidUniNegSel       = get('formulario.cbUnidadNegocio','V');
        var oidMarca = get('formulario.cbMarca','V');
        var oidNegocio = get('formulario.cbNegocio','V');
        var oidGenerico = get('formulario.cbGenerico','V');
        var oidSuperGen = get('formulario.cbSupergenerico','V');
        
        if(get("formulario.VisibleBCDP")=="S"){
            if( 
            ( oidMarca!='' && oidMarca != null ) ||
            ( oidUniNegSel!='' && oidUniNegSel != null ) ||
            ( oidGenerico!='' && oidGenerico != null ) ||
            ( oidNegocio!='' && oidNegocio != null ) ||
            ( oidSuperGen!='' && oidSuperGen != null ) )
            {
                deshabilitarHabilitarBoton('botonContenido','btnBuscar','D');
                btnBuscarHab ='N';
            }
            else
            {
                if( 
                    ( oidMarca == '' ) &&  ( oidUniNegSel == '' ) &&
                    ( oidGenerico == '' ) &&  ( oidNegocio == '' ) &&
                    ( oidSuperGen == '' ) )
                    {
                        deshabilitarHabilitarBoton('botonContenido','btnBuscar','A');
                        btnBuscarHab ='S';
                    }
            }
        }
        else{
                deshabilitarHabilitarBoton('botonContenido','btnBuscar','D');
                btnBuscarHab ='N';
            }
    }

    function SuperGenericoOnChange()
    {
        if(btnBuscarHab =='N')
            NegocioOnChange();
    }

    function GenericoOnChange()
    {
        if(btnBuscarHab =='N')
            NegocioOnChange();
    }


    /*-------- Inc 11429 -------*/
    function accionGuardar()
    {
        if (validacion())
        {
            
            ponerEnFalseTodos();
            tomaValoresListaCriterios();
            set('formulario.conectorAction', 'LPMantenimientoBaseCalculo');
            //eval('formulario').oculto="S"; 
            set('formulario.accion', 'guardarBaseCalculo');
            enviaSICC('formulario');
        }
    }
    
    function validacion()
    {
        if (validarCriteriosSeleccionados()) 
            return true; 
        else 
            return false;
    }
    
    function validarCriteriosSeleccionados()
    {
        if (listado2.datos.length == 0)
        {
            GestionarMensaje("1442");
            return false;
        }
        else
            return true;
    }
    /*-------- Inc 11429 -------*/

    function onTabEliminar()
    {
        if (btnBuscarHab == 'N')
        {
            focalizaBotonHTML('botonContenido','btnAnadir');
        }
        else
        {
            focalizaBotonHTML('botonContenido','btnBuscar');
        }
    }

    function onShTabAnadir()
    {
        if (btnBuscarHab == 'N')
        {
            focalizaBotonHTML('botonContenido','btnEliminar');
        }
        else
        {
            focalizaBotonHTML('botonContenido','btnBuscar');
        }
    }


    function onTabSiguiente()
    {
        if (get('formulario.casoDeUso') != 'consultar' )
            focalizaBotonHTML('botonContenido','btnEliminar2');
        else
            focalizaBotonHTML_XY('btnSiguiente');    
    }
    
    function onShTabSiguiente()
    {
        if (get('formulario.casoDeUso') != 'consultar' )
            focalizaBotonHTML('botonContenido','btnAnadir');
        else
            focalizaBotonHTML_XY('btnSiguiente');
    }

    function onTabEliminar2() {
        if ( get('formulario.casoDeUso')!='consultar') {
			if(document.getElementById("cbMarca").style.visibility!='hidden') {
				if(document.getElementById("cbMarca").disabled!=true) {
					focaliza("formulario.cbMarca");
				}
				else {
					ontabComboMarca();
				}
			}
			else {
				ontabComboMarca();
			}
        }
    }

    function onShTabExclusionTipoOferta()
    {
        if ( get('formulario.casoDeUso')!='consultar')
        {
            /*if(get("formulario.VisibleBCDG")=="S")                
                focaliza("formulario.cbGenerico");
            else
            if(get("formulario.VisibleBCDSG")=="S")
                focaliza("formulario.cbSupergenerico");                
            else
             if(get("formulario.VisibleBCDN")=="S")
                focaliza("formulario.cbNegocio");               
            else 
            if(get("formulario.VisibleBCDUN")=="S")
                focaliza("formulario.cbUnidadNegocio");
            else
             if(get("formulario.VisibleBCDM")=="S")
                focaliza("formulario.cbMarca");*/
             if( vBCDG == 'N' )
               focaliza("formulario.cbGenerico");
            else
            if( vBCDSG == 'N' )
                focaliza("formulario.cbSupergenerico");
            else
            if( vBCDN == 'N')
                focaliza("formulario.cbNegocio");
            else
            if( vBCDUN == 'N')
                focaliza("formulario.cbUnidadNegocio");
            else            
            if( vBCDM == 'N')
                focaliza("formulario.cbMarca");   
             else   
                focalizaBotonHTML('botonContenido','btnEliminar2');
        }
    }

	//Agregado por Cristian Valenzuela - 8/11/2005
	//(Cambios de incidencia BELC300014763)
	function onClickPestanya(pestanya) {		
		set("formulario.idPestanyaDest", pestanya);

		if ( get('formulario.casoDeUso')!='consultar'){
			
      if(validacion()) {
      	ponerEnFalseTodos();
        tomaValoresListaCriterios();
				set('formulario.conectorAction', 'LPMantenimientoBaseCalculo');
				set('formulario.accion', 'almacenar');              
				enviaSICC('formulario');
			}			
		}
		else {
			set('formulario.conectorAction', 'LPMantenimientoBaseCalculo');
			set('formulario.accion', 'redirigir');              
			enviaSICC('formulario');
		}
	}

	
  function ponerEnFalseTodos(){
    
    sicc_cambiar_estado("cbMarca",false);
    sicc_cambiar_estado("cbUnidadNegocio",false);
    sicc_cambiar_estado("cbNegocio",false);
    sicc_cambiar_estado("cbSupergenerico",false);
    sicc_cambiar_estado("cbGenerico",false);
    sicc_cambiar_estado("cbTipoOferta",false);
    sicc_cambiar_estado("cbCicloVida",false);
    
  }
  
  function ontabComboMarca() {
		if(document.getElementById("cbUnidadNegocio").style.visibility!='hidden') {
			if(document.getElementById("cbUnidadNegocio").disabled!=true) {
				focaliza("formulario.cbUnidadNegocio");
			}
			else {
				ontabComboUnidadNegocio();
			}
		}
		else {
			ontabComboUnidadNegocio();
		}
	}

	function ontabComboUnidadNegocio() {
		if(document.getElementById("cbNegocio").style.visibility!='hidden') {
			if(document.getElementById("cbNegocio").disabled!=true) {
				focaliza("formulario.cbNegocio");
			}
			else {
				ontabComboNegocio();
			}
		}
		else {
			ontabComboNegocio();
		}		
	}

	function ontabComboNegocio() {
		if(document.getElementById("cbSupergenerico").style.visibility!='hidden') {
			if(document.getElementById("cbSupergenerico").disabled!=true) {
				focaliza("formulario.cbSupergenerico");
			}
			else {
				ontabComboSuperGenerico();
			}
		}
		else {
			ontabComboSuperGenerico();
		}		
	}

	function ontabComboSuperGenerico() {
		if(document.getElementById("cbGenerico").style.visibility!='hidden') {
			if(document.getElementById("cbGenerico").disabled!=true) {
				focaliza("formulario.cbGenerico");
			}
			else {
				ontabComboGenerico();
			}
		}
		else {
			ontabComboGenerico();
		}		
	}

	function ontabComboGenerico() {
	    focaliza("formulario.ExclusionTipoOferta");
	}

	function onshtabCicloVida() {
		if(document.getElementById("cbTipoOferta").style.visibility!='hidden') {
			if(document.getElementById("cbTipoOferta").disabled!=true) {
				focaliza("formulario.cbTipoOferta");
			}
			else {
				onshtabTipoOferta();
			}
		}
		else {
			onshtabTipoOferta();
		}				
	}

	function onshtabTipoOferta() {
		if(document.getElementById("ExclusionTipoOferta").style.visibility!='hidden') {
			if(document.getElementById("ExclusionTipoOferta").disabled!=true) {
				focaliza("formulario.ExclusionTipoOferta");
			}
			else {
				onshtabExclusionTipoOferta();
			}
		}
		else {
			onshtabExclusionTipoOferta();
		}			
	}

	function onshtabExclusionTipoOferta() {
		if(document.getElementById("cbGenerico").style.visibility!='hidden') {
			if(document.getElementById("cbGenerico").disabled!=true) {
				focaliza("formulario.cbGenerico");
			}
			else {
				onshtabGenerico();
			}
		}
		else {
			onshtabGenerico();
		}			
	}

	function onshtabGenerico() {
		if(document.getElementById("cbSupergenerico").style.visibility!='hidden') {
			if(document.getElementById("cbSupergenerico").disabled!=true) {
				focaliza("formulario.cbSupergenerico");
			}
			else {
				onshtabSuperGenerico();
			}
		}
		else {
			onshtabSuperGenerico();
		}			
	}

	function onshtabSuperGenerico() {
		if(document.getElementById("cbNegocio").style.visibility!='hidden') {
			if(document.getElementById("cbNegocio").disabled!=true) {
				focaliza("formulario.cbNegocio");
			}
			else {
				onshtabNegocio();
			}
		}
		else {
			onshtabNegocio();
		}		
	}

	function onshtabNegocio() {
		if(document.getElementById("cbUnidadNegocio").style.visibility!='hidden') {
			if(document.getElementById("cbUnidadNegocio").disabled!=true) {
				focaliza("formulario.cbUnidadNegocio");
			}
			else {
				onshtabUnidadNegocio();
			}
		}
		else {
			onshtabUnidadNegocio();
		}		
	}

	function onshtabUnidadNegocio() {
		if(document.getElementById("cbMarca").style.visibility!='hidden') {
			if(document.getElementById("cbMarca").disabled!=true) {
				focaliza("formulario.cbMarca");
			}
			else {
				onshtabMarca();
			}
		}
		else {
			onshtabMarca();
		}		
	}

	function onshtabMarca() {
		focalizaBotonHTML('botonContenido','btnEliminar2')
	}
    
  ]]> 
</JAVASCRIPT>
    <JS src="sicc_util.js" />
    <JS src="PaginacionSicc.js"/>
    <JS src="utilidadesIngresarDesc.js"/>
    <JS src="utilidadesDTO.js"/>

 <VALIDACION>
      <ELEMENTO name="cbMarca" required="false" cod="2448" />
      <ELEMENTO name="cbUnidadNegocio" required="false" cod="537" />
      <ELEMENTO name="cbNegocio" required="false" cod="588" />
      <ELEMENTO name="cbSupergenerico" required="false" cod="590" />
      <ELEMENTO name="cbGenerico" required="false" cod="589" />
      <!--<ELEMENTO name="cbTipoOferta" required="false" cod="608" />-->
      <ELEMENTO name="cbCicloVida" required="false" cod="581" />
</VALIDACION> 
<FORMULARIO nombre="formulario" oculto="N">       
    <VAR nombre="idPestanyaDest" valor=""/>
    <VAR nombre="conectorAction" valor=""/>
    <VAR nombre="accion" valor=""/>
	<VAR nombre="errCodigo" valor=""/>
	<VAR nombre="errDescripcion" valor=""/>
	<VAR nombre="hidOidBase" valor=""/>
	<VAR nombre="hidOidDescuento" valor=""/>
	<VAR nombre="casoDeUso" valor=""/>
    <!-- Variable para manejar la selección de la lista de criterios-->
	<VAR nombre="hidDetalleCriterios" valor=""/>    
	<VAR nombre="hidDetalleProductos" valor=""/>    
	
	<!-- <VAR nombre="varNoLimpiarSICC" valor="true"/> 
    -->
	<VAR nombre="hExito" valor=""/>

	<VAR nombre="hidMarcasSel" valor=""/>
	<VAR nombre="hidUniNegSel" valor=""/>
	<VAR nombre="hidNegocioSel" valor=""/>
	<VAR nombre="hidSuperGenericoSel" valor=""/>
	<VAR nombre="hidGenericoSel" valor=""/>
	<VAR nombre="hidETO" valor=""/>
	<VAR nombre="selTipoOferta" valor=""/>
	<VAR nombre="selCicloVida" valor=""/>

    <VAR nombre="VisibleBCDM" valor=""/>
    <VAR nombre="ObligatorioBCDM" valor=""/>
    <VAR nombre="ModificableBCDM" valor=""/>
    <VAR nombre="VisibleBCDUN" valor=""/> 
    <VAR nombre="ObligatorioBCDUN" valor=""/>
    <VAR nombre="ModificableBCDUN" valor=""/>
    <VAR nombre="VisibleBCDN" valor=""/>
    <VAR nombre="ObligatorioBCDN" valor=""/>
    <VAR nombre="ModificableBCDN" valor=""/>
    <VAR nombre="VisibleBCDSG" valor=""/>
    <VAR nombre="ObligatorioBCDSG" valor=""/> 
    <VAR nombre="ModificableBCDSG" valor=""/>
    <VAR nombre="VisibleBCDG" valor=""/> 
    <VAR nombre="ObligatorioBCDG" valor=""/> 
    <VAR nombre="ModificableBCDG" valor=""/>
    <VAR nombre="VisibleBCDP" valor=""/> 
    <VAR nombre="ObligatorioBCDP" valor=""/>
    <VAR nombre="ModificableBCDP" valor=""/>
    <!-- Variable para mantener los codigos de los elementos en la lista -->
   <VAR nombre="hidUltimoElementoEnLaLista" valor="0"/>
    <VAR nombre="oidMarcaCorporativa" valor="0"/>

    <CAPA nombre="capaTamanyo">

    

   <!-- Codigo para armar las pestañas -->

 <table  bgcolor="red" width="100%" height="100%" border="0" align="center" cellpadding="0" cellspacing="0" class="menu5">
  <tr> 
    <td width="12" nowrap="nowrap" class="menu5texto"><IMG src="b.gif" width="12" height="10"/></td>
    <td nowrap="nowrap" class="menu5texto">&nbsp;</td>
    <td width="10" nowrap="nowrap" class="menu5texto"><IMG src="b.gif" width="10" height="0"/></td>
    <td width="10" class="menu5texto"><IMG src="b.gif" width="10" height="8"/></td>
    <td width="20" nowrap="nowrap" class="menu5texto">
	<table width="75" border="0" align="center" cellpadding="1" cellspacing="0" bordercolor="#496A9A">
        <tr align="center"> 
          <td nowrap="nowrap" class="menu5textonegrita">
	    <a href="#">
		<DIV ID="InsertarP1" 
		onmouseover="poneManito('InsertarP1');"
        onclick="onClickPestanya('0')" 
        style="width:80px;border-style:solid; border-color:#496A9A;border-width:2px;position:relative;top:3px;text-align:center;color:#496A9A;font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: bold; visibility:visible">Datos generales</DIV>
	    </a>
	    </td>
        </tr>
      </table>
   </td>     
    <td width="10" class="menu5texto"><IMG src="b.gif" width="10" height="8"/></td>
    <td width="20" nowrap="nowrap" class="menu5texto">
    <table width="75" border="0" align="center" cellpadding="1" cellspacing="0" bordercolor="#496A9A">
        <tr align="center"> 
          <td nowrap="nowrap" class="menu5textonegrita">
	    <DIV ID="InsertarP2" 
		onmouseover="poneManito('InsertarP2');"
        onclick="onClickPestanya('1')"
        style="width:80px;border-style:solid; border-color:#496A9A;border-width:2px;position:relative;top:3px;text-align:center;color:#496A9A;font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: bold; visibility:visible">Tipo de cliente</DIV>
	    </td>
        </tr>
      </table>
   </td>
    <td width="10" class="menu5texto"><IMG src="b.gif" width="10" height="8"/></td>
    <td width="20" nowrap="nowrap" class="menu5texto">
    <table width="75" border="0" align="center" cellpadding="1" cellspacing="0" bordercolor="#496A9A">
        <tr align="center"> 
          <td nowrap="nowrap"  class="menu5textonegrita">
	    <DIV ID="InsertarP3" 
		onmouseover="poneManito('InsertarP3');"
        onclick="onClickPestanya('2')" 
        style="width:80px;border-style:solid; border-color:#496A9A;border-width:2px;position:relative;top:3px;text-align:center;color:#496A9A;font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: bold; visibility:visible">Alcance administrativo</DIV>
	    </td>
        </tr>
      </table>
   </td>   
    <td width="10" class="menu5texto"><IMG src="b.gif" width="10" height="8"/></td>
    <td width="20" nowrap="nowrap" class="menu5texto">
    <table width="75" border="0" align="center" cellpadding="1" cellspacing="0" bordercolor="#496A9A">
        <tr align="center"> 
          <td nowrap="nowrap" class="menu5textonegrita">
	    <DIV ID="InsertarP4"         
        style="width:80px;border-style:solid; border-color:#496A9A;border-width:2px;position:relative;top:3px;text-align:center;color:#496A9A;font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: bold; visibility:visible">Base de cálculo</DIV>
	    </td>
        </tr>
      </table>
   </td>
 <td width="10" class="menu5texto"><IMG src="b.gif" width="10" height="8"/></td>
    <td width="20" nowrap="nowrap" class="menu5texto">
    <table width="75" border="0" align="center" cellpadding="1" cellspacing="0" bordercolor="#496A9A">
        <tr align="center"> 
          <td nowrap="nowrap" class="menu5textonegrita">
	    <DIV ID="InsertarP5" 
		onmouseover="poneManito('InsertarP5');"
        onclick="onClickPestanya('4')" 
        style="width:80px;border-style:solid; border-color:#496A9A;border-width:2px;position:relative;top:3px;text-align:center;color:#496A9A;font-family: Arial, Helvetica, sans-serif;font-size: 11px;font-weight: bold; visibility:visible">Aplicación de descuento</DIV>
	    </td>
        </tr>
      </table>
   </td>
    <td width="16" class="menu5texto"><IMG src="b.gif" width="12" height="8"/></td>
  </tr>
</table>

<!-- Fin código para armar las pestañas -->


  <table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr>
       	<td width="12" align="center"><IMG src="b.gif" width="12" height="12"/></td>
     	<td width="750" ><IMG src="b.gif"/></td>
      	<td width="12" ><IMG src="b.gif" width="12" height="1"/></td>
    </tr>
    <tr> 
      <td><IMG src="b.gif"/></td>
      <td>
	<fieldset><legend class="legend"><LABELC nombre="lblDefinicionBases" alto="13" filas="1" valor="" cod="0097" id="legend" /></legend>
	 <table width="100%" border="0" align="center" cellspacing="0" cellpadding="0">
          <tr><td>
              <table width="575" border="0" align="left" cellspacing="0" cellpadding="0">
                 <tr>
                   <td colspan="4"><IMG src="b.gif" width="8" height="8"/></td>
                </tr>   
                <tr> 
                   <td><IMG src="b.gif" width="8" height="8"/></td>
                   <td><LABELC nombre="lblMarca" alto="13" filas="1" valor="" id="datosTitle" cod="2448"/></td>                   
		   <td><IMG src="b.gif" width="25" height="8"/></td>                   
                   <td><LABELC nombre="lblUnidadNegocio" alto="13" filas="1" valor="" id="datosTitle" cod="587"/></td>
		   <td width="100%" colspan="2"><IMG src="b.gif" width="8" height="8"/></td>
                </tr> 
                <tr>
                   <td><IMG src="b.gif" width="8" height="8"/></td>
                   <td  nowrap="nowrap">
                      <COMBO nombre="cbMarca" id="datosCampos" size="1" multiple="N" req="N" 
                      valorinicial="" textoinicial="" 
					  ontab="ontabComboMarca();"
                      onshtab="onshtabMarca();" 
                      onchange="marcaOnChange();">
                      	<ROWSET>
                      	</ROWSET>
                      </COMBO>
                   </td>
		   <td><IMG src="b.gif" width="25" height="8"/></td>
                   <td  nowrap="nowrap" >
                      <COMBO nombre="cbUnidadNegocio" id="datosCampos" size="1" multiple="N" req="N" 
                      valorinicial="" textoinicial="" ontab="ontabComboUnidadNegocio();" onchange="unidadNegocioOnChange();" onshtab="onshtabUnidadNegocio();">
                      	<ROWSET>
                      	</ROWSET>
                      </COMBO>
                   </td>
		   <td width="100%" ><IMG src="b.gif" width="8" height="8"/></td>
                </tr>
                                  
                <tr>
                   <td colspan="4"><IMG src="b.gif" width="8" height="8"/></td>
                </tr>                
              </table>    
          </td></tr>
         <tr><td>
              <table width="575" border="0" align="left" cellspacing="0" cellpadding="0">
                <tr> 
                   <td><IMG src="b.gif" width="8" height="8"/></td>
                   <td><LABELC nombre="lblNegocio"  alto="13" filas="1" valor="" id="datosTitle" cod="588"/></td>
		   <td><IMG src="b.gif" width="25" height="8"/></td>
                   <td><LABELC nombre="lblSupergenerico" alto="13" filas="1" valor="" id="datosTitle" cod="590"/></td>
		   <td width="100%" colspan="2"><IMG src="b.gif" width="8" height="8"/></td>
                </tr> 
                <tr>
                   <td><IMG src="b.gif" width="8" height="8"/></td>
                   <td  nowrap="nowrap" >
                      <COMBO nombre="cbNegocio" id="datosCampos" size="1" multiple="N" req="N" 
                      valorinicial="" textoinicial="" ontab="ontabComboNegocio();" onchange="NegocioOnChange();" onshtab="onshtabNegocio();">
                      	<ROWSET>
                      	</ROWSET>
                      </COMBO>
                   </td>
		   <td><IMG src="b.gif" width="25" height="8"/></td>
                   <td  nowrap="nowrap">
                      <COMBO nombre="cbSupergenerico" id="datosCampos" size="1" multiple="N" req="N" 
                      valorinicial="" textoinicial="" ontab="ontabComboSuperGenerico();" onchange="SuperGenericoOnChange();" onshtab="onshtabSuperGenerico();">
                      	<ROWSET>
                      	</ROWSET>
                      </COMBO>
                   </td>
		   <td width="100%" ><IMG src="b.gif" width="8" height="8"/></td>
                </tr>
                   <tr>
                   <td colspan="4"><IMG src="b.gif" width="8" height="8"/></td>
                </tr>                  
                             
              </table>    
         </td></tr>
         <tr><td>
              <table width="575" border="0" align="left" cellspacing="0" cellpadding="0">
                <tr> 
                   <td><IMG src="b.gif" width="8" height="8"/></td>
                   <td><LABELC nombre="lblGenerico"  alto="13" filas="1" valor="" id="datosTitle" cod="589"/></td>
                   <td><IMG src="b.gif" width="25" height="8"/></td>
                   <td><LABELC nombre="lblExclusionTipoOferta" alto="13" filas="1" valor="Exclusión tipo oferta" id="datosTitle"/></td>
		   <td width="100%" colspan="2"><IMG src="b.gif" width="8" height="8"/></td>
                </tr> 
                <tr>
                   <td><IMG src="b.gif" width="8" height="8"/></td>
                   <td  nowrap="nowrap" >
                      <COMBO nombre="cbGenerico" id="datosCampos" size="1" multiple="N" req="N" 
                      valorinicial="" textoinicial="" ontab="ontabComboGenerico();" onchange="GenericoOnChange();" onshtab="onshtabGenerico();">
                      	<ROWSET>
                      	</ROWSET>
                      </COMBO>
                   </td>
                   <td><IMG src="b.gif" width="25" height="8"/></td>
                   <td><CHECKBOX nombre="ExclusionTipoOferta" id="datosCampos" onclick="cambiaEstado();" check="N"
                   onshtab="onshtabExclusionTipoOferta();" /></td>
		   <td width="100%" ><IMG src="b.gif" width="8" height="8"/></td>
                </tr>
                    <tr>
                   <td colspan="4"><IMG src="b.gif" width="8" height="8"/></td>
                </tr>                  
                         
              </table>    
                </td></tr>
                <tr><td>
              <table width="575" border="0" align="left" cellspacing="0" cellpadding="0">
                <tr> 
                   <td><IMG src="b.gif" width="8" height="8"/></td>
                   <td><LABELC nombre="lblTipoOferta"  alto="13" filas="1" valor="" id="datosTitle" cod="608"/></td>
		   <td><IMG src="b.gif" width="25" height="8"/></td>
                   <td><LABELC nombre="lblCicloVida" alto="13" filas="1" valor="" id="datosTitle" cod="581"/></td>
		   <td width="100%" colspan="2"><IMG src="b.gif" width="8" height="8"/></td>
                </tr> 
                <tr>
                   <td><IMG src="b.gif" width="8" height="8"/></td>
                   <td  nowrap="nowrap" >
                      <COMBO nombre="cbTipoOferta" id="datosCampos" size="5" multiple="S" req="N" valorinicial="" textoinicial="" onchange="cbTipoOfertaOnChange();"  onshtab="onshtabTipoOferta();">
                      	<ROWSET>
                      	</ROWSET>
                      </COMBO>
                   </td>
		   <td><IMG src="b.gif" width="25" height="8"/></td>
                   <td  nowrap="nowrap">
                      <COMBO nombre="cbCicloVida" id="datosCampos" size="5" multiple="S" 
                      req="S" valorinicial="" textoinicial="" ontab="focalizaBotonHTML('botonContenido','btnEliminar');" onchange="cbCicloVidaOnChange();"   onshtab="onshtabCicloVida();">
                      	<ROWSET>
                      	</ROWSET>
                      </COMBO>
                   </td>
		   <td width="100%" ><IMG src="b.gif" width="8" height="8"/></td>
                </tr>
                  <tr>
                   <td colspan="4"><IMG src="b.gif" width="8" height="331"/></td>
                </tr>  
              </table>                     
              
         </td></tr>
           </table>          
        </fieldset>
        </td>
        <td><IMG src="b.gif" width="8" height="12"/></td>
      </tr> 
      <tr> 
        <td><IMG src="b.gif"/></td>
        <td>
	  <fieldset>
	    <table width="100%" border="0" align="center" cellspacing="0" cellpadding="0">        
	      <tr>
	        <td class="botonera">
		  <BOTON nombre="btnAnadir" ID="botonContenido" tipo="html" accion="accionAniadir();" 
          estado="false" cod="404" ontab="focalizaBotonHTML('botonContenido','btnSiguiente')" onshtab="onShTabAnadir();"/>
	        </td>
	      </tr>    
	    </table>        
	  </fieldset>
      </td>        
      <td><IMG src="b.gif"/></td>
    </tr>        
    <tr>
       	<td width="12" align="center"><IMG src="b.gif" width="12" height="12"/></td>
     	<td width="756" ><IMG src="b.gif"/></td>
      	<td width="12" ><IMG src="b.gif" width="12" height="12"/></td>
    </tr>
  </table>
  
 </CAPA>   

  <!--LISTAEDITABLE nombre="listado1" ancho="555" alto="301" x="24" y="241" colorFondo="#CECFCE" msgDebugJS="S"-->
  <LISTAEDITABLE nombre="listado1" ancho="555" alto="301" x="24" y="261" colorFondo="#CECFCE" msgDebugJS="S">
      <IMGBOTONES precarga="S" conROver="S">
        <BTNSELECCION normal="btnLista2N.gif" rollOver="btnLista2S.gif" seleccionado="btnLista2M.gif" desactivado="btnLista2D.gif" /> 
        <BTNMINIMIZAR minimizar="bot_pliega_columna_on.gif" minimROver="bot_pliega_columna_over.gif" maximizar="bot_despliega_columna_on.gif" maximROver="bot_despliega_columna_over.gif" /> 
        <BTNORDENAR ordenar="ascendente_on.gif" ordenarInv="descendente_on.gif"/>   
      </IMGBOTONES>
      <LINEAS>
        <GROSOR borde="1" horizDatos="1" horizCabecera="1" vertical="0" horizTitulo="1" horizBase="1"/> 
        <COLOR borde="#999999" vertCabecera="#E0E0E0" vertDatos="#FFFFFF" horizDatos="#FFFFFF" horizCabecera="#999999" horizTitulo="#999999" horizBase="#999999" /> 
      </LINEAS>
      <TITULO colFondo="#CECFCE" alto="22" imgFondo="" cod="515" ID="datosTitle" />
      <BASE colFondo="#CECFCE" alto="22" imgFondo=""/>

      <COLUMNAS ajustarMinimo="S" permiteOrdenar="S" blancosAInsertar="1" sinSaltoLinea="S" AnchoMinimizadas="20" botonOrdenar="S">
        <COL ancho="20" minimizable="S" minimizada="N"/>
        <COL ancho="40" minimizable="S" minimizada="N" orden="alfanumerico"/> 
       
      </COLUMNAS>
      <CABECERA alto="20" IDScroll="EstCab" imgFondo="" colFondo="#CCCCCC">
	<COL colFondo="" ID="EstCab" align="center" cod="337">Código producto</COL>
	<COL colFondo="" ID="EstCab" cod="338">Descripción producto</COL>
      </CABECERA>
      <DATOS alto="22" accion="" tipoEnvio="edicion" formaEnvio="xml" maxSel="-1" msgErrMaxSel="" 
             coloresScrollNativo="#D4D0C8,black,white,#D4D0C8,#D4D0C8,#ECE9E4,black" colorROver="#D0D9E8" 
             onLoad="" colorSelecc="#D0D9E8">
       <COL tipo="texto" ID="EstDat"/> 
       <COL tipo="texto" ID="EstDat2"/> 
      </DATOS>
      <ROWSET>
	
      </ROWSET>
       <PAGINADO nombre="mipgndo" ancho="555" sep="$" x="24" class="botonera" y="519" control="|" conector="" rowset="" cargainicial="N">
        
        <!--BOTON nombre="ret1" x="49" y="523" ID="botonContenido" img="retroceder_on" tipo="0" estado="false" alt="" codigo="" accion="mipgndo.retroceder();" /> 
        <BOTON nombre="ava1" x="64" y="523" ID="botonContenido" img="avanzar_on" tipo="0" estado="false" alt="" codigo="" accion="mipgndo.avanzar();"/-->
        <BOTON nombre="ret1" x="49" y="543" ID="botonContenido" img="retroceder_on" tipo="0" estado="false" alt="" codigo="" accion="mipgndo.retroceder();" /> 
        <BOTON nombre="ava1" x="64" y="543" ID="botonContenido" img="avanzar_on" tipo="0" estado="false" alt="" codigo="" accion="mipgndo.avanzar();"/>        
        
    </PAGINADO>
  </LISTAEDITABLE>
  <!--BOTON nombre="primera1" x="32" y="523" ID="botonContenido" img="primera_on" tipo="-2" estado="false" alt="" codigo="" accion="mipgndo.retrocederPrimeraPagina();" />      
  <BOTON nombre="separa" x="71" y="519" ID="botonContenido" img="separa_base" tipo="0" estado="false" alt="" codigo="" accion="" /-->      
  <BOTON nombre="primera1" x="32" y="543" ID="botonContenido" img="primera_on" tipo="-2" estado="false" alt="" codigo="" accion="mipgndo.retrocederPrimeraPagina();" />      
  <BOTON nombre="separa" x="71" y="539" ID="botonContenido" img="separa_base" tipo="0" estado="false" alt="" codigo="" accion="" />        
  <!--BOTON nombre="btnBuscar" x="79" y="520" ID="botonContenido" tipo="html" estado="false" cod="445" accion="accionBuscarProductos();" ontab="focalizaBotonHTML('botonContenido','btnAnadir')" onshtab="focalizaBotonHTML('botonContenido','btnEliminar')"/> 
  <BOTON nombre="btnEliminar" x="25" y="520" ID="botonContenido" tipo="html" estado="false" cod="1254" accion="accionEliminar();" ontab="focalizaBotonHTML('botonContenido','btnBuscar')" onshtab="focaliza('formulario.cbCicloVida')"/--> 
  <BOTON nombre="btnBuscar" x="79" y="540" ID="botonContenido" tipo="html" estado="false" cod="445" accion="accionBuscarProductos();" ontab="focalizaBotonHTML('botonContenido','btnAnadir')" onshtab="focalizaBotonHTML('botonContenido','btnEliminar')"/> 
  <BOTON nombre="btnEliminar" x="25" y="540" ID="botonContenido" tipo="html" estado="false" cod="1254" accion="accionEliminar();" ontab="onTabEliminar();" onshtab="focaliza('formulario.cbCicloVida')"/> 
             
          
    <LISTAEDITABLE nombre="listado2" ancho="579" alto="317" x="12" y="611" colorFondo="#CECFCE" msgDebugJS="S">
      <IMGBOTONES precarga="S" conROver="S">
        <BTNSELECCION normal="btnLista2N.gif" rollOver="btnLista2S.gif" seleccionado="btnLista2M.gif" desactivado="btnLista2D.gif" /> 
        <BTNMINIMIZAR minimizar="bot_pliega_columna_on.gif" minimROver="bot_pliega_columna_over.gif" maximizar="bot_despliega_columna_on.gif" maximROver="bot_despliega_columna_over.gif" /> 
        <BTNORDENAR ordenar="ascendente_on.gif" ordenarInv="descendente_on.gif"/>   
      </IMGBOTONES>
      <LINEAS>
        <GROSOR borde="1" horizDatos="1" horizCabecera="1" vertical="0" horizTitulo="1" horizBase="1"/> 
        <COLOR borde="#999999" vertCabecera="#E0E0E0" vertDatos="#FFFFFF" horizDatos="#FFFFFF" horizCabecera="#999999" horizTitulo="#999999" horizBase="#999999" /> 
      </LINEAS>
      <TITULO colFondo="#CECFCE" alto="22" imgFondo=""  ID="datosTitle" cod="00579"/>
      <BASE colFondo="#CECFCE" alto="22" imgFondo=""/>

      <COLUMNAS ajustarMinimo="S" permiteOrdenar="S" blancosAInsertar="1" sinSaltoLinea="S" AnchoMinimizadas="20" botonOrdenar="S">
        <COL ancho="30" minimizable="S" minimizada="N" oculta="S"/>
        <COL ancho="50" minimizable="S" minimizada="N"/>
        <COL ancho="30" minimizable="S" minimizada="N" oculta="S"/>
        <COL ancho="100" minimizable="S" minimizada="N" /> 
        <COL ancho="30" minimizable="S" minimizada="N" oculta="S"/>
        <COL ancho="50" minimizable="S" minimizada="N"/>
        <COL ancho="30" minimizable="S" minimizada="N" oculta="S"/>
        <COL ancho="80" minimizable="S" minimizada="N" /> 
        <COL ancho="30" minimizable="S" minimizada="N" oculta="S"/>
        <COL ancho="50" minimizable="S" minimizada="N"/>
        <COL ancho="120" minimizable="S" minimizada="N" /> 
        <COL ancho="30" minimizable="S" minimizada="N" oculta="S"/>
        <COL ancho="100" minimizable="S" minimizada="N"/>
        <COL ancho="30" minimizable="S" minimizada="N" oculta="S"/>
        <COL ancho="100" minimizable="S" minimizada="N" /> 
        <COL ancho="30" minimizable="S" minimizada="N" oculta="S"/>
        <COL ancho="80" minimizable="S" minimizada="N" /> 
      </COLUMNAS>
      <CABECERA alto="20" IDScroll="EstCab" imgFondo="" colFondo="#CCCCCC">
	<COL colFondo="" ID="EstCab" >oidMarca</COL>
	<COL colFondo="" ID="EstCab" cod="6">Marca</COL>
	<COL colFondo="" ID="EstCab" >oidUnidadNegocio</COL>
	<COL colFondo="" ID="EstCab" cod="587">Unidad negocio</COL>
	<COL colFondo="" ID="EstCab" >oidNegocio</COL>
	<COL colFondo="" ID="EstCab" cod="588">Negocio</COL>
	<COL colFondo="" ID="EstCab" >oidSupergenerico</COL>
	<COL colFondo="" ID="EstCab" cod="590">Supergenérico</COL>
	<COL colFondo="" ID="EstCab" >oidGenerico</COL>
	<COL colFondo="" ID="EstCab" cod="589">Genérico</COL>
	<COL colFondo="" ID="EstCab" cod="2371">Exclusión tipo oferta</COL>
	<COL colFondo="" ID="EstCab" >oidTipoOferta</COL>
	<COL colFondo="" ID="EstCab" cod="608">Tipo oferta</COL>
	<COL colFondo="" ID="EstCab" >oidCicloVida</COL>
	<COL colFondo="" ID="EstCab" cod="581">Ciclo vida</COL>
	<COL colFondo="" ID="EstCab" >oidProducto</COL>
	<COL colFondo="" ID="EstCab" cod="574">Producto</COL>
	
      </CABECERA>
      <DATOS alto="22" accion="" tipoEnvio="edicion" formaEnvio="xml" maxSel="-1" msgErrMaxSel="" 
             coloresScrollNativo="#D4D0C8,black,white,#D4D0C8,#D4D0C8,#ECE9E4,black" colorROver="#D0D9E8" 
             onLoad="" colorSelecc="#D0D9E8">
       <COL tipo="texto" ID="EstDat"/> 
       <COL tipo="texto" ID="EstDat"/> 
       <COL tipo="texto" ID="EstDat2"/> 
       <COL tipo="texto" ID="EstDat2"/> 
       <COL tipo="texto" ID="EstDat"/> 
       <COL tipo="texto" ID="EstDat"/> 
       <COL tipo="texto" ID="EstDat2"/> 
       <COL tipo="texto" ID="EstDat2"/> 
       <COL tipo="texto" ID="EstDat"/> 
       <COL tipo="texto" ID="EstDat"/> 
       <COL tipo="texto" ID="EstDat2"/> 
       <COL tipo="texto" ID="EstDat2"/> 
       <COL tipo="texto" ID="EstDat"/> 
       <COL tipo="texto" ID="EstDat"/> 
       <COL tipo="texto" ID="EstDat2"/> 
       <COL tipo="texto" ID="EstDat2"/> 
       <COL tipo="texto" ID="EstDat"/> 
      
      </DATOS>
      <ROWSET>
	
      </ROWSET>
       <PAGINADO nombre="mipgndo2" ancho="579" sep="$" x="12" class="botonera" y="905" control="|" conector="" rowset="" cargainicial="N">
        
        <BOTON nombre="ret2" x="37" y="909" ID="botonContenido" img="retroceder_on" tipo="0" estado="false" alt="" codigo="" accion="mipgndo2.retroceder();" /> 
        <BOTON nombre="ava2" x="52" y="909" ID="botonContenido" img="avanzar_on" tipo="0" estado="false" alt="" codigo="" accion="mipgndo2.avanzar();"/>
        
    </PAGINADO>
  </LISTAEDITABLE>
  <BOTON nombre="primera2" x="20" y="909" ID="botonContenido" img="primera_on" tipo="-2" estado="false" alt="" codigo="" accion="mipgndo2.retrocederPrimeraPagina();" />      
  <BOTON nombre="separa2" x="59" y="905" ID="botonContenido" img="separa_base" tipo="0" estado="false" alt="" codigo="" accion="" />      
  <BOTON nombre="btnSiguiente" x="13" y="906" ID="botonContenido" tipo="html" estado="false" cod="446" accion="accionSiguiente();" 
        ontab="onTabSiguiente();" onshtab="onShTabSiguiente();"/>
  <BOTON nombre="btnEliminar2" x="79" y="906" ID="botonContenido" tipo="html" 
    estado="false" cod="1254" accion="accionEliminar2()" ontab="onTabEliminar2();" />                           

        <CAPA nombre="capaEspacio" alto="12" ancho="100%" colorf="" borde="0" imagenf="" 
      repeat="" padding="" visibilidad="visible" contravsb="" x="0" y="928" zindex="">
  </CAPA>                                                                                                                 
</FORMULARIO>
</PAGINA>
