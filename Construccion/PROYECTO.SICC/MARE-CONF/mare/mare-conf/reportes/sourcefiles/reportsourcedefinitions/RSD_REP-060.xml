<?xml version="1.0" encoding="UTF-8"?>  
<!-- edited with XMLSPY v2004 rel. 2 U (http://www.xmlspy.com) by team (renegade) -->  
<ReportSourceDefinition Id="RSD_REP-060" Cached="false" Expiration="0" IncrementalDimension="" Multilanguage="false" MaxRowsDimensionReference="" >  
	<DimensionSourceDefinitions>  
		<DimensionSourceDefinition Name="MARCA" Description="MARCA" DataType="STRING" Calculated="false" Expression="" ExternalData="MARCA"/>  
		<DimensionSourceDefinition Name="SUBG" Description="SUBG" DataType="STRING" Calculated="false" Expression="" ExternalData="SUBG"/>  
		<DimensionSourceDefinition Name="REGION" Description="REGION" DataType="STRING" Calculated="false" Expression="" ExternalData="REGION"/>  
		<DimensionSourceDefinition Name="ZONA" Description="ZONA" DataType="STRING" Calculated="false" Expression="" ExternalData="ZONA"/>  
		<DimensionSourceDefinition Name="NUM_CONCURSO" Description="NUM_CONCURSO" DataType="STRING" Calculated="false" Expression="" ExternalData="NUM_CONCURSO"/>  
		<DimensionSourceDefinition Name="DES_CONCURSO" Description="DES_CONCURSO" DataType="STRING" Calculated="false" Expression="" ExternalData="DES_CONCURSO"/>  
		<DimensionSourceDefinition Name="TIPO_MONEDA" Description="TIPO_MONEDA" DataType="STRING" Calculated="false" Expression="" ExternalData="TIPO_MONEDA"/>  
		<DimensionSourceDefinition Name="NRO_RECOMENDADAS_EF" Description="NRO_RECOMENDADAS_EF" DataType="STRING" Calculated="false" Expression="" ExternalData="NRO_RECOMENDADAS_EF"/>  
	</DimensionSourceDefinitions>  
	<MetricSourceDefinitions>  
		<MetricSourceDefinition Name="NRO_RECOMTES" Description="NRO_RECOMTES" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="NRO_RECOMTES" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="TOTAL_NRO_RECDOS" Description="TOTAL_NRO_RECDOS" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="TOTAL_NRO_RECDOS" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="NRO_GANADORES" Description="NRO_GANADORES" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="NRO_GANADORES" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="VENTA_RECOMTES" Description="VENTA_RECOMTES" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="VENTA_RECOMTES" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PROM_RECTE" Description="PROM_RECTE" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PROM_RECTE" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="VENTA_RECDADAS" Description="VENTA_RECDADAS" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="VENTA_RECDADAS" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PROM_RECDO" Description="PROM_RECDO" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PROM_RECDO" ExternalCalculated="false"/>  
	</MetricSourceDefinitions>  
	<FilterDefinitions>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="PAIS" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="IDIOMA" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="IN" Name="SUBGERENCIAVENTA" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="IN" Name="REGION" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="IN" Name="ZONA" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="TIPOVENTA" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="IN" Name="NUMEROCONCURSO" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="MARCA" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="MONEDA" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="IN" Name="NUMERORECOMENDADAS" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="CANAL" Visual="FALSE"/>  
	</FilterDefinitions>  
	<DataSourceDefinitions>  
		<DataSourceDefinition Name="REP-060" SourceType="SQL" Expression="  
  
  
  
  
  
SELECT DATOS.MARCA,  
	   DATOS.SUBG,  
	   DATOS.REGION,  
	   DATOS.ZONA,  
	   DATOS.NUM_CONCURSO,  
	   DATOS.DES_CONCURSO,  
	   (  
	   SELECT GEN.VAL_I18N  
	   FROM V_GEN_I18N_SICC GEN  
	   WHERE GEN.ATTR_ENTI = 'SEG_MONED'  
	   		 AND GEN.IDIO_OID_IDIO =%value_IDIOMAVALUE%  
  
			 AND GEN.VAL_OID = %value_MONEDAVALUE%  
  
	   ) TIPO_MONEDA,  
	   DATOS.NRO_RECOMENDADAS_EF,  
	   COUNT(*) NRO_RECOMTES,  
	   SUM(DATOS.NRO_RECOMENDADAS_EF) TOTAL_NRO_RECDOS,  
	   SUM(DATOS.GANA) NRO_GANADORES,  
	   SUM(DATOS.MONTO_PEDIDO) VENTA_RECOMTES,  
	   DECODE(SUM(DATOS.CANT_PEDIDOS), 0, 0, SUM(DATOS.MONTO_PEDIDO)/SUM(DATOS.CANT_PEDIDOS)) PROM_RECTE,  
	   SUM(DATOS.MONTO_PEDIDO_RECDO) VENTA_RECDADAS,  
	   DECODE(SUM(DATOS.CANT_PEDIDOS_RECDO), 0, 0, SUM(DATOS.MONTO_PEDIDO_RECDO)/SUM(DATOS.CANT_PEDIDOS_RECDO)) PROM_RECDO	   	    
FROM  
(  
	SELECT RECTE.MARCA,  
		   RECTE.SUBG,  
		   RECTE.REGION,  
		   RECTE.ZONA,  
		   RECTE.NUM_CONCURSO,  
		   RECTE.DES_CONCURSO,  
		   RECTE.NRO_RECOMENDADAS_EF,  
		   RECTE.MONTO_PEDIDO,  
		   RECTE.CANT_PEDIDOS,  
	   	   (  
		   SELECT CASE WHEN (PAIS.MONE_OID_MONE = %value_MONEDAVALUE%) THEN	   
		   		  	   SUM(PCR.IMP_MONT_PEDI)  
				  ELSE  
				  	   SUM(PCR.IMP_MONT_PEDI)*(SELECT TC.VAL_TIPO_CAMB   
					   						   FROM SEG_TIPO_CAMBI TC  
											   WHERE TC.MONE_OID_MON1 = PAIS.MONE_OID_MONE  
											   		 AND TC.MONE_OID_MON2 = %value_MONEDAVALUE%  
													 AND TC.FEC_DESD &lt;= SYSDATE  
													 AND TC.FEC_HAST >= SYSDATE  
					   						  )  
				  END					     
		   FROM INC_PEDID_CONCU_RECOM PCR,  
		   		INC_CLIEN_RECDO RECDO,  
				INC_CONCU_PARAM_GENER CON_PAR,   
				SEG_PAIS PAIS  
		   WHERE PCR.COPA_OID_PARA_GRAL = RECTE.OID_PARA_GRAL  
	   		     AND PCR.CLR3_OID_CLIE_RETE = RECTE.OID_CLIE_RETE  
			     AND PCR.CLRE_OID_CLIE_REDO = RECDO.OID_CLIE_REDO  
				 AND RECDO.CLR3_OID_CLIE_RETE = RECTE.OID_CLIE_RETE  
		   		 AND RECDO.IND_EFEC = 1			   
				 AND PAIS.OID_PAIS = CON_PAR.PAIS_OID_PAIS  
				 AND con_par.oid_para_gral = recte.oid_para_gral  
		   GROUP BY PAIS.MONE_OID_MONE  
		   ) MONTO_PEDIDO_RECDO,  
		   (  
		   SELECT COUNT(*)  
		   FROM INC_PEDID_CONCU_RECOM PCR,  
		   		INC_CLIEN_RECDO RECDO  
		   WHERE PCR.COPA_OID_PARA_GRAL = RECTE.OID_PARA_GRAL  
	   		     AND PCR.CLR3_OID_CLIE_RETE = RECTE.OID_CLIE_RETE  
			     AND PCR.CLRE_OID_CLIE_REDO = RECDO.OID_CLIE_REDO  
				 AND RECDO.CLR3_OID_CLIE_RETE = RECTE.OID_CLIE_RETE  
				 AND RECDO.IND_EFEC = 1			   
		   ) CANT_PEDIDOS_RECDO,  
		   (  
		   SELECT COUNT(DISTINCT RECTE.CLIE_OID_CLIE)  
		   FROM INC_GANAD GANA,  
		   		INC_PARAM_GENER_PREMI PAR_GEN,  
				INC_PARAM_NIVEL_PREMI NIV_PRE  
		   WHERE GANA.PANP_OID_PARA_NIVE_PREM = NIV_PRE.OID_PARA_NIVE_PREM  
		   		 AND NIV_PRE.PAGP_OID_PARA_GENE_PREM = PAR_GEN.OID_PARA_GENE_PREM  
				 AND PAR_GEN.COPA_OID_PARA_GRAL = RECTE.OID_PARA_GRAL  
				 AND GANA.CLIE_OID_CLIE = RECTE.CLIE_OID_CLIE  
		   ) GANA  
	FROM  
	(  
		SELECT MARCA.DES_MARC MARCA,  
			   SUBG.DES_SUBG_VENT SUBG,  
			   REG.DES_REGI REGION,  
			   ZONA.DES_ZONA ZONA,  
			   CON_PAR.NUM_CONC NUM_CONCURSO,  
			   CON_PAR.VAL_NOMB DES_CONCURSO,  
			   CON_PAR.OID_PARA_GRAL,  
			   (  
			   SELECT COUNT(*)  
			   FROM INC_CLIEN_RECDO CLI_RECDO  
			   WHERE CLI_RECDO.CLR3_OID_CLIE_RETE = CLI_RECTE.OID_CLIE_RETE  
					 AND CLI_RECDO.IND_EFEC = 1  
			   ) NRO_RECOMENDADAS_EF,  
			   CLI_RECTE.CLIE_OID_CLIE,  
			   CLI_RECTE.OID_CLIE_RETE,  
		   	   (  
			   SELECT SUM(PCR.IMP_MONT_PEDI)  
			   FROM INC_PEDID_CONCU_RECOM PCR   
			   WHERE PCR.COPA_OID_PARA_GRAL = CON_PAR.OID_PARA_GRAL  
		   		     AND PCR.CLR3_OID_CLIE_RETE = CLI_RECTE.OID_CLIE_RETE  
				     AND PCR.CLRE_OID_CLIE_REDO IS NULL  
			   ) MONTO_PEDIDO,  
			   (  
			   SELECT COUNT(*)  
			   FROM INC_PEDID_CONCU_RECOM PCR  
			   WHERE PCR.COPA_OID_PARA_GRAL = CON_PAR.OID_PARA_GRAL  
		   		     AND PCR.CLR3_OID_CLIE_RETE = CLI_RECTE.OID_CLIE_RETE  
				     AND PCR.CLRE_OID_CLIE_REDO IS NULL  
			   ) CANT_PEDIDOS  
		FROM ZON_SUB_GEREN_VENTA SUBG,  
			 ZON_REGIO REG,  
			 ZON_ZONA ZONA,  
			 ZON_SECCI SEC,  
			 ZON_TERRI_ADMIN TER_ADM,  
			 MAE_CLIEN_UNIDA_ADMIN CLI_UA,  
			 INC_CLIEN_RECTE CLI_RECTE,  
			 INC_CONCU_PARAM_GENER CON_PAR,  
			 INC_CONCU_PARAM_CONSU PCON,  
			 INC_CONCU_PARAM_GEREN PGER,  
			 SEG_MARCA MARCA	   
		WHERE REG.OID_REGI = ZONA.ZORG_OID_REGI  
			  AND SUBG.OID_SUBG_VENT = REG.ZSGV_OID_SUBG_VENT  
			  AND ZONA.OID_ZONA = SEC.ZZON_OID_ZONA  
			  AND SEC.OID_SECC = TER_ADM.ZSCC_OID_SECC  
			  AND TER_ADM.OID_TERR_ADMI = CLI_UA.ZTAD_OID_TERR_ADMI  
			  AND MARCA.OID_MARC = SUBG.MARC_OID_MARC  
			  AND CLI_RECTE.CLIE_OID_CLIE = CLI_UA.CLIE_OID_CLIE  
			  AND CON_PAR.OID_PARA_GRAL = CLI_RECTE.COPA_OID_PARA_GRAL	    
			  AND CLI_UA.IND_ACTI = 1  
			  AND CON_PAR.IND_ACTI = 1  
			  AND CON_PAR.OID_PARA_GRAL = PGER.COPA_OID_PARA_GRAL(+)  
			  AND CON_PAR.OID_PARA_GRAL = PCON.COPA_OID_PARA_GRAL(+)  
			  AND CON_PAR.PAIS_OID_PAIS = %value_PAISVALUE%		  
			  AND CON_PAR.OID_PARA_GRAL IN (%value_NUMEROCONCURSOVALUES%)  
			  AND SUBG.MARC_OID_MARC = %value_MARCAVALUE%	   
			  AND SUBG.CANA_OID_CANA = %value_CANALVALUE%	  
%start_SUBGERENCIAVENTAVALUES%   AND SUBG.OID_SUBG_VENT IN (%value_SUBGERENCIAVENTAVALUES%)  %end_SUBGERENCIAVENTAVALUES%   
			  
	           %start_REGIONVALUES%    AND REG.OID_REGI IN   (%value_REGIONVALUES%)  %end_REGIONVALUES%   
			   %start_ZONAVALUES%   AND ZONA.OID_ZONA IN   (%value_ZONAVALUES%)  %end_ZONAVALUES% 		  
	           		  
	) RECTE  
	WHERE NRO_RECOMENDADAS_EF IN (%value_NUMERORECOMENDADASVALUES%)			   
) DATOS  
GROUP BY DATOS.MARCA,  
	  	 DATOS.SUBG,  
	   DATOS.REGION,  
	   DATOS.ZONA,  
	   DATOS.NUM_CONCURSO,  
	   DATOS.DES_CONCURSO,  
	   DATOS.NRO_RECOMENDADAS_EF  
  
   
  
" ExternalClassName="oracle.jdbc.driver.OracleDriver" ExternalSourceData="" ExternalConnectionString="" ExternalConnectionClassName="oracle.jdbc.driver.OracleDriver" ExternalConnectionLocalUrl="jdbc:oracle:thin:@192.168.118.106:1523:SICCV3D" ExternalConnectionDistributedUrl="" ExternalConnectionUser="own_peru" ExternalConnectionPassword="peru_own" DatePattern="" DateTimePattern=""/>  
	</DataSourceDefinitions>  
	<ParameterValues>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="PAIS" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="IDIOMA" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="NULL_VALUE" FilterDefinitionName="SUBGERENCIAVENTA" FilterParameter="VALUES"/>  
		<ParameterValue DefaultValue="NULL_VALUE" FilterDefinitionName="REGION" FilterParameter="VALUES"/>  
		<ParameterValue DefaultValue="NULL_VALUE" FilterDefinitionName="ZONA" FilterParameter="VALUES"/>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="TIPOVENTA" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="2" FilterDefinitionName="NUMEROCONCURSO" FilterParameter="VALUES"/>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="MARCA" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="CANAL" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="1,2,3,4" FilterDefinitionName="NUMERORECOMENDADAS" FilterParameter="VALUES"/>  
		<ParameterValue DefaultValue="2" FilterDefinitionName="MONEDA" FilterParameter="VALUE"/>  
	</ParameterValues>  
	<Localizations/>  
</ReportSourceDefinition>  

