<?xml version="1.0" encoding="UTF-8"?>  
<!-- edited with XMLSPY v2004 rel. 2 U (http://www.xmlspy.com) by tito (tito) -->  
<ReportSourceDefinition Id="RSD_REP-070" Cached="false" Expiration="0" IncrementalDimension="" Multilanguage="false" MaxRowsDimensionReference="" >  
	<DimensionSourceDefinitions>  
		<DimensionSourceDefinition Name="DIRIGIDO" Description="DIRIGIDO" DataType="STRING" Calculated="false" Expression="" ExternalData="DIRIGIDO"/>  
		<DimensionSourceDefinition Name="CONCURSO" Description="CONCURSO" DataType="STRING" Calculated="false" Expression="" ExternalData="CONCURSO"/>  
		<DimensionSourceDefinition Name="DESC_PRE" Description="DESC_PRE" DataType="STRING" Calculated="false" Expression="" ExternalData="DESC_PRE"/>  
		<DimensionSourceDefinition Name="PERIODOS" Description="PERIODOS" DataType="STRING" Calculated="false" Expression="" ExternalData="PERIODOS"/>  
		<DimensionSourceDefinition Name="REQUISITOS" Description="REQUISITOS" DataType="STRING" Calculated="false" Expression="" ExternalData="REQUISITOS"/>  
	</DimensionSourceDefinitions>  
	<MetricSourceDefinitions>  
		<MetricSourceDefinition Name="TOTAL_CON" Description="TOTAL_CON" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="TOTAL_CON" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="N_GANA" Description="N_GANA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="N_GANA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PORC" Description="PORC" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PORC" ExternalCalculated="false"/>  
	</MetricSourceDefinitions>  
	<FilterDefinitions>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="IDIOMA" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="SUBGERENCIAVENTA" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="REGION" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="ZONA" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="IN" Name="NUMEROCONCURSO" Visual="FALSE"/>  
	</FilterDefinitions>  
	<DataSourceDefinitions>  
		<DataSourceDefinition Name="REP-070" SourceType="SQL" Expression="  
SELECT * FROM  
(  
%start_SUBGERENCIAVENTAVALUE%  
				(  
				SELECT   
						'1-GERENTES DE SGV' dirigido,   
					   	concurso,   
						premi.desc_pre,  
				       Pq_Apl_Rep.fn_070_concat_peri (concu.oid_para_gral) periodos, requisitos,  
				       total_con, n_gana, porc  
				  FROM (SELECT   oid_para_gral, concurso, COUNT (*) total_con,  
				                 SUM (gana) n_gana, (SUM (gana) * 100) / COUNT (*) porc, VAL_OBSE AS REQUISITOS  
				            FROM (SELECT cpg.oid_para_gral,  val_obse,  
				                            cpg.val_nomb  
				                         || ' '  
				                         || cpg.num_conc  
				                         || ' '  
				                         || cpg.num_vers concurso,  
				                         NVL  
				                            ((SELECT 1  
				                                FROM INC_GANAD gana,  
				                                     INC_PARAM_GENER_PREMI pgp,  
				                                     INC_PARAM_NIVEL_PREMI pnp  
				                                       
				                                WHERE gana.clie_oid_clie = sub.clie_oid_clie  
				                                 AND gana.panp_oid_para_nive_prem = pnp.oid_para_nive_prem  
				                                 AND pnp.pagp_oid_para_gene_prem = pgp.oid_para_gene_prem  
				                                 AND pgp.copa_oid_para_gral = cpg.oid_para_gral  
				                                 AND ROWNUM = 1),  
				                             0  
				                            ) gana  
				                    FROM INC_PARTI_CONCU_CABEC pcc,  
				                         INC_PARTI_CONCU_DETAL pcd,  
				                         INC_CLASI_PARTI_CONCU cpc,  
				                         INC_CONCU_PARAM_GENER cpg,  
										 ZON_SUB_GEREN_VENTA sub,  
										   
				                         (SELECT DISTINCT ag.copa_oid_para_gral, subg.OID_SUBG_VENT subgv  
										 										    
				                                    FROM INC_AMBIT_GEOGR ag,  
				                                         ZON_SUB_GEREN_VENTA subg  
				                                            
				                                    WHERE ag.zsgv_oid_subg_vent = subg.oid_subg_vent  
				                                          AND ag.copa_oid_para_gral IN (%value_NUMEROCONCURSOVALUES%)  
				                                 ORDER BY ag.copa_oid_para_gral, subg.OID_SUBG_VENT) amb  
												   
				                   WHERE pcc.oid_part_conc_cabe = cpc.paci_oid_part_conc_cabe  
				                     AND cpg.oid_para_gral = cpc.copa_oid_para_gral  
				                     AND pcd.paci_oid_part_conc_cabe = pcc.oid_part_conc_cabe  
				                     AND amb.copa_oid_para_gral = cpg.oid_para_gral  
							AND sub.oid_subg_vent = amb.subgv  
							AND PCD.TICL_OID_TIPO_CLIE = 4  
					      	       AND PCD.SBTI_OID_SUBT_CLIE = 8	  
				                     AND cpg.ind_acti = 1  
				                     AND cpg.oid_para_gral IN (%value_NUMEROCONCURSOVALUES%)  
									   )  
				        GROUP BY oid_para_gral, concurso, VAL_OBSE) concu,  
				       (SELECT cpg.oid_para_gral,  
				                  vis.tipo_premio  
				               || ' '  
				               || vis.descripcion  
				               || ' '  
				               || vis.cantidad desc_pre  
				          FROM INC_CONCU_PARAM_GENER cpg,  
				               INC_PARAM_NIVEL_PREMI pnp,  
				               INC_PARAM_GENER_PREMI pgp,  
				               v_rep_premios vis  
				         WHERE cpg.oid_para_gral = pgp.copa_oid_para_gral  
				           AND pgp.oid_para_gene_prem = pnp.pagp_oid_para_gene_prem  
				           AND vis.oid_para_nive_prem = pnp.oid_para_nive_prem  
				           AND vis.idio_tipo_premio = %value_IDIOMAVALUE%  
				           AND cpg.oid_para_gral IN (%value_NUMEROCONCURSOVALUES%)  
							 ) premi  
				 WHERE concu.oid_para_gral = premi.oid_para_gral(+)  
				 		/* %value_SUBGERENCIAVENTAVALUE% */  
				 )  
				UNION  
%end_SUBGERENCIAVENTAVALUE%      %start_REGIONVALUE%			  
				(  
				SELECT   
					   	'2-GERENTES DE REGION' dirigido,   
						concurso,   
						premi.desc_pre,  
				       Pq_Apl_Rep.fn_070_concat_peri (concu.oid_para_gral) periodos, requisitos,  
				       total_con, n_gana, porc  
				  FROM (SELECT   oid_para_gral, concurso, COUNT (*) total_con,  
				                 SUM (gana) n_gana, (SUM (gana) * 100) / COUNT (*) porc, VAL_OBSE AS REQUISITOS  
				            FROM (SELECT cpg.oid_para_gral,  val_obse,  
				                            cpg.val_nomb  
				                         || ' '  
				                         || cpg.num_conc  
				                         || ' '  
				                         || cpg.num_vers concurso,  
				                         NVL  
				                            ((SELECT 1  
				                                FROM INC_GANAD gana,  
				                                     INC_PARAM_GENER_PREMI pgp,  
				                                     INC_PARAM_NIVEL_PREMI pnp  
				                                       
				                                WHERE gana.clie_oid_clie = region.clie_oid_clie  
				                                 AND gana.panp_oid_para_nive_prem =  
				                                                        pnp.oid_para_nive_prem  
				                                 AND pnp.pagp_oid_para_gene_prem =  
				                                                        pgp.oid_para_gene_prem  
				                                 AND pgp.copa_oid_para_gral =  
				                                                             cpg.oid_para_gral  
				                                 AND ROWNUM = 1),  
				                             0  
				                            ) gana  
				                    FROM INC_PARTI_CONCU_CABEC pcc,  
				                         INC_PARTI_CONCU_DETAL pcd,  
				                         INC_CLASI_PARTI_CONCU cpc,  
				                         INC_CONCU_PARAM_GENER cpg,  
										 ZON_REGIO region,  
										   
				                         (SELECT DISTINCT ag.copa_oid_para_gral,  
										   
				                                          CASE WHEN reg.oid_regi IS NULL  
				                                               THEN reg2.oid_regi  
				                                          ELSE reg.oid_regi  
				                                          END region  
														    
				                                     FROM INC_AMBIT_GEOGR ag,  
				                                          ZON_SUB_GEREN_VENTA subg,  
				                                          ZON_REGIO reg,  
				                                          ZON_REGIO reg2  
				                                    WHERE ag.zsgv_oid_subg_vent = subg.oid_subg_vent  
				                                      AND subg.oid_subg_vent = reg2.zsgv_oid_subg_vent  
				                                      AND ag.zorg_oid_regi = reg.oid_regi(+)  
				                                      AND ag.copa_oid_para_gral IN (%value_NUMEROCONCURSOVALUES%)  
				                                 ORDER BY ag.copa_oid_para_gral, region) amb  
												   
				                   WHERE pcc.oid_part_conc_cabe = cpc.paci_oid_part_conc_cabe  
				                     AND cpg.oid_para_gral = cpc.copa_oid_para_gral  
				                     AND pcd.paci_oid_part_conc_cabe = pcc.oid_part_conc_cabe  
				                     AND amb.copa_oid_para_gral = cpg.oid_para_gral  
							 AND region.OID_REGI = amb.region  
							 AND PCD.TICL_OID_TIPO_CLIE = 4  
					      	        AND PCD.SBTI_OID_SUBT_CLIE = 3  
				                     AND cpg.ind_acti = 1  
				                     AND cpg.oid_para_gral IN (%value_NUMEROCONCURSOVALUES%)  
									   )  
				        GROUP BY oid_para_gral, concurso, VAL_OBSE) concu,  
				       (SELECT cpg.oid_para_gral,  
				                  vis.tipo_premio  
				               || ' '  
				               || vis.descripcion  
				               || ' '  
				               || vis.cantidad desc_pre  
				          FROM INC_CONCU_PARAM_GENER cpg,  
				               INC_PARAM_NIVEL_PREMI pnp,  
				               INC_PARAM_GENER_PREMI pgp,  
				               v_rep_premios vis  
				         WHERE cpg.oid_para_gral = pgp.copa_oid_para_gral  
				           AND pgp.oid_para_gene_prem = pnp.pagp_oid_para_gene_prem  
				           AND vis.oid_para_nive_prem = pnp.oid_para_nive_prem  
				           AND vis.idio_tipo_premio = %value_IDIOMAVALUE%  
				           AND cpg.oid_para_gral IN (%value_NUMEROCONCURSOVALUES%)  
							 ) premi  
				 WHERE concu.oid_para_gral = premi.oid_para_gral(+)  
				 		/* %value_REGIONVALUE% */  
				)  
				UNION  
%end_REGIONVALUE%          %start_ZONAVALUE%				  
				(  
				SELECT   
					   '3-GERENTES DE ZONA' DIRIGIDO,  
					   CONCURSO,  
					   PREMI.DESC_PRE,  
					  Pq_Apl_Rep.FN_070_CONCAT_PERI(CONCU.OID_PARA_GRAL) PERIODOS,  
					   REQUISITOS,  
					   TOTAL_CON,  
					   N_GANA,  
					   PORC  
					    
				FROM  
				(  
					SELECT OID_PARA_GRAL,  
						   CONCURSO,  
						   COUNT(*) TOTAL_CON, 	     
						   SUM(GANA) N_GANA,  
						   (SUM(GANA)*100)/COUNT(*) PORC, VAL_OBSE AS REQUISITOS  
					FROM   
					(  
						SELECT CPG.OID_PARA_GRAL, VAL_OBSE,  
							   CPG.VAL_NOMB||' '||CPG.NUM_CONC||' '||CPG.NUM_VERS CONCURSO,  
							   NVL((  
							   SELECT 1  
							   FROM INC_GANAD GANA,  
							   		INC_PARAM_GENER_PREMI PGP,  
									INC_PARAM_NIVEL_PREMI PNP			  
							   WHERE GANA.CLIE_OID_CLIE = ZONA.CLIE_OID_CLIE  
							   		 AND GANA.PANP_OID_PARA_NIVE_PREM = PNP.OID_PARA_NIVE_PREM  
									 AND PNP.PAGP_OID_PARA_GENE_PREM = PGP.OID_PARA_GENE_PREM   
									 AND PGP.COPA_OID_PARA_GRAL = CPG.OID_PARA_GRAL  
									 AND ROWNUM = 1  
							   ), 0) GANA	     
						FROM INC_PARTI_CONCU_CABEC PCC,  
							 INC_PARTI_CONCU_DETAL PCD,   
							 INC_CLASI_PARTI_CONCU CPC,  
							 INC_CONCU_PARAM_GENER CPG,  
							 (  
								SELECT DISTINCT   
									   AG.COPA_OID_PARA_GRAL,  
									   CASE WHEN ZON.OID_ZONA IS NULL THEN  
									   		CASE WHEN ZON3.OID_ZONA IS NULL THEN  
												  ZON2.OID_ZONA  
										    ELSE  
												 ZON3.OID_ZONA  
										    END   
									   ELSE  
									   	    ZON.OID_ZONA   
									   END ZONA     
								FROM INC_AMBIT_GEOGR AG,  
									 ZON_SUB_GEREN_VENTA SUBG,  
									 ZON_REGIO REG,  
									 ZON_REGIO REG2,  
									 ZON_ZONA ZON,  
									 ZON_ZONA ZON2,  
									 ZON_ZONA ZON3  
								WHERE AG.ZSGV_OID_SUBG_VENT = SUBG.OID_SUBG_VENT  
									  AND SUBG.OID_SUBG_VENT = REG2.ZSGV_OID_SUBG_VENT  
									  AND REG2.OID_REGI = ZON2.ZORG_OID_REGI  
									  AND AG.ZORG_OID_REGI = REG.OID_REGI(+)  
									  AND REG.OID_REGI = ZON3.ZORG_OID_REGI(+)  
									  AND AG.ZZON_OID_ZONA = ZON.OID_ZONA(+)  
									  AND AG.COPA_OID_PARA_GRAL IN (%value_NUMEROCONCURSOVALUES%)  	  
								ORDER BY AG.COPA_OID_PARA_GRAL,   
									  	ZONA  
							 ) AMB,  
							 ZON_ZONA ZONA  
						WHERE PCC.OID_PART_CONC_CABE = CPC.PACI_OID_PART_CONC_CABE  
							  AND CPG.OID_PARA_GRAL = CPC.COPA_OID_PARA_GRAL  
							  AND PCD.PACI_OID_PART_CONC_CABE = PCC.OID_PART_CONC_CABE  
							  AND AMB.COPA_OID_PARA_GRAL = CPG.OID_PARA_GRAL  
							  AND ZONA.OID_ZONA = AMB.ZONA  
							AND PCD.TICL_OID_TIPO_CLIE = 4  
					      	  AND PCD.SBTI_OID_SUBT_CLIE = 4  
								  AND CPG.IND_ACTI = 1	    
							  AND CPG.OID_PARA_GRAL IN (%value_NUMEROCONCURSOVALUES%) 	  
					)  
					GROUP BY OID_PARA_GRAL, CONCURSO, VAL_OBSE  
				) CONCU,  
				(  
					 SELECT CPG.OID_PARA_GRAL, 			 		  
					 		VIS.TIPO_PREMIO||' '||VIS.DESCRIPCION||' '||VIS.CANTIDAD DESC_PRE  
					 FROM INC_CONCU_PARAM_GENER CPG,  
					 	  INC_PARAM_NIVEL_PREMI PNP,  
						  INC_PARAM_GENER_PREMI PGP,  
						  V_REP_PREMIOS VIS				    
					 WHERE CPG.OID_PARA_GRAL = PGP.COPA_OID_PARA_GRAL  
					 	   AND PGP.OID_PARA_GENE_PREM = PNP.PAGP_OID_PARA_GENE_PREM  
						   AND VIS.OID_PARA_NIVE_PREM = PNP.OID_PARA_NIVE_PREM		  
						   AND VIS.IDIO_TIPO_PREMIO = %value_IDIOMAVALUE%			  
						   AND CPG.OID_PARA_GRAL IN (%value_NUMEROCONCURSOVALUES%)	  
				) PREMI  
				WHERE CONCU.OID_PARA_GRAL = PREMI.OID_PARA_GRAL(+)  
						/* %value_ZONAVALUE% */  
				)  
				UNION  
%end_ZONAVALUE%				  
				(  
				SELECT   
								NULL AS DIRIGIDO,  
								NULL AS CONCURSO,  
								NULL AS DESC_PRE,  
								NULL AS PERIODOS,  
								NULL AS REQUISITOS,  
								NULL AS TOTAL_CON,  
								NULL AS N_GANA,  
								NULL AS PORC  
				FROM  
								DUAL  
				WHERE 1=2  
				)  
)				 	  
" ExternalClassName="oracle.jdbc.driver.OracleDriver" ExternalSourceData="" ExternalConnectionString="" ExternalConnectionClassName="oracle.jdbc.driver.OracleDriver" ExternalConnectionLocalUrl="jdbc:oracle:thin:@192.168.118.106:1523:SICCV3D" ExternalConnectionDistributedUrl="" ExternalConnectionUser="own_peru" ExternalConnectionPassword="peru_own" DatePattern="" DateTimePattern=""/>  
	</DataSourceDefinitions>  
	<ParameterValues>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="IDIOMA" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="NULL_VALUE" FilterDefinitionName="SUBGERENCIAVENTA" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="NULL_VALUE" FilterDefinitionName="REGION" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="NULL_VALUE" FilterDefinitionName="ZONA" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="1, 1408, 1118, 1345" FilterDefinitionName="NUMEROCONCURSO" FilterParameter="VALUES"/>  
	</ParameterValues>  
	<Localizations/>  
</ReportSourceDefinition>  

