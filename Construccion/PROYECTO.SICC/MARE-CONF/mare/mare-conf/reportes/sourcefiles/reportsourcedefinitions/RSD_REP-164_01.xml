<?xml version="1.0" encoding="UTF-8"?>  
<ReportSourceDefinition Id="RSD_REP-164_01" Cached="false" Expiration="0" IncrementalDimension="" Multilanguage="false" MaxRowsDimensionReference="" >  
	<DimensionSourceDefinitions>  
		<DimensionSourceDefinition Name="PAIS" Description="PAIS" DataType="STRING" Calculated="false" Expression="" ExternalData="PAIS"/>  
		<DimensionSourceDefinition Name="SOCIEDAD" Description="SOCIEDAD" DataType="STRING" Calculated="false" Expression="" ExternalData="SOCIEDAD"/>  
		<DimensionSourceDefinition Name="VAL_SERI_DOCU_REFE" Description="VAL_SERI_DOCU_REFE" DataType="STRING" Calculated="false" Expression="" ExternalData="VAL_SERI_DOCU_REFE"/>  
		<DimensionSourceDefinition Name="VAL_NUME_DOCU_REFE" Description="VAL_NUME_DOCU_REFE" DataType="STRING" Calculated="false" Expression="" ExternalData="VAL_NUME_DOCU_REFE"/>  
		<DimensionSourceDefinition Name="SISTEMA_EMISION" Description="SISTEMA_EMISION" DataType="STRING" Calculated="false" Expression="" ExternalData="SISTEMA_EMISION"/>  
		<DimensionSourceDefinition Name="PUNTO_EMISION" Description="PUNTO_EMISION" DataType="STRING" Calculated="false" Expression="" ExternalData="PUNTO_EMISION"/>  
		<DimensionSourceDefinition Name="TIPO_DCMTO" Description="TIPO_DCMTO" DataType="STRING" Calculated="false" Expression="" ExternalData="TIPO_DCMTO"/>  
		<DimensionSourceDefinition Name="SERIE" Description="SERIE" DataType="STRING" Calculated="false" Expression="" ExternalData="SERIE"/>  
		<DimensionSourceDefinition Name="DOC_INICIAL" Description="DOC_INICIAL" DataType="STRING" Calculated="false" Expression="" ExternalData="DOC_INICIAL"/>  
		<DimensionSourceDefinition Name="DOC_FINAL" Description="DOC_FINAL" DataType="STRING" Calculated="false" Expression="" ExternalData="DOC_FINAL"/>  
	</DimensionSourceDefinitions>  
	<MetricSourceDefinitions>  
		<MetricSourceDefinition Name="IMP_IMPU" Description="IMP_IMPU" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="IMP_IMPU" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="CANT_DOC" Description="CANT_DOC" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="CANT_DOC" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="CANT_ANUL" Description="CANT_ANUL" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="CANT_ANUL" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="CANT_DOC_NO_REGIS" Description="CANT_DOC_NO_REGIS" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="CANT_DOC_NO_REGIS" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="BASE_IMPONIBLE" Description="BASE_IMPONIBLE" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="BASE_IMPONIBLE" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="DESCUENTO" Description="DESCUENTO" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="DESCUENTO" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="BASE_IMPO_NETO" Description="BASE_IMPO_NETO" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="BASE_IMPO_NETO" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="IGV" Description="IGV" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="IGV" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="IMPORTE_TOTAL" Description="IMPORTE_TOTAL" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="IMPORTE_TOTAL" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="TG" Description="TG" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="TG" ExternalCalculated="false"/>  
	</MetricSourceDefinitions>  
	<ParameterValues>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="IDIOMA" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="PAIS" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="01/02/2000" FilterDefinitionName="FECHADESDE" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="dd/mm/yyyy" FilterDefinitionName="FORMATOFECHA" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="CANAL" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="ACCESO" FilterParameter="VALUES"/>  
		<ParameterValue DefaultValue="NULL_VALUE" FilterDefinitionName="TIPODOCUMENTOLEGAL" FilterParameter="VALUES"/>  
		<ParameterValue DefaultValue="NULL_VALUE" FilterDefinitionName="SERIE" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="SUBACCESO" FilterParameter="VALUES"/>  
		<ParameterValue DefaultValue="11/02/2030" FilterDefinitionName="FECHAHASTA" FilterParameter="VALUE"/>  
	</ParameterValues>  
	<FilterDefinitions>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="IDIOMA" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="PAIS" Visual="FALSE"/>  
		<FilterDefinition DataType="STRING" FilterType="EQUALTO" Name="FORMATOFECHA" Visual="FALSE"/>  
		<FilterDefinition DataType="DATE" FilterType="EQUALTO" Name="FECHADESDE" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="CANAL" Visual="FALSE"/>  
		<FilterDefinition DataType="STRING" FilterType="IN" Name="ACCESO" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="IN" Name="SUBACCESO" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="IN" Name="TIPODOCUMENTOLEGAL" Visual="FALSE"/>  
		<FilterDefinition DataType="STRING" FilterType="EQUALTO" Name="SERIE" Visual="FALSE"/>  
		<FilterDefinition DataType="DATE" FilterType="EQUALTO" Name="FECHAHASTA" Visual="FALSE"/>  
	</FilterDefinitions>  
	<DataSourceDefinitions>  
		<DataSourceDefinition Name="REP-164_01" SourceType="SQL" Expression="SELECT   
         gen_pais.pais,  
         gen_soc.sociedad,  
         reg.VAL_SERI_DOCU_REFE,  
         reg.VAL_NUME_DOCU_REFE,  
         reg.IMP_IMPU,  
         gen_acc.acceso as sistema_emision,  
         gen_subac.subacceso as punto_emision,  
         t_doc.COD_TIPO_DOCU as tipo_dcmto,  
         reg.VAL_SERI_DOCU_LEGA as serie,  
         min(reg.NUM_DOCU_CONT_INTE) as doc_inicial,  
         max(reg.NUM_DOCU_CONT_INTE) as doc_final,  
         max(reg.NUM_DOCU_CONT_INTE) - min(reg.NUM_DOCU_CONT_INTE) as cant_doc,  
         sum(reg.IND_ESTA) as cant_anul,  
         max(reg.VAL_NUME_DOCU_LEGA) - min(reg.VAL_NUME_DOCU_LEGA) - count(reg.IND_ESTA) as cant_doc_no_regis,   
         sum(reg.VAL_BASE_IMPO) as base_imponible,  
         sum(reg.VAL_DESC) as descuento,  
         sum(reg.VAL_BASE_IMPO_NETO) as base_impo_neto,  
         sum(reg.IMP_IMPU) as igv,  
         sum(reg.IMP_TOTA) as importe_total,  
         sum(reg.IND_FACT_GRAT) as tg  
from fac_regis_unico_venta reg,  
       fac_tipo_docum t_doc,  
       fac_tipo_docum t_doc_r,  
       seg_subac subac,  
       seg_acces acc,  
       (  
        select val_oid, val_i18n pais  
        from v_gen_i18n_sicc  
        where attr_enti = 'SEG_PAIS'  
                  and idio_oid_idio = %value_IDIOMAVALUE%  
       )gen_pais,  
       (  
        select oid_soci val_oid, val_deno sociedad  
        from seg_socie  
       )gen_soc,  
       (  
        select val_oid, val_i18n acceso  
        from v_gen_i18n_sicc  
        where attr_enti ='SEG_ACCES'  
               and idio_oid_idio = %value_IDIOMAVALUE%  
       )gen_acc,  
       (  
        select val_oid, val_i18n subacceso  
        from v_gen_i18n_sicc  
        where attr_enti ='SEG_SUBAC'  
               and idio_oid_idio = %value_IDIOMAVALUE%  
       )gen_subac  
where   
        reg.SBAC_OID_SBAC = subac.OID_SBAC  
        and reg.PAIS_OID_PAIS = gen_pais.val_oid(+)  
        and reg.TIDO_OID_TIPO_DOCU = t_doc.OID_TIPO_DOCU(+)  
        and reg.TIDO_TIPO_DOCU_REFE = t_doc_r.OID_TIPO_DOCU(+)  
        and reg.SOCI_OID_SOCI = gen_soc.val_oid  
        and subac.ACCE_OID_ACCE = acc.oid_acce  
        and reg.SBAC_OID_SBAC in (%value_SUBACCESOVALUES%)   
        and reg.PAIS_OID_PAIS = %value_PAISVALUE%  
      	%start_TIPODOCUMENTOLEGALVALUES%  and reg.TIDO_OID_TIPO_DOCU in (%value_TIPODOCUMENTOLEGALVALUES%) %end_TIPODOCUMENTOLEGALVALUES%  
        and subac.ACCE_OID_ACCE in (%value_ACCESOVALUES%)  
        and acc.CANA_OID_CANA = %value_CANALVALUE%  
        and TO_DATE(reg.FEC_EMIS) BETWEEN to_date(%value_FECHADESDEVALUE%, %value_FORMATOFECHAVALUE%)  and to_date(%value_FECHAHASTAVALUE%,%value_FORMATOFECHAVALUE%)  
        and acc.oid_acce = gen_acc.val_oid  
        and subac.OID_SBAC = gen_subac.val_oid  
      	%start_SERIEVALUE% and reg.VAL_SERI_DOCU_LEGA LIKE %value_SERIEVALUE% %end_SERIEVALUE%        
group by gen_pais.pais,  
         gen_soc.sociedad,  
         reg.VAL_SERI_DOCU_REFE,  
         reg.VAL_NUME_DOCU_REFE,  
         reg.IMP_IMPU,  
         gen_acc.acceso,  
         gen_subac.subacceso,  
         t_doc.COD_TIPO_DOCU,  
         reg.VAL_SERI_DOCU_LEGA  
" ExternalClassName="oracle.jdbc.driver.OracleDriver" ExternalSourceData="" ExternalConnectionString="" ExternalConnectionClassName="oracle.jdbc.driver.OracleDriver" ExternalConnectionLocalUrl="jdbc:oracle:thin:@192.168.118.106:1523:SICCV3D" ExternalConnectionDistributedUrl="" ExternalConnectionUser="usu_peru" ExternalConnectionPassword="peru" DatePattern="" DateTimePattern=""/>  
	</DataSourceDefinitions>  
</ReportSourceDefinition>  

