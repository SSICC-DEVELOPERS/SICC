<?xml version="1.0" encoding="UTF-8"?>  
<!-- edited with XMLSPY v2004 rel. 2 U (http://www.xmlspy.com) by team (renegade) -->  
<ReportSourceDefinition Id="RSD_RFD-002" Cached="false" Expiration="0" IncrementalDimension="" Multilanguage="false" MaxRowsDimensionReference="" >  
	<DimensionSourceDefinitions>  
		<DimensionSourceDefinition Name="SOCIEDAD_DEFECTO" Description="SOCIEDAD_DEFECTO" DataType="STRING" Calculated="false" Expression="" ExternalData="SOCIEDAD_DEFECTO"/>  
		<DimensionSourceDefinition Name="PAIS" Description="PAIS" DataType="STRING" Calculated="false" Expression="" ExternalData="PAIS"/>  
		<DimensionSourceDefinition Name="DES_REGI" Description="DES_REGI" DataType="STRING" Calculated="false" Expression="" ExternalData="DES_REGI"/>  
		<DimensionSourceDefinition Name="DES_ZONA" Description="DES_ZONA" DataType="STRING" Calculated="false" Expression="" ExternalData="DES_ZONA"/>  
		<DimensionSourceDefinition Name="AAAA" Description="AAAA" DataType="STRING" Calculated="false" Expression="" ExternalData="AAAA"/>  
		<DimensionSourceDefinition Name="GRUPO" Description="GRUPO" DataType="STRING" Calculated="false" Expression="" ExternalData="GRUPO"/>  
		<DimensionSourceDefinition Name="VAL_NOMB_PERI" Description="VAL_NOMB_PERI" DataType="STRING" Calculated="false" Expression="" ExternalData="VAL_NOMB_PERI"/>  
		<DimensionSourceDefinition Name="PERI_FIN" Description="PERI_FIN" DataType="STRING" Calculated="false" Expression="" ExternalData="PERI_FIN"/>  
	</DimensionSourceDefinitions>  
	<MetricSourceDefinitions>  
		<MetricSourceDefinition Name="INGRESOS_REALAA" Description="INGRESOS_REALAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="INGRESOS_REALAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="INGRESOS_REALAAAA" Description="INGRESOS_REALAAAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="INGRESOS_REALAAAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="INGRESOS_PLAN" Description="INGRESOS_PLAN" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="INGRESOS_PLAN" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="INGRESOS_PORC_REALAAAA_REALAA" Description="INGRESOS_PORC_REALAAAA_REALAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="INGRESOS_PORC_REALAAAA_REALAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="INGRESOS_PORC_REALAAAA_PLAN" Description="INGRESOS_PORC_REALAAAA_PLAN" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="INGRESOS_PORC_REALAAAA_PLAN" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="REINGRESOS_REALAA" Description="REINGRESOS_REALAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="REINGRESOS_REALAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="REINGRESOS_REALAAAA" Description="REINGRESOS_REALAAAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="REINGRESOS_REALAAAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="REINGRESOS_PLAN" Description="REINGRESOS_PLAN" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="REINGRESOS_PLAN" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="REINGRE_PORC_REALAAAA_REALAA" Description="REINGRE_PORC_REALAAAA_REALAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="REINGRE_PORC_REALAAAA_REALAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="REINGRE_PORC_REALAAAA_PLAN" Description="REINGRE_PORC_REALAAAA_PLAN" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="REINGRE_PORC_REALAAAA_PLAN" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="EGRESOS_REALAA" Description="EGRESOS_REALAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="EGRESOS_REALAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="EGRESOS_REALAAAA" Description="EGRESOS_REALAAAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="EGRESOS_REALAAAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="EGRESOS_PLAN" Description="EGRESOS_PLAN" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="EGRESOS_PLAN" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="EGRESOS_PORC_REALAAAA_REALAA" Description="EGRESOS_PORC_REALAAAA_REALAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="EGRESOS_PORC_REALAAAA_REALAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="EGRESOS_PORC_REALAAAA_PLAN" Description="EGRESOS_PORC_REALAAAA_PLAN" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="EGRESOS_PORC_REALAAAA_PLAN" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="CAPITALIZACION_REALAA" Description="CAPITALIZACION_REALAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="CAPITALIZACION_REALAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="CAPITALIZACION_REALAAAA" Description="CAPITALIZACION_REALAAAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="CAPITALIZACION_REALAAAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="CAPITALIZACION_PLANAAAA" Description="CAPITALIZACION_PLANAAAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="CAPITALIZACION_PLANAAAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="CAPI_PORC_REALAAAA_REALAA" Description="CAPI_PORC_REALAAAA_REALAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="CAPI_PORC_REALAAAA_REALAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="CAPI_PORC_REALAAAA_PLANAAAA" Description="CAPI_PORC_REALAAAA_PLANAAAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="CAPI_PORC_REALAAAA_PLANAAAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="RECIBIDAS_REALAA" Description="RECIBIDAS_REALAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="RECIBIDAS_REALAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="RECIBIDAS_REALAAAA" Description="RECIBIDAS_REALAAAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="RECIBIDAS_REALAAAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="ENTREGADAS_REALAA" Description="ENTREGADAS_REALAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="ENTREGADAS_REALAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="ENTREGADAS_REALAAAA" Description="ENTREGADAS_REALAAAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="ENTREGADAS_REALAAAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="CRECIMIENTO_ANUAL" Description="CRECIMIENTO_ANUAL" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="CRECIMIENTO_ANUAL" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="IND_PARA_TOTAL_CAMPANIA_FIN" Description="IND_PARA_TOTAL_CAMPANIA_FIN" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="IND_PARA_TOTAL_CAMPANIA_FIN" ExternalCalculated="false"/>  
	</MetricSourceDefinitions>  
	<FilterDefinitions>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="IDIOMA" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="PAIS" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="CANAL" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="MARCA" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="PERIODODESDE" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="PERIODOHASTA" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="REGION" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="ZONA" Visual="FALSE"/>  
		<FilterDefinition DataType="STRING" FilterType="EQUALTO" Name="ZONEUSER" Visual="FALSE"/>  
	</FilterDefinitions>  
	<DataSourceDefinitions>  
		<DataSourceDefinition Name="RFD-002" SourceType="SQL" Expression="  
		  
		  
  
SELECT *  
FROM  
(  
 	SELECT SOC.VAL_DENO SOCIEDAD_DEFECTO  
	FROM PRINCIPALS PRI,  
		PROPERTYVALUES PRO,  
		SEG_SOCIE SOC			  
	WHERE PRI.NAME = %value_ZONEUSERVALUE%  
		 AND SOC.OID_SOCI = PRO.STRINGVALUE  
		 AND PRO.IDPROPERTY = 48  
		 AND PRO.IDPRINCIPAL = PRI.IDPRINCIPAL  
),  
(  
	SELECT DATOS_AAAA.PAIS,  
		   DATOS_AAAA.DES_REGI,  
		   DATOS_AAAA.DES_ZONA,  
		   DATOS_AAAA.VAL_ANIO AAAA,  
	       TRUNC(((DATOS_AAAA.COD_PERI) - 1)/6) +1 GRUPO,  
		   DATOS_AAAA.VAL_NOMB_PERI,  
	  
		   DATOS_AA.INGRESOS INGRESOS_REALAA,  
		   DATOS_AAAA.INGRESOS INGRESOS_REALAAAA,  
		   DATOS_AAAA.PLAN_INGRESOS INGRESOS_PLAN,  
		   CASE WHEN (DATOS_AAAA.INGRESOS IS NOT NULL) THEN  
		   	   ROUND(DECODE(DATOS_AA.INGRESOS, 0, 0, ((DATOS_AAAA.INGRESOS / DATOS_AA.INGRESOS)-1)*100))  
		   END INGRESOS_PORC_REALAAAA_REALAA,  
		   CASE WHEN (DATOS_AAAA.INGRESOS IS NOT NULL) THEN  
		   	   ROUND(DECODE(DATOS_AAAA.PLAN_INGRESOS, 0, 0, ((DATOS_AAAA.INGRESOS / DATOS_AAAA.PLAN_INGRESOS)-1)*100))  
		   END INGRESOS_PORC_REALAAAA_PLAN,  
	  
		   DATOS_AA.REINGRESOS REINGRESOS_REALAA,  
		   DATOS_AAAA.REINGRESOS REINGRESOS_REALAAAA,  
		   DATOS_AAAA.PLAN_REINGRESOS REINGRESOS_PLAN,  
		   CASE WHEN (DATOS_AAAA.REINGRESOS IS NOT NULL) THEN  
		   	   ROUND(DECODE(DATOS_AA.REINGRESOS, 0, 0, ((DATOS_AAAA.REINGRESOS / DATOS_AA.REINGRESOS)-1)*100))  
		   END REINGRE_PORC_REALAAAA_REALAA,  
		   CASE WHEN (DATOS_AAAA.REINGRESOS IS NOT NULL) THEN  
		   	   ROUND(DECODE(DATOS_AAAA.PLAN_REINGRESOS, 0, 0, ((DATOS_AAAA.REINGRESOS / DATOS_AAAA.PLAN_REINGRESOS)-1)*100))  
		   END REINGRE_PORC_REALAAAA_PLAN,  
	  
		   DATOS_AA.EGRESOS EGRESOS_REALAA,  
		   DATOS_AAAA.EGRESOS EGRESOS_REALAAAA,  
		   DATOS_AAAA.PLAN_EGRESOS EGRESOS_PLAN,  
		   CASE WHEN (DATOS_AAAA.EGRESOS IS NOT NULL) THEN  
		   	   ROUND(DECODE(DATOS_AA.EGRESOS, 0, 0, ((DATOS_AAAA.EGRESOS / DATOS_AA.EGRESOS)-1)*100))  
		   END EGRESOS_PORC_REALAAAA_REALAA,  
		   CASE WHEN (DATOS_AAAA.EGRESOS IS NOT NULL) THEN  
		   		ROUND(DECODE(DATOS_AAAA.PLAN_EGRESOS, 0, 0, ((DATOS_AAAA.EGRESOS / DATOS_AAAA.PLAN_EGRESOS)-1)*100))  
		   END EGRESOS_PORC_REALAAAA_PLAN,  
	  
		   (DATOS_AA.INGRESOS + DATOS_AA.REINGRESOS) - DATOS_AA.EGRESOS CAPITALIZACION_REALAA,  
		   (DATOS_AAAA.INGRESOS + DATOS_AAAA.REINGRESOS) - DATOS_AAAA.EGRESOS CAPITALIZACION_REALAAAA,	    	     
		   (DATOS_AAAA.PLAN_INGRESOS + DATOS_AAAA.PLAN_REINGRESOS) - DATOS_AAAA.PLAN_EGRESOS CAPITALIZACION_PLANAAAA,  
		   CASE WHEN (DATOS_AAAA.INGRESOS IS NOT NULL) THEN  
		   		ROUND(DECODE(((DATOS_AA.INGRESOS + DATOS_AA.REINGRESOS) - DATOS_AA.EGRESOS), 0, 0, ((((DATOS_AAAA.INGRESOS + DATOS_AAAA.REINGRESOS) - DATOS_AAAA.EGRESOS) / ((DATOS_AA.INGRESOS + DATOS_AA.REINGRESOS) - DATOS_AA.EGRESOS))-1)*100))  
		   END CAPI_PORC_REALAAAA_REALAA,  
		   CASE WHEN (DATOS_AAAA.INGRESOS IS NOT NULL) THEN  
		   		ROUND(DECODE(((DATOS_AAAA.PLAN_INGRESOS + DATOS_AAAA.PLAN_REINGRESOS) - DATOS_AAAA.PLAN_EGRESOS), 0, 0, ((((DATOS_AAAA.INGRESOS + DATOS_AAAA.REINGRESOS) - DATOS_AAAA.EGRESOS) / ((DATOS_AAAA.PLAN_INGRESOS + DATOS_AAAA.PLAN_REINGRESOS) - DATOS_AAAA.PLAN_EGRESOS))-1)*100))  
		   END CAPI_PORC_REALAAAA_PLANAAAA,  
	  
		   DATOS_AA.REZO_RECIBIDAS RECIBIDAS_REALAA,  
		   DATOS_AAAA.REZO_RECIBIDAS RECIBIDAS_REALAAAA,  
	   
		   DATOS_AA.REZO_ENTREGADAS ENTREGADAS_REALAA,  
		   DATOS_AAAA.REZO_ENTREGADAS ENTREGADAS_REALAAAA,  
	  
                SUM(  (datos_aaaa.ingresos + datos_aaaa.reingresos) - datos_aaaa.EGRESOS) OVER (PARTITION BY  DES_REGI, DES_ZONA ORDER BY VAL_NOMB_PERI) CRECIMIENTO_ANUAL,	  
		IND_PERI_FIN IND_PARA_TOTAL_CAMPANIA_FIN,  
		PERI_FIN  
	FROM  
	(  
		SELECT V_AAAA.PAIS,  
			   V_AAAA.OID_REGI,  
			   V_AAAA.DES_REGI,  
			   V_AAAA.OID_ZONA,  
			   V_AAAA.DES_ZONA,  
			   V_AAAA.VAL_ANIO,  
			   SUBSTR(V_AAAA.COD_PERI,5,2) COD_PERI,  
			   V_AAAA.VAL_NOMB_PERI,  
			   DATOS_AAAA.INGRESOS,  
			   DATOS_AAAA.REINGRESOS,  
			   DATOS_AAAA.EGRESOS,  
			   DATOS_AAAA.REZO_RECIBIDAS,  
			   DATOS_AAAA.REZO_ENTREGADAS,  
			   V_AAAA.INGRESOS PLAN_INGRESOS,  
			   V_AAAA.REINGRESOS PLAN_REINGRESOS,  
			   V_AAAA.EGRESOS PLAN_EGRESOS,  
			   V_AAAA.IND_PERI_FIN,  
			   V_AAAA.PERI_FIN  
		FROM  
		(  
			SELECT REG.OID_REGI,  
				   ZONA.OID_ZONA,  
				   PERI.OID_PERI,  
				   NVL((  
				   SELECT SUM(VR.NUM_INGR)  
				   FROM INT_FUENT_VENTAS_REAL VR  
				   WHERE VR.PAIS_OID_PAIS =  %value_PAISVALUE%	  
  
				   	  AND VR.PERD_OID_PERI = PERI.OID_PERI  
				  	  AND VR.ZORG_OID_REGI = REG.OID_REGI				  
					  AND VR.ZZON_OID_ZONA = ZONA.OID_ZONA				  
				   GROUP BY REG.OID_REGI,  
				   		 	ZONA.OID_ZONA,  
							PERI.OID_PERI   
				   ), 0) INGRESOS,  
				   NVL((  
				   SELECT SUM(VR.NUM_REIN)  
				   FROM INT_FUENT_VENTAS_REAL VR  
				   WHERE VR.PAIS_OID_PAIS =  %value_PAISVALUE%	  
  
				   	  AND VR.PERD_OID_PERI = PERI.OID_PERI  
				  	  AND VR.ZORG_OID_REGI = REG.OID_REGI					  
					  AND VR.ZZON_OID_ZONA = ZONA.OID_ZONA					  
				   GROUP BY REG.OID_REGI,  
				   		 	ZONA.OID_ZONA,   
							PERI.OID_PERI   
				   ), 0) REINGRESOS,  
				   NVL((  
				   SELECT SUM(VR.NUM_EGRE)  
				   FROM INT_FUENT_VENTAS_REAL VR  
				   WHERE VR.PAIS_OID_PAIS =  %value_PAISVALUE%	  
  
				   	  AND VR.PERD_OID_PERI = PERI.OID_PERI  
				  	  AND VR.ZORG_OID_REGI = REG.OID_REGI				  
					  AND VR.ZZON_OID_ZONA = ZONA.OID_ZONA				  
				   GROUP BY REG.OID_REGI,  
				   		 	ZONA.OID_ZONA,   
							PERI.OID_PERI   
				   ), 0) EGRESOS,  
				   NVL((  
				   SELECT SUM(VR.NUM_REZO_RECI)  
				   FROM INT_FUENT_VENTAS_REAL VR  
				   WHERE VR.PAIS_OID_PAIS =  %value_PAISVALUE%	  
  
				   	  AND VR.PERD_OID_PERI = PERI.OID_PERI  
				  	  AND VR.ZORG_OID_REGI = REG.OID_REGI					  
					  AND VR.ZZON_OID_ZONA = ZONA.OID_ZONA					  
				   GROUP BY REG.OID_REGI,  
				   		 	ZONA.OID_ZONA,  
				   		 	PERI.OID_PERI   
				   ), 0) REZO_RECIBIDAS,  
				   NVL((  
				   SELECT SUM(VR.NUM_REZO_ENTR)  
				   FROM INT_FUENT_VENTAS_REAL VR  
				   WHERE VR.PAIS_OID_PAIS =  %value_PAISVALUE%	  
  
				   	  AND VR.PERD_OID_PERI = PERI.OID_PERI  
				  	  AND VR.ZORG_OID_REGI = REG.OID_REGI				  
					  AND VR.ZZON_OID_ZONA = ZONA.OID_ZONA				  
				   GROUP BY REG.OID_REGI,  
				   		 	ZONA.OID_ZONA,  
				   		 	PERI.OID_PERI   
				   ), 0) REZO_ENTREGADAS			   	     
			FROM CRA_PERIO PERI,  
				 ZON_ZONA ZONA,  
				 ZON_REGIO REG,  
								 (  
				 SELECT PER_COR.OID_PERI,  
				 		PER_COR.COD_PERI  
				 FROM SEG_PERIO_CORPO PER_COR  
				 WHERE PER_COR.VAL_ANIO = (  
								 SELECT PER_COR.VAL_ANIO  
								 FROM SEG_PERIO_CORPO PER_COR,  
									  CRA_PERIO PERI   
								 WHERE PERI.OID_PERI = %value_PERIODODESDEVALUE%      
								   AND PERI.PERI_OID_PERI = PER_COR.OID_PERI    	    
										 )   
				) PC  
			WHERE PERI.PERI_OID_PERI = PC.OID_PERI  
				  AND ZONA.ZORG_OID_REGI = REG.OID_REGI  
				  AND PERI.PAIS_OID_PAIS = %value_PAISVALUE%	  
				 AND PERI.PAIS_OID_PAIS = REG.PAIS_OID_PAIS  
				  AND PERI.MARC_OID_MARC = %value_MARCAVALUE%  
				  AND PERI.CANA_OID_CANA =  %value_CANALVALUE%  
				%start_ZONAVALUE%    AND ZONA.OID_ZONA =  %value_ZONAVALUE%  %end_ZONAVALUE%   
		        %start_REGIONVALUE%   and reg.oid_regi in  (%value_REGIONVALUE%)  %end_REGIONVALUE%   
  
				    
				    
		) DATOS_AAAA,  
		(  
		SELECT GEN_PAIS.VAL_I18N PAIS,  
			   REG.OID_REGI,  
			   REG.DES_REGI,  
			   ZONA.OID_ZONA,  
			   ZONA.DES_ZONA,  
			   PC.VAL_ANIO,  
			   PC.COD_PERI,  
			   PC.IND_PERI_FIN,  
			   PC.PERI_FIN,  
			   PERI.OID_PERI,  
			   PERI.VAL_NOMB_PERI,  
			   NVL((  
			   SELECT SUM(FVP.NUM_INGR)  
			   FROM INT_FUENT_VENTA_PREVI_SAP FVP  
			   WHERE FVP.PERD_OID_PERI = PERI.OID_PERI  
			   		 AND FVP.ZORG_OID_REGI = REG.OID_REGI  
					 AND FVP.ZZON_OID_ZONA = ZONA.OID_ZONA  
			   GROUP BY REG.OID_REGI,  
			   		 ZONA.OID_ZONA,  
					 PERI.OID_PERI		   		   
			   ), 0) INGRESOS,  
			   NVL((  
			   SELECT SUM(FVP.NUM_REIN)  
			   FROM INT_FUENT_VENTA_PREVI_SAP FVP  
			   WHERE FVP.PERD_OID_PERI = PERI.OID_PERI  
			   		 AND FVP.ZORG_OID_REGI = REG.OID_REGI  
					 AND FVP.ZZON_OID_ZONA = ZONA.OID_ZONA  
			   GROUP BY REG.OID_REGI,  
			   		 ZONA.OID_ZONA,  
					 PERI.OID_PERI		   		   
			   ), 0) REINGRESOS,  
			   NVL((  
			   SELECT SUM(FVP.NUM_EGRE)  
			   FROM INT_FUENT_VENTA_PREVI_SAP FVP  
			   WHERE FVP.PERD_OID_PERI = PERI.OID_PERI  
			   		 AND FVP.ZORG_OID_REGI = REG.OID_REGI  
					 AND FVP.ZZON_OID_ZONA = ZONA.OID_ZONA  
			   GROUP BY REG.OID_REGI,  
			   		 ZONA.OID_ZONA,  
					 PERI.OID_PERI		   		   
			   ), 0) EGRESOS  
		FROM CRA_PERIO PERI,  
			 ZON_ZONA ZONA,  
			 ZON_REGIO REG,  
		 (  
		 SELECT PER_COR.OID_PERI,  
				PER_COR.COD_PERI,  
				PER_COR.VAL_ANIO,  
				CASE WHEN ( PER_COR.COD_PERI &lt;= P.COD_PERI) THEN  
						  1  
				ELSE  
						  0  
				END IND_PERI_FIN,  
				SUBSTR(P.COD_PERI, LENGTH(P.COD_PERI)-1, LENGTH(P.COD_PERI)) PERI_FIN  
		 FROM SEG_PERIO_CORPO PER_COR,  
								 (  
								 SELECT PER_COR.VAL_ANIO, PER_COR.COD_PERI  
								 FROM SEG_PERIO_CORPO PER_COR,  
									  CRA_PERIO PERI   
								 WHERE PERI.OID_PERI = %value_PERIODOHASTAVALUE%    		   
									   AND PERI.PERI_OID_PERI = PER_COR.OID_PERI								    	    
								 ) P  
		 WHERE PER_COR.VAL_ANIO = P.VAL_ANIO  
		) PC,  
			(  
			SELECT GEN.VAL_OID, GEN.VAL_I18N  
			FROM V_GEN_I18N_SICC GEN  
			WHERE GEN.ATTR_ENTI = 'SEG_PAIS'  
				  AND GEN.IDIO_OID_IDIO = %value_IDIOMAVALUE%      
  
			) GEN_PAIS  
		WHERE PERI.PERI_OID_PERI = PC.OID_PERI   
			  AND GEN_PAIS.VAL_OID(+) = PERI.PAIS_OID_PAIS  
			  AND PERI.MARC_OID_MARC = %value_MARCAVALUE%	  
  
			  AND PERI.CANA_OID_CANA = %value_CANALVALUE%	  
  
			  AND PERI.PAIS_OID_PAIS = %value_PAISVALUE%	  
				 AND PERI.PAIS_OID_PAIS = REG.PAIS_OID_PAIS  
			  AND ZONA.ZORG_OID_REGI = REG.OID_REGI  
			 AND ZONA.PAIS_OID_PAIS = REG.PAIS_OID_PAIS   
		  	%start_ZONAVALUE%    AND ZONA.OID_ZONA =  %value_ZONAVALUE%  %end_ZONAVALUE%   
		%start_REGIONVALUE%   and reg.oid_regi in  (%value_REGIONVALUE%)  %end_REGIONVALUE%   
  
			    
		) V_AAAA  
		WHERE DATOS_AAAA.OID_PERI(+) = V_AAAA.OID_PERI  
			  AND DATOS_AAAA.OID_REGI(+) = V_AAAA.OID_REGI  
			  AND DATOS_AAAA.OID_ZONA(+) = V_AAAA.OID_ZONA  
	) DATOS_AAAA,  
	(	   
	    SELECT  OID_REGI,  
		  		OID_ZONA,  
				SUBSTR(COD_PERI,5,2) COD_PERI,  
		  	   INGRESOS,  
			   REINGRESOS,  
			   EGRESOS,  
			   REZO_ENTREGADAS,  
			   REZO_RECIBIDAS	  
		FROM  
	 	 (  
			SELECT REG.OID_REGI,  
				   ZONA.OID_ZONA,  
				   PC.COD_PERI,  
				   NVL((  
					   SELECT SUM(VR.NUM_INGR)  
					   FROM INT_FUENT_VENTAS_REAL VR  
					   WHERE VR.PAIS_OID_PAIS = %value_PAISVALUE%	  
  
					   	  AND VR.PERD_OID_PERI = PERI.OID_PERI  
					  	  AND VR.ZORG_OID_REGI = REG.OID_REGI				  
						  AND VR.ZZON_OID_ZONA = ZONA.OID_ZONA				  
					   GROUP BY REG.OID_REGI,  
					   		 	ZONA.OID_ZONA,  
					   		 	PERI.OID_PERI   
				   ), 0) INGRESOS,  
					 NVL((  
					   SELECT SUM(VR.NUM_REIN)  
					   FROM INT_FUENT_VENTAS_REAL VR  
					   WHERE VR.PAIS_OID_PAIS = %value_PAISVALUE%	  
  
					   	  AND VR.PERD_OID_PERI = PERI.OID_PERI  
					  	  AND VR.ZORG_OID_REGI = REG.OID_REGI				  
						  AND VR.ZZON_OID_ZONA = ZONA.OID_ZONA				  
					   GROUP BY REG.OID_REGI,  
					   		 	ZONA.OID_ZONA,  
								PERI.OID_PERI   
					   ), 0) REINGRESOS,  
					   NVL((  
					   SELECT SUM(VR.NUM_EGRE)  
					   FROM INT_FUENT_VENTAS_REAL VR  
					   WHERE VR.PAIS_OID_PAIS = %value_PAISVALUE%	  
  
					   	  AND VR.PERD_OID_PERI = PERI.OID_PERI  
					  	  AND VR.ZORG_OID_REGI = REG.OID_REGI					  
						  AND VR.ZZON_OID_ZONA = ZONA.OID_ZONA					  
					   GROUP BY REG.OID_REGI,  
					   		 	ZONA.OID_ZONA,  
					   		 	PERI.OID_PERI   
					   ), 0) EGRESOS,  
					   NVL((  
					   SELECT SUM(VR.NUM_REZO_RECI)  
					   FROM INT_FUENT_VENTAS_REAL VR  
					   WHERE VR.PAIS_OID_PAIS = %value_PAISVALUE%	  
  
					   	  AND VR.PERD_OID_PERI = PERI.OID_PERI  
					  	  AND VR.ZORG_OID_REGI = REG.OID_REGI					  
						  AND VR.ZZON_OID_ZONA = ZONA.OID_ZONA					  
					   GROUP BY REG.OID_REGI,  
					   		 	ZONA.OID_ZONA,  
					   		 	PERI.OID_PERI   
					   ), 0) REZO_RECIBIDAS,  
					   NVL((  
					   SELECT SUM(VR.NUM_REZO_ENTR)  
					   FROM INT_FUENT_VENTAS_REAL VR  
					   WHERE VR.PAIS_OID_PAIS = %value_PAISVALUE%	  
  
					   	  AND VR.PERD_OID_PERI = PERI.OID_PERI  
					  	  AND VR.ZORG_OID_REGI = REG.OID_REGI				  
						  AND VR.ZZON_OID_ZONA = ZONA.OID_ZONA				  
					   GROUP BY REG.OID_REGI,  
					   		 	ZONA.OID_ZONA,  
					   		 	PERI.OID_PERI   
					   ), 0) REZO_ENTREGADAS			   	     
			FROM CRA_PERIO PERI,  
				 ZON_ZONA ZONA,  
				 ZON_REGIO REG,  
				 (  
				 SELECT PER_COR.OID_PERI,  
				 		PER_COR.COD_PERI  
				 FROM SEG_PERIO_CORPO PER_COR  
				 WHERE PER_COR.VAL_ANIO = (  
			   							 SELECT PER_COR.VAL_ANIO  
										 FROM SEG_PERIO_CORPO PER_COR,  
										 	  CRA_PERIO PERI   
										 WHERE PERI.OID_PERI = %value_PERIODODESDEVALUE%      
  
										 	   AND PERI.PERI_OID_PERI = PER_COR.OID_PERI								    	    
										 ) - 1   
				) PC  
			WHERE PERI.PERI_OID_PERI = PC.OID_PERI  
				  AND PERI.MARC_OID_MARC = %value_MARCAVALUE%	  
				  AND PERI.CANA_OID_CANA = %value_CANALVALUE%	  
				  AND PERI.PAIS_OID_PAIS =  %value_PAISVALUE%	  
  
				  AND REG.PAIS_OID_PAIS =  PERI.PAIS_OID_PAIS  
				  AND REG.MARC_OID_MARC =  PERI.MARC_OID_MARC  
				  AND REG.CANA_OID_CANA = PERI.CANA_OID_CANA  
	   
				  AND ZONA.ZORG_OID_REGI = REG.OID_REGI  
				  			 AND ZONA.PAIS_OID_PAIS = REG.PAIS_OID_PAIS  
			    %start_ZONAVALUE%    AND ZONA.OID_ZONA =  %value_ZONAVALUE%  %end_ZONAVALUE%   
		%start_REGIONVALUE%   and reg.oid_regi in  (%value_REGIONVALUE%)  %end_REGIONVALUE%   
		  
  
		)  
	) DATOS_AA  
WHERE DATOS_AAAA.COD_PERI = DATOS_AA.COD_PERI(+)  
	  AND DATOS_AAAA.OID_REGI = DATOS_AA.OID_REGI(+)  
	  AND DATOS_AAAA.OID_ZONA = DATOS_AA.OID_ZONA(+)  
	  
)		    
 %and_prefilter% ORDER BY DES_REGI,  
	  	 DES_ZONA,  
		 GRUPO,  
		 VAL_NOMB_PERI  
		  
" ExternalClassName="oracle.jdbc.driver.OracleDriver" ExternalSourceData="" ExternalConnectionString="" ExternalConnectionClassName="oracle.jdbc.driver.OracleDriver" ExternalConnectionLocalUrl="jdbc:oracle:thin:@192.168.118.106:1523:SICCV3D" ExternalConnectionDistributedUrl="" ExternalConnectionUser="usu_peru" ExternalConnectionPassword="peru" DatePattern="" DateTimePattern=""/>  
	</DataSourceDefinitions>  
	<ParameterValues>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="IDIOMA" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="PAIS" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="CANAL" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="MARCA" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="55" FilterDefinitionName="PERIODODESDE" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="67" FilterDefinitionName="PERIODOHASTA" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="NULL_VALUE" FilterDefinitionName="REGION" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="NULL_VALUE" FilterDefinitionName="ZONA" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="USUARIO1" FilterDefinitionName="ZONEUSER" FilterParameter="VALUE"/>  
	</ParameterValues>  
	<Localizations/>  
</ReportSourceDefinition>  

