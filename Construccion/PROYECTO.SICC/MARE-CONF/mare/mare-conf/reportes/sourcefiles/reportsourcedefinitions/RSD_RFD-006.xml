<?xml version="1.0" encoding="UTF-8"?>  
<!-- edited with XMLSPY v2004 rel. 2 U (http://www.xmlspy.com) by TEAM (RENEGADE) -->  
<ReportSourceDefinition Id="RSD_RFD-006" Cached="false" Expiration="0" IncrementalDimension="" Multilanguage="false" MaxRowsDimensionReference="" >  
	<DimensionSourceDefinitions>  
		<DimensionSourceDefinition Name="SOCIEDAD_DEFECTO" Description="SOCIEDAD_DEFECTO" DataType="STRING" Calculated="false" Expression="" ExternalData="SOCIEDAD_DEFECTO"/>  
		<DimensionSourceDefinition Name="PAIS" Description="PAIS" DataType="STRING" Calculated="false" Expression="" ExternalData="PAIS"/>  
		<DimensionSourceDefinition Name="DES_REGI" Description="DES_REGI" DataType="STRING" Calculated="false" Expression="" ExternalData="DES_REGI"/>  
		<DimensionSourceDefinition Name="DES_ZONA" Description="DES_ZONA" DataType="STRING" Calculated="false" Expression="" ExternalData="DES_ZONA"/>  
		<DimensionSourceDefinition Name="AAAA" Description="AAAA" DataType="STRING" Calculated="false" Expression="" ExternalData="AAAA"/>  
		<DimensionSourceDefinition Name="VAL_NOMB_PERI" Description="VAL_NOMB_PERI" DataType="STRING" Calculated="false" Expression="" ExternalData="VAL_NOMB_PERI"/>  
		<DimensionSourceDefinition Name="GRUPO" Description="GRUPO" DataType="STRING" Calculated="false" Expression="" ExternalData="GRUPO"/>  
	</DimensionSourceDefinitions>  
	<MetricSourceDefinitions>  
		<MetricSourceDefinition Name="PMNP_NUEVAS_AA" Description="PMNP_NUEVAS_AA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PMNP_NUEVAS_AA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PMNP_NUEVAS_AAAA" Description="PMNP_NUEVAS_AAAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PMNP_NUEVAS_AAAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PORC_PMNP_NUEVAS" Description="PORC_PMNP_NUEVAS" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PORC_PMNP_NUEVAS" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PMNP_NIVELI_AA" Description="PMNP_NIVELI_AA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PMNP_NIVELI_AA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PMNP_NIVELI_AAAA" Description="PMNP_NIVELI_AAAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PMNP_NIVELI_AAAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PORC_PMNP_NIVELI" Description="PORC_PMNP_NIVELI" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PORC_PMNP_NIVELI" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PMNP_NIVELII_AA" Description="PMNP_NIVELII_AA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PMNP_NIVELII_AA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PMNP_NIVELII_AAAA" Description="PMNP_NIVELII_AAAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PMNP_NIVELII_AAAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PORC_PMNP_NIVELII" Description="PORC_PMNP_NIVELII" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PORC_PMNP_NIVELII" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PMNP_NIVELIII_AA" Description="PMNP_NIVELIII_AA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PMNP_NIVELIII_AA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PMNP_NIVELIII_AAAA" Description="PMNP_NIVELIII_AAAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PMNP_NIVELIII_AAAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PORC_PMNP_NIVELIII" Description="PORC_PMNP_NIVELIII" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PORC_PMNP_NIVELIII" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PMNP_NIVELIV_AA" Description="PMNP_NIVELIV_AA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PMNP_NIVELIV_AA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PMNP_NIVELIV_AAAA" Description="PMNP_NIVELIV_AAAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PMNP_NIVELIV_AAAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PORC_PMNP_NIVELIV" Description="PORC_PMNP_NIVELIV" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PORC_PMNP_NIVELIV" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="VENT_NUEVAS_AA" Description="VENT_NUEVAS_AA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="VENT_NUEVAS_AA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="VENT_NUEVAS_AAAA" Description="VENT_NUEVAS_AAAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="VENT_NUEVAS_AAAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="VENT_NIVELI_AA" Description="VENT_NIVELI_AA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="VENT_NIVELI_AA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="VENT_NIVELI_AAAA" Description="VENT_NIVELI_AAAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="VENT_NIVELI_AAAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="VENT_NIVELII_AA" Description="VENT_NIVELII_AA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="VENT_NIVELII_AA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="VENT_NIVELII_AAAA" Description="VENT_NIVELII_AAAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="VENT_NIVELII_AAAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="VENT_NIVELIII_AA" Description="VENT_NIVELIII_AA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="VENT_NIVELIII_AA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="VENT_NIVELIII_AAAA" Description="VENT_NIVELIII_AAAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="VENT_NIVELIII_AAAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="VENT_NIVELIV_AA" Description="VENT_NIVELIV_AA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="VENT_NIVELIV_AA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="VENT_NIVELIV_AAAA" Description="VENT_NIVELIV_AAAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="VENT_NIVELIV_AAAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="TOTAL_VENT_AA" Description="TOTAL_VENT_AA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="TOTAL_VENT_AA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="TOTAL_VENT_AAAA" Description="TOTAL_VENT_AAAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="TOTAL_VENT_AAAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PEDI_NUEVAS_AA" Description="PEDI_NUEVAS_AA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PEDI_NUEVAS_AA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PEDI_NUEVAS_AAAA" Description="PEDI_NUEVAS_AAAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PEDI_NUEVAS_AAAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PEDI_NIVELI_AA" Description="PEDI_NIVELI_AA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PEDI_NIVELI_AA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PEDI_NIVELI_AAAA" Description="PEDI_NIVELI_AAAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PEDI_NIVELI_AAAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PEDI_NIVELII_AA" Description="PEDI_NIVELII_AA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PEDI_NIVELII_AA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PEDI_NIVELII_AAAA" Description="PEDI_NIVELII_AAAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PEDI_NIVELII_AAAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PEDI_NIVELIII_AA" Description="PEDI_NIVELIII_AA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PEDI_NIVELIII_AA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PEDI_NIVELIII_AAAA" Description="PEDI_NIVELIII_AAAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PEDI_NIVELIII_AAAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PEDI_NIVELIV_AA" Description="PEDI_NIVELIV_AA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PEDI_NIVELIV_AA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PEDI_NIVELIV_AAAA" Description="PEDI_NIVELIV_AAAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PEDI_NIVELIV_AAAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="TOTAL_PEDI_AA" Description="TOTAL_PEDI_AA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="TOTAL_PEDI_AA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="TOTAL_PEDI_AAAA" Description="TOTAL_PEDI_AAAA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="TOTAL_PEDI_AAAA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="IND_PARA_TOTAL_CAMPANIA_FIN" Description="IND_PARA_TOTAL_CAMPANIA_FIN" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="IND_PARA_TOTAL_CAMPANIA_FIN" ExternalCalculated="false"/>  
	</MetricSourceDefinitions>  
	<FilterDefinitions>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="IDIOMA" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="PAIS" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="CANAL" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="MARCA" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="PERIODODESDE" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="PERIODOHASTA" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="REGION" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="ZONA" Visual="FALSE"/>  
		<FilterDefinition DataType="STRING" FilterType="EQUALTO" Name="ZONEUSER" Visual="FALSE"/>  
	</FilterDefinitions>  
	<DataSourceDefinitions>  
		<DataSourceDefinition Name="RFD-006" SourceType="SQL" Expression="  
		  
		SELECT *  
FROM  
(  
 	SELECT SOC.VAL_DENO SOCIEDAD_DEFECTO  
	FROM PRINCIPALS PRI,  
		PROPERTYVALUES PRO,  
		SEG_SOCIE SOC			  
	WHERE PRI.NAME =%value_ZONEUSERVALUE%  
		AND PRO.STRINGVALUE = SOC.OID_SOCI  
		 AND PRO.IDPROPERTY = 48  
		 AND PRO.IDPRINCIPAL = PRI.IDPRINCIPAL  
),  
	(  
	SELECT DATOS_AAAA.PAIS,  
		   DATOS_AAAA.DES_REGI,  
		   DATOS_AAAA.DES_ZONA,  
		   DATOS_AAAA.VAL_ANIO AAAA,  
		   DATOS_AAAA.VAL_NOMB_PERI,  
		   TRUNC(((DATOS_AAAA.COD_PERI) - 1)/6)+1 GRUPO,  
			  
			   DATOS_AAAA.VENT_NUEVAS VENT_NUEVAS_AAAA,  
			   DATOS_AAAA.VENT_NIVELI VENT_NIVELI_AAAA,  
			   DATOS_AAAA.VENT_NIVELII VENT_NIVELII_AAAA,  
			   DATOS_AAAA.VENT_NIVELIII VENT_NIVELIII_AAAA,  
			   DATOS_AAAA.VENT_NIVELIV VENT_NIVELIV_AAAA,  
			   DATOS_AAAA.PEDI_NUEVAS PEDI_NUEVAS_AAAA,  
			   DATOS_AAAA.PEDI_NIVELI PEDI_NIVELI_AAAA,  
			   DATOS_AAAA.PEDI_NIVELII PEDI_NIVELII_AAAA,  
			   DATOS_AAAA.PEDI_NIVELIII PEDI_NIVELIII_AAAA,  
			   DATOS_AAAA.PEDI_NIVELIV PEDI_NIVELIV_AAAA,  
			     
   			   DATOS_AA.VENT_NUEVAS VENT_NUEVAS_AA,  
			   DATOS_AA.VENT_NIVELI VENT_NIVELI_AA,  
			   DATOS_AA.VENT_NIVELII VENT_NIVELII_AA,  
			   DATOS_AA.VENT_NIVELIII VENT_NIVELIII_AA,  
			   DATOS_AA.VENT_NIVELIV VENT_NIVELIV_AA,  
			   DATOS_AA.PEDI_NUEVAS PEDI_NUEVAS_AA,  
			   DATOS_AA.PEDI_NIVELI PEDI_NIVELI_AA,  
			   DATOS_AA.PEDI_NIVELII PEDI_NIVELII_AA,  
			   DATOS_AA.PEDI_NIVELIII PEDI_NIVELIII_AA,  
			   DATOS_AA.PEDI_NIVELIV PEDI_NIVELIV_AA,  
			   			     
			   DATOS_AA.VENT_NUEVAS + DATOS_AA.VENT_NIVELI + DATOS_AA.VENT_NIVELII + DATOS_AA.VENT_NIVELIII + DATOS_AA.VENT_NIVELIV TOTAL_VENT_AA,  
	   	   	   DATOS_AAAA.VENT_NUEVAS + DATOS_AAAA.VENT_NIVELI + DATOS_AAAA.VENT_NIVELII + DATOS_AAAA.VENT_NIVELIII + DATOS_AAAA.VENT_NIVELIV TOTAL_VENT_AAAA,  
			     
			   DATOS_AA.PEDI_NUEVAS + DATOS_AA.PEDI_NIVELI + DATOS_AA.PEDI_NIVELII + DATOS_AA.PEDI_NIVELIII + DATOS_AA.PEDI_NIVELIV TOTAL_PEDI_AA,  
	   	   	   DATOS_AAAA.PEDI_NUEVAS + DATOS_AAAA.PEDI_NIVELI + DATOS_AAAA.PEDI_NIVELII + DATOS_AAAA.PEDI_NIVELIII + DATOS_AAAA.PEDI_NIVELIV TOTAL_PEDI_AAAA,		  
			     
		   DATOS_AA.PMNP_NUEVAS PMNP_NUEVAS_AA,  
		   DATOS_AAAA.PMNP_NUEVAS PMNP_NUEVAS_AAAA,	     
		   CASE WHEN (DATOS_AAAA.PMNP_NUEVAS IS NOT NULL) THEN  
		   	   ROUND(DECODE(DATOS_AA.PMNP_NUEVAS, 0, 0, ((DATOS_AAAA.PMNP_NUEVAS/DATOS_AA.PMNP_NUEVAS)-1)*100))  
		   END PORC_PMNP_NUEVAS,  
	  
		   DATOS_AA.PMNP_NIVELI PMNP_NIVELI_AA,  
		   DATOS_AAAA.PMNP_NIVELI PMNP_NIVELI_AAAA,	     
		   CASE WHEN (DATOS_AAAA.PMNP_NIVELI IS NOT NULL) THEN  
		   	   ROUND(DECODE(DATOS_AA.PMNP_NIVELI, 0, 0, ((DATOS_AAAA.PMNP_NIVELI/DATOS_AA.PMNP_NIVELI)-1)*100))  
		   END PORC_PMNP_NIVELI,  
	  
		   DATOS_AA.PMNP_NIVELII PMNP_NIVELII_AA,  
		   DATOS_AAAA.PMNP_NIVELII PMNP_NIVELII_AAAA,	     
		   CASE WHEN (DATOS_AAAA.PMNP_NIVELII IS NOT NULL) THEN  
		   	   ROUND(DECODE(DATOS_AA.PMNP_NIVELII, 0, 0, ((DATOS_AAAA.PMNP_NIVELII/DATOS_AA.PMNP_NIVELII)-1)*100))  
		   END PORC_PMNP_NIVELII,  
  
		   DATOS_AA.PMNP_NIVELIII PMNP_NIVELIII_AA,  
		   DATOS_AAAA.PMNP_NIVELIII PMNP_NIVELIII_AAAA,	     
		   CASE WHEN (DATOS_AAAA.PMNP_NIVELIII IS NOT NULL) THEN  
		   	   ROUND(DECODE(DATOS_AA.PMNP_NIVELIII, 0, 0, ((DATOS_AAAA.PMNP_NIVELIII/DATOS_AA.PMNP_NIVELIII)-1)*100))  
		   END PORC_PMNP_NIVELIII,  
	  
		   DATOS_AA.PMNP_NIVELIV PMNP_NIVELIV_AA,  
		   DATOS_AAAA.PMNP_NIVELIV PMNP_NIVELIV_AAAA,	     
		   CASE WHEN (DATOS_AAAA.PMNP_NIVELIV IS NOT NULL) THEN  
		   	   ROUND(DECODE(DATOS_AA.PMNP_NIVELIV, 0, 0, ((DATOS_AAAA.PMNP_NIVELIV/DATOS_AA.PMNP_NIVELIV)-1)*100))  
		   END PORC_PMNP_NIVELIV,	  
	  
  
		   CASE WHEN (DATOS_AAAA.PMNP_NUEVAS IS NOT NULL) THEN  
		   		1  
		   END IND_PARA_TOTAL_CAMPANIA_FIN  
		     
	FROM  
	(  
		SELECT ROWNUM AS POS,  
			   V_AAAA.PAIS,  
			   V_AAAA.OID_REGI,  
			   V_AAAA.DES_REGI,  
			   V_AAAA.OID_ZONA,  
			   V_AAAA.DES_ZONA,  
			   V_AAAA.VAL_ANIO,  
			   SUBSTR(V_AAAA.COD_PERI,5,2) COD_PERI,  
			   V_AAAA.VAL_NOMB_PERI,  
			   DATOS_AAAA.PMNP_NUEVAS,  
			   DATOS_AAAA.PMNP_NIVELI,  
			   DATOS_AAAA.PMNP_NIVELII,  
			   DATOS_AAAA.PMNP_NIVELIII,  
			   DATOS_AAAA.PMNP_NIVELIV,  
			     
			   DATOS_AAAA.VENT_NUEVAS,  
			   DATOS_AAAA.VENT_NIVELI,  
			   DATOS_AAAA.VENT_NIVELII,  
			   DATOS_AAAA.VENT_NIVELIII,  
			   DATOS_AAAA.VENT_NIVELIV,  
			   DATOS_AAAA.PEDI_NUEVAS,  
			   DATOS_AAAA.PEDI_NIVELI,  
			   DATOS_AAAA.PEDI_NIVELII,  
			   DATOS_AAAA.PEDI_NIVELIII,  
			   DATOS_AAAA.PEDI_NIVELIV  
		FROM  
		(  
			SELECT OID_REGI,  
				   OID_ZONA,  
				   OID_PERI,  
				SUM(NVL(PMNP_NUEVAS, 0)) PMNP_NUEVAS,  
				   SUM(NVL(VENT_NUEVAS, 0)) VENT_NUEVAS,  
				   SUM(NVL(PEDI_NUEVAS, 0)) PEDI_NUEVAS,  
				   SUM(NVL(PMNP_NIVELI, 0)) PMNP_NIVELI,  
				   SUM(NVL(VENT_NIVELI, 0)) VENT_NIVELI,  
				   SUM(NVL(PEDI_NIVELI, 0)) PEDI_NIVELI,  
				   SUM(NVL(PMNP_NIVELII, 0)) PMNP_NIVELII,  
				   SUM(NVL(VENT_NIVELII, 0)) VENT_NIVELII,  
				   SUM(NVL(PEDI_NIVELII, 0)) PEDI_NIVELII,  
		  		   SUM(NVL(PMNP_NIVELIII, 0)) PMNP_NIVELIII,  
				   SUM(NVL(VENT_NIVELIII, 0)) VENT_NIVELIII,  
				   SUM(NVL(PEDI_NIVELIII, 0)) PEDI_NIVELIII,  
				   SUM(NVL(PMNP_NIVELIV, 0)) PMNP_NIVELIV,  
				   SUM(NVL(VENT_NIVELIV, 0)) VENT_NIVELIV,  
				   SUM(NVL(PEDI_NIVELIV, 0)) PEDI_NIVELIV		   		   		      
			FROM  
				(  
				SELECT REG.OID_REGI,  
					   ZONA.OID_ZONA,  
					   PERI.OID_PERI,  
					   decode(NIVEL.COD_NIVE_SEGM,'N',avg(SEG_CLI.VAL_VENT),0)as PMNP_NUEVAS,  
					   decode(NIVEL.COD_NIVE_SEGM,'N',SUM(SEG_CLI.VAL_VENT),0)as VENT_NUEVAS,  
					   decode(NIVEL.COD_NIVE_SEGM,'N',COUNT(SEG_CLI.VAL_VENT),0)as PEDI_NUEVAS,  
					   decode(NIVEL.COD_NIVE_SEGM,'I',avg(SEG_CLI.VAL_VENT),0)as PMNP_NIVELI,  
					   decode(NIVEL.COD_NIVE_SEGM,'I',SUM(SEG_CLI.VAL_VENT),0)as VENT_NIVELI,  
					   decode(NIVEL.COD_NIVE_SEGM,'I',COUNT(SEG_CLI.VAL_VENT),0)as PEDI_NIVELI,  
					   decode(NIVEL.COD_NIVE_SEGM,'II',avg(SEG_CLI.VAL_VENT),0)as PMNP_NIVELII,  
					   decode(NIVEL.COD_NIVE_SEGM,'II',SUM(SEG_CLI.VAL_VENT),0)as VENT_NIVELII,  
					   decode(NIVEL.COD_NIVE_SEGM,'II',COUNT(SEG_CLI.VAL_VENT),0)as PEDI_NIVELII,  
					   decode(NIVEL.COD_NIVE_SEGM,'III',avg(SEG_CLI.VAL_VENT),0)as PMNP_NIVELIII,  
					   decode(NIVEL.COD_NIVE_SEGM,'III',SUM(SEG_CLI.VAL_VENT),0)as VENT_NIVELIII,  
					   decode(NIVEL.COD_NIVE_SEGM,'III',COUNT(SEG_CLI.VAL_VENT),0)as PEDI_NIVELIII,  
					   decode(NIVEL.COD_NIVE_SEGM,'IV',avg(SEG_CLI.VAL_VENT),0)as PMNP_NIVELIV,  
					   decode(NIVEL.COD_NIVE_SEGM,'IV',SUM(SEG_CLI.VAL_VENT),0)as VENT_NIVELIV,  
					   decode(NIVEL.COD_NIVE_SEGM,'IV',COUNT(SEG_CLI.VAL_VENT),0)as PEDI_NIVELIV  
				FROM CRA_PERIO PERI,  
					 ZON_ZONA ZONA,  
					 ZON_REGIO REG,  
					 DTR_SEGME_CLIEN SEG_CLI,  
					 DTR_NIVEL_SEGME NIVEL,  
					 (  
						 SELECT FEC_INIC  
						 FROM CRA_PERIO   
						 WHERE OID_PERI = %value_PERIODODESDEVALUE%    		   
					 ) FI,  
					 (  
						 SELECT FEC_FINA  
						 FROM CRA_PERIO   
						 WHERE OID_PERI = %value_PERIODOHASTAVALUE%           
  
					 ) FF	   
				WHERE PERI.FEC_INIC &gt;= FI.FEC_INIC  
					  AND PERI.FEC_FINA &lt;= FF.FEC_FINA  
					  AND ZONA.ZORG_OID_REGI = REG.OID_REGI  
					  AND SEG_CLI.PERD_OID_PERI = PERI.OID_PERI  
					  AND SEG_CLI.ZZON_OID_ZONA = ZONA.OID_ZONA  
					  AND SEG_CLI.ZORG_OID_REGI = REG.OID_REGI  
					  AND SEG_CLI.NVSG_OID_NIVE_SEGM = NIVEL.OID_NIVE_SEGM  
					  AND NIVEL.COD_NIVE_SEGM IN ('N','I','II','III','IV')  
					  AND PERI.PAIS_OID_PAIS =  %value_PAISVALUE%	  
  
					  AND PERI.MARC_OID_MARC = %value_MARCAVALUE%	  
  
					  AND PERI.CANA_OID_CANA =   %value_CANALVALUE%	  
  
			     %start_ZONAVALUE%    AND ZONA.OID_ZONA =  %value_ZONAVALUE%  %end_ZONAVALUE%   
				 %start_REGIONVALUE%   and reg.oid_regi in  (%value_REGIONVALUE%)  %end_REGIONVALUE%   
  
					    
			   GROUP BY REG.OID_REGI,  
					   ZONA.OID_ZONA,  
					   PERI.OID_PERI,  
		  			   NIVEL.COD_NIVE_SEGM		    
			   )  
		     GROUP BY OID_REGI,  
			 	   OID_ZONA,  
				   OID_PERI  
		) DATOS_AAAA,  
		(  
		SELECT GEN_PAIS.VAL_I18N PAIS,  
			   REG.OID_REGI,  
			   REG.DES_REGI,  
			   ZONA.OID_ZONA,  
			   ZONA.DES_ZONA,  
			   PC.VAL_ANIO,  
			   PC.COD_PERI,  
			   PERI.OID_PERI,  
			   PERI.VAL_NOMB_PERI  
		FROM CRA_PERIO PERI,  
			 ZON_ZONA ZONA,  
			 ZON_REGIO REG,  
			 (  
			 SELECT PER_COR.OID_PERI,  
			 		PER_COR.COD_PERI,  
					PER_COR.VAL_ANIO  
			 FROM SEG_PERIO_CORPO PER_COR  
			 WHERE PER_COR.VAL_ANIO = (  
		   							 SELECT PER_COR.VAL_ANIO  
									 FROM SEG_PERIO_CORPO PER_COR,  
									 	  CRA_PERIO PERI   
									 WHERE PERI.OID_PERI = %value_PERIODODESDEVALUE%    	  
									 	   AND PERI.PERI_OID_PERI = PER_COR.OID_PERI								    	    
									 )  
			) PC,  
			(  
			SELECT GEN.VAL_OID, GEN.VAL_I18N  
			FROM V_GEN_I18N_SICC GEN  
			WHERE GEN.ATTR_ENTI = 'SEG_PAIS'  
				  AND GEN.IDIO_OID_IDIO = %value_IDIOMAVALUE%	  
  
			) GEN_PAIS  
		WHERE PERI.PERI_OID_PERI = PC.OID_PERI   
			  AND GEN_PAIS.VAL_OID(+) = PERI.PAIS_OID_PAIS  
			  AND PERI.MARC_OID_MARC =  %value_MARCAVALUE%	  
			  AND PERI.CANA_OID_CANA =  %value_CANALVALUE%	  
  
			  AND PERI.PAIS_OID_PAIS = %value_PAISVALUE%	  
			  AND ZONA.ZORG_OID_REGI = REG.OID_REGI  
		        
			  %start_ZONAVALUE%        AND ZONA.OID_ZONA =  %value_ZONAVALUE%  %end_ZONAVALUE%   
		      %start_REGIONVALUE%   and reg.oid_regi = %value_REGIONVALUE%  %end_REGIONVALUE%   
  
		) V_AAAA  
		WHERE DATOS_AAAA.OID_PERI(+) = V_AAAA.OID_PERI  
			  AND DATOS_AAAA.OID_REGI(+) = V_AAAA.OID_REGI  
			  AND DATOS_AAAA.OID_ZONA(+) = V_AAAA.OID_ZONA  
	) DATOS_AAAA,  
	  
	(  
		SELECT V_AA.OID_REGI,  
			   V_AA.OID_ZONA,  
			   SUBSTR(V_AA.COD_PERI,5,2) COD_PERI,  
			   NVL(DATOS_AA.PMNP_NUEVAS, 0) PMNP_NUEVAS,  
			   NVL(DATOS_AA.PMNP_NIVELI, 0) PMNP_NIVELI,  
			   NVL(DATOS_AA.PMNP_NIVELII, 0) PMNP_NIVELII,  
			   NVL(DATOS_AA.PMNP_NIVELIII, 0) PMNP_NIVELIII,  
			   NVL(DATOS_AA.PMNP_NIVELIV, 0) PMNP_NIVELIV,  
			   NVL(DATOS_AA.VENT_NUEVAS, 0) VENT_NUEVAS,  
			   NVL(DATOS_AA.VENT_NIVELI, 0) VENT_NIVELI,  
			   NVL(DATOS_AA.VENT_NIVELII, 0) VENT_NIVELII,  
			   NVL(DATOS_AA.VENT_NIVELIII, 0) VENT_NIVELIII,  
			   NVL(DATOS_AA.VENT_NIVELIV, 0) VENT_NIVELIV,  
			   NVL(DATOS_AA.PEDI_NUEVAS, 0) PEDI_NUEVAS,  
			   NVL(DATOS_AA.PEDI_NIVELI, 0) PEDI_NIVELI,  
			   NVL(DATOS_AA.PEDI_NIVELII, 0) PEDI_NIVELII,  
			   NVL(DATOS_AA.PEDI_NIVELIII, 0) PEDI_NIVELIII,  
			   NVL(DATOS_AA.PEDI_NIVELIV, 0) PEDI_NIVELIV  
		FROM  
		(  
			SELECT OID_REGI,  
				   OID_ZONA,  
				   COD_PERI,  
				   SUM(NVL(PMNP_NUEVAS, 0)) PMNP_NUEVAS,  
				   SUM(NVL(PMNP_NIVELI, 0)) PMNP_NIVELI,  
				   SUM(NVL(PMNP_NIVELII, 0)) PMNP_NIVELII,  
		  		   SUM(NVL(PMNP_NIVELIII, 0)) PMNP_NIVELIII,  
				   SUM(NVL(PMNP_NIVELIV, 0)) PMNP_NIVELIV,  
				   SUM(NVL(VENT_NUEVAS, 0)) VENT_NUEVAS,  
				   SUM(NVL(VENT_NIVELI, 0)) VENT_NIVELI,  
				   SUM(NVL(VENT_NIVELII, 0)) VENT_NIVELII,  
		  		   SUM(NVL(VENT_NIVELIII, 0)) VENT_NIVELIII,  
				   SUM(NVL(VENT_NIVELIV, 0)) VENT_NIVELIV,  
				   SUM(NVL(PEDI_NUEVAS, 0)) PEDI_NUEVAS,  
				   SUM(NVL(PEDI_NIVELI, 0)) PEDI_NIVELI,  
				   SUM(NVL(PEDI_NIVELII, 0)) PEDI_NIVELII,  
		  		   SUM(NVL(PEDI_NIVELIII, 0)) PEDI_NIVELIII,  
				   SUM(NVL(PEDI_NIVELIV, 0)) PEDI_NIVELIV		   		   		      
			FROM  
				(  
				SELECT REG.OID_REGI,  
					   ZONA.OID_ZONA,  
					   PC.COD_PERI,  
					   decode(NIVEL.COD_NIVE_SEGM,'N',avg(SEG_CLI.VAL_VENT),0)as PMNP_NUEVAS,  
					   decode(NIVEL.COD_NIVE_SEGM,'I',avg(SEG_CLI.VAL_VENT),0)as PMNP_NIVELI,  
					   decode(NIVEL.COD_NIVE_SEGM,'II',avg(SEG_CLI.VAL_VENT),0)as PMNP_NIVELII,  
					   decode(NIVEL.COD_NIVE_SEGM,'III',avg(SEG_CLI.VAL_VENT),0)as PMNP_NIVELIII,  
					   decode(NIVEL.COD_NIVE_SEGM,'IV',avg(SEG_CLI.VAL_VENT),0)as PMNP_NIVELIV,  
					   decode(NIVEL.COD_NIVE_SEGM,'N',SUM(SEG_CLI.VAL_VENT),0)as VENT_NUEVAS,  
					   decode(NIVEL.COD_NIVE_SEGM,'I',SUM(SEG_CLI.VAL_VENT),0)as VENT_NIVELI,  
					   decode(NIVEL.COD_NIVE_SEGM,'II',SUM(SEG_CLI.VAL_VENT),0)as VENT_NIVELII,  
					   decode(NIVEL.COD_NIVE_SEGM,'III',SUM(SEG_CLI.VAL_VENT),0)as VENT_NIVELIII,  
					   decode(NIVEL.COD_NIVE_SEGM,'IV',SUM(SEG_CLI.VAL_VENT),0)as VENT_NIVELIV,  
					   decode(NIVEL.COD_NIVE_SEGM,'N',COUNT(SEG_CLI.VAL_VENT),0)as PEDI_NUEVAS,  
					   decode(NIVEL.COD_NIVE_SEGM,'I',COUNT(SEG_CLI.VAL_VENT),0)as PEDI_NIVELI,  
					   decode(NIVEL.COD_NIVE_SEGM,'II',COUNT(SEG_CLI.VAL_VENT),0)as PEDI_NIVELII,  
					   decode(NIVEL.COD_NIVE_SEGM,'III',COUNT(SEG_CLI.VAL_VENT),0)as PEDI_NIVELIII,  
					   decode(NIVEL.COD_NIVE_SEGM,'IV',COUNT(SEG_CLI.VAL_VENT),0)as PEDI_NIVELIV  
				FROM CRA_PERIO PERI,  
					 ZON_ZONA ZONA,  
					 ZON_REGIO REG,  
					 DTR_SEGME_CLIEN SEG_CLI,  
					 DTR_NIVEL_SEGME NIVEL,  
					 (  
					 SELECT PER_COR.OID_PERI,  
					 		PER_COR.COD_PERI  
					 FROM SEG_PERIO_CORPO PER_COR  
					 WHERE PER_COR.VAL_ANIO = (  
				   							 SELECT PER_COR.VAL_ANIO  
											 FROM SEG_PERIO_CORPO PER_COR,  
											 	  CRA_PERIO PERI   
											 WHERE PERI.OID_PERI = %value_PERIODODESDEVALUE%    			   
  
											 	   AND PERI.PERI_OID_PERI = PER_COR.OID_PERI								    	    
											 ) - 1   
					) PC  
				WHERE PERI.PERI_OID_PERI = PC.OID_PERI  
					  AND SEG_CLI.PERD_OID_PERI = PERI.OID_PERI  
					  AND SEG_CLI.ZZON_OID_ZONA = ZONA.OID_ZONA  
					  AND SEG_CLI.ZORG_OID_REGI = REG.OID_REGI  
					  AND SEG_CLI.NVSG_OID_NIVE_SEGM = NIVEL.OID_NIVE_SEGM  
					  AND NIVEL.COD_NIVE_SEGM IN ('N', 'I', 'II', 'III', 'IV')  
					  AND PERI.MARC_OID_MARC = %value_MARCAVALUE%	  
  
					  AND PERI.CANA_OID_CANA =  %value_CANALVALUE%	  
  
					  AND PERI.PAIS_OID_PAIS = %value_PAISVALUE%	  
  
					  AND ZONA.ZORG_OID_REGI = REG.OID_REGI  
				     %start_ZONAVALUE%        AND ZONA.OID_ZONA =  %value_ZONAVALUE%  %end_ZONAVALUE%   
		              %start_REGIONVALUE%   and reg.oid_regi = %value_REGIONVALUE%  %end_REGIONVALUE%   
			    GROUP BY REG.OID_REGI,  
						 ZONA.OID_ZONA,  
						 PC.COD_PERI,  
			  			 NIVEL.COD_NIVE_SEGM		    
			   )  
		     GROUP BY OID_REGI,  
			 	   OID_ZONA,  
				   COD_PERI  
		) DATOS_AA,  
		(  
		SELECT REG.OID_REGI,  
			   ZONA.OID_ZONA,  
			   PC.COD_PERI  
		FROM CRA_PERIO PERI,  
			 ZON_ZONA ZONA,  
			 ZON_REGIO REG,  
			 (  
			 SELECT PER_COR.OID_PERI,  
			 		PER_COR.COD_PERI  
			 FROM SEG_PERIO_CORPO PER_COR  
			 WHERE PER_COR.VAL_ANIO = (  
		   							 SELECT PER_COR.VAL_ANIO  
									 FROM SEG_PERIO_CORPO PER_COR,  
									 	  CRA_PERIO PERI   
									 WHERE PERI.OID_PERI = %value_PERIODODESDEVALUE%    		  
									 	   AND PERI.PERI_OID_PERI = PER_COR.OID_PERI								    	    
									 ) - 1   
			) PC  
		WHERE PERI.PERI_OID_PERI = PC.OID_PERI   
			  AND PERI.MARC_OID_MARC =   %value_MARCAVALUE%	  
  
			  AND PERI.CANA_OID_CANA =  %value_CANALVALUE%	  
  
			  AND PERI.PAIS_OID_PAIS =   %value_PAISVALUE%		   
			  AND ZONA.ZORG_OID_REGI = REG.OID_REGI  
			  AND REG.PAIS_OID_PAIS =  PERI.PAIS_OID_PAIS  
			  AND REG.MARC_OID_MARC =  PERI.MARC_OID_MARC   
			  AND REG.CANA_OID_CANA = PERI.CANA_OID_CANA  
  
		  %start_ZONAVALUE%        AND ZONA.OID_ZONA =  %value_ZONAVALUE%  %end_ZONAVALUE%   
		  %start_REGIONVALUE%   and reg.oid_regi = %value_REGIONVALUE%  %end_REGIONVALUE%   
		) V_AA  
		WHERE DATOS_AA.COD_PERI(+) = V_AA.COD_PERI  
			  AND DATOS_AA.OID_REGI(+) = V_AA.OID_REGI  
			  AND DATOS_AA.OID_ZONA(+) = V_AA.OID_ZONA  
	) DATOS_AA  
	WHERE DATOS_AAAA.COD_PERI = DATOS_AA.COD_PERI(+)  
		  AND DATOS_AAAA.OID_REGI = DATOS_AA.OID_REGI(+)  
		  AND DATOS_AAAA.OID_ZONA = DATOS_AA.OID_ZONA(+)  
		  
	)		    
 %and_prefilter% ORDER BY DES_REGI,  
	  	 DES_ZONA,  
		 GRUPO,  
		 VAL_NOMB_PERI    
	  		  " ExternalClassName="oracle.jdbc.driver.OracleDriver" ExternalSourceData="" ExternalConnectionString="" ExternalConnectionClassName="oracle.jdbc.driver.OracleDriver" ExternalConnectionLocalUrl="jdbc:oracle:thin:@192.168.118.106:1523:SICCV3D" ExternalConnectionDistributedUrl="" ExternalConnectionUser="usu_peru" ExternalConnectionPassword="peru" DatePattern="" DateTimePattern=""/>  
	</DataSourceDefinitions>  
	<ParameterValues>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="IDIOMA" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="PAIS" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="CANAL" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="MARCA" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="41" FilterDefinitionName="PERIODODESDE" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="67" FilterDefinitionName="PERIODOHASTA" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="NULL_VALUE" FilterDefinitionName="REGION" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="NULL_VALUE" FilterDefinitionName="ZONA" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="PEPRUEBAS" FilterDefinitionName="ZONEUSER" FilterParameter="VALUE"/>  
	</ParameterValues>  
	<Localizations/>  
</ReportSourceDefinition>  

