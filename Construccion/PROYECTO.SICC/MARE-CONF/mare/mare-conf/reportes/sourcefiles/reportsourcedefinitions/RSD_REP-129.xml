<?xml version="1.0" encoding="UTF-8"?>  
<!-- edited with XMLSPY v2004 rel. 2 U (http://www.xmlspy.com) by a (a) -->  
<ReportSourceDefinition Id="RSD_REP-129" Cached="false" Expiration="0" IncrementalDimension="" Multilanguage="false" MaxRowsDimensionReference="" >  
	<DimensionSourceDefinitions>  
		<DimensionSourceDefinition Name="PAIS" Description="PAIS" DataType="STRING" Calculated="false" Expression="" ExternalData="PAIS"/>  
		<DimensionSourceDefinition Name="MARCA" Description="MARCA" DataType="STRING" Calculated="false" Expression="" ExternalData="MARCA"/>  
		<DimensionSourceDefinition Name="CANAL" Description="CANAL" DataType="STRING" Calculated="false" Expression="" ExternalData="CANAL"/>  
		<DimensionSourceDefinition Name="GRUPO" Description="GRUPO" DataType="STRING" Calculated="false" Expression="" ExternalData="GRUPO"/>  
		<DimensionSourceDefinition Name="SUB_GRUPO" Description="SUB_GRUPO" DataType="STRING" Calculated="false" Expression="" ExternalData="SUB_GRUPO"/>  
		<DimensionSourceDefinition Name="VAL_NOMB_PERI" Description="VAL_NOMB_PERI" DataType="STRING" Calculated="false" Expression="" ExternalData="VAL_NOMB_PERI"/>  
	</DimensionSourceDefinitions>  
	<MetricSourceDefinitions>  
		<MetricSourceDefinition Name="VENTA_A_COBRAR" Description="VENTA_A_COBRAR" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="VENTA_A_COBRAR" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PAG_21_ACUM" Description="PAG_21_ACUM" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PAG_21_ACUM" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PAG_31_ACUM" Description="PAG_31_ACUM" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PAG_31_ACUM" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PAG_42_ACUM" Description="PAG_42_ACUM" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PAG_42_ACUM" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PAG_63_ACUM" Description="PAG_63_ACUM" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PAG_63_ACUM" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PAG_84_ACUM" Description="PAG_84_ACUM" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PAG_84_ACUM" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PAG_126_ACUM" Description="PAG_126_ACUM" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PAG_126_ACUM" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PAG_189_ACUM" Description="PAG_189_ACUM" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PAG_189_ACUM" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="SALDO_PENDIENTE" Description="SALDO_PENDIENTE" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="SALDO_PENDIENTE" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PAG_21_ETAPA" Description="PAG_21_ETAPA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PAG_21_ETAPA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PAG_31_ETAPA" Description="PAG_31_ETAPA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PAG_31_ETAPA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PAG_42_ETAPA" Description="PAG_42_ETAPA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PAG_42_ETAPA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PAG_63_ETAPA" Description="PAG_63_ETAPA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PAG_63_ETAPA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PAG_84_ETAPA" Description="PAG_84_ETAPA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PAG_84_ETAPA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PAG_126_ETAPA" Description="PAG_126_ETAPA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PAG_126_ETAPA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="PAG_189_ETAPA" Description="PAG_189_ETAPA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PAG_189_ETAPA" ExternalCalculated="false"/>  
	</MetricSourceDefinitions>  
	<FilterDefinitions>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="IDIOMA" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="PAIS" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="MARCA" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="CANAL" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="REGION" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="ZONA" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="SECCION" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="IN" Name="PERIODO" Visual="FALSE"/>  
	</FilterDefinitions>  
	<DataSourceDefinitions>  
		<DataSourceDefinition Name="REP-129" SourceType="SQL" Expression="  
(  
SELECT *  
FROM  
(  
	  
	SELECT PAIS,  
		   MARCA,  
		   CANAL,  
		   'ARECUPERACION ACUMULADA Y ETAPA' GRUPO,  
		   NULL AS SUB_GRUPO,  
		   VAL_NOMB_PERI,  
		   SUM(IMPORTE) VENTA_A_COBRAR,  
		   SUM(PAG_21) PAG_21_ACUM,  
		   SUM(PAG_31) PAG_31_ACUM,  
		   SUM(PAG_42) PAG_42_ACUM,  
		   SUM(PAG_63) PAG_63_ACUM,  
		   SUM(PAG_84) PAG_84_ACUM,  
		   SUM(PAG_126) PAG_126_ACUM,  
		   SUM(PAG_189) PAG_189_ACUM,  
	   	   SUM(IMP_PENDIENTE) SALDO_PENDIENTE,  
		   SUM(PAG_21) PAG_21_ETAPA,  
		   SUM(PAG_31) - SUM(PAG_21)  PAG_31_ETAPA,  
		   SUM(PAG_42) - SUM(PAG_31)  PAG_42_ETAPA,  
		   SUM(PAG_63) - SUM(PAG_42) PAG_63_ETAPA,  
		   SUM(PAG_84) - SUM(PAG_63) PAG_84_ETAPA,  
		   SUM(PAG_126) - SUM(PAG_84) PAG_126_ETAPA,  
		   SUM(PAG_189) - SUM(PAG_126) PAG_189_ETAPA  
	FROM  
		(  
		SELECT GEN_PAIS.VAL_I18N PAIS,  
			   MARCA.DES_MARC MARCA,  
			   GEN_CANAL.VAL_I18N CANAL,  
			   VAL_NOMB_PERI,  
			   SUM(IMPORTE) IMPORTE,  
			   NVL(( CASE WHEN (TIPO = 'A') THEN  
			   		 SUM(IMP_PENDIENTE)  
			   END),0) IMP_PENDIENTE,  
			   NVL((  
			   	CASE WHEN (DIF_FECHA &lt;= 21) THEN  
			   			 SUM(PAG)  
			    END  
			   ),0) AS PAG_21,  
			   NVL((  
			   CASE WHEN (DIF_FECHA &lt;= 31) THEN  
			   			 SUM(PAG)  
			    END  
			   ),0) AS PAG_31,  
			   NVL((  
			   CASE WHEN (DIF_FECHA &lt;= 42) THEN  
			   			 SUM(PAG)  
			    END  
			   ),0) AS PAG_42,  
			   NVL((  
			   CASE WHEN (DIF_FECHA &lt;= 63) THEN  
			   			 SUM(PAG)  
			    END  
			   ),0) AS PAG_63,  
			   NVL((  
			   CASE WHEN (DIF_FECHA &lt;= 84) THEN  
			   			 SUM(PAG)  
			    END  
			   ),0) AS PAG_84,  
			   NVL((  
			   CASE WHEN (DIF_FECHA &lt;= 126) THEN  
			   			 SUM(PAG)  
			    END  
			   ),0) AS PAG_126,  
			   NVL((  
			   CASE WHEN (DIF_FECHA &lt;= 189) THEN  
			   			 SUM(PAG)  
			    END  
			   ),0) AS PAG_189  
		FROM  
			(  
				(  
				  
				SELECT PERI.PAIS_OID_PAIS,  
					   PERI.MARC_OID_MARC,  
					   PERI.CANA_OID_CANA,  
					   PERI.VAL_NOMB_PERI,  
					   TRUNC((MOV_CCC.FEC_ULTI_MOVI - MOV_CCC.FEC_DOCU)) DIF_FECHA,  
					   MOV_CCC.IMP_PAGO PAG,  
					   'A' AS TIPO,  
					   MOV_CCC.IMP_MOVI IMPORTE,  
					   MOV_CCC.IMP_PEND IMP_PENDIENTE  
				FROM CCC_MOVIM_CUENT_CORRI MOV_CCC,  
					 ZON_SECCI SEC,  
					 CRA_PERIO PERI  
				WHERE MOV_CCC.ZSCC_OID_SECC = SEC.OID_SECC  
					  AND MOV_CCC.PERD_OID_PERI = PERI.OID_PERI  
					%start_SECCIONVALUE%     AND SEC.OID_SECC =  %value_SECCIONVALUE%  %end_SECCIONVALUE%   
					%start_ZONAVALUE%      AND SEC.ZZON_OID_ZONA = %value_ZONAVALUE%  %end_ZONAVALUE% 	  
				    %start_REGIONVALUE%    	  AND MOV_CCC.ZORG_OID_REGI=   %value_REGIONVALUE%  %end_REGIONVALUE%  
					%start_CANALVALUE%    	   AND PERI.CANA_OID_CANA =    %value_CANALVALUE%  %end_CANALVALUE% 	  
					%start_MARCAVALUE%    	 AND PERI.MARC_OID_MARC =      %value_MARCAVALUE%  %end_MARCAVALUE% 	  
					AND PERI.PAIS_OID_PAIS = %value_PAISVALUE%	 		  
				 	%start_PERIODOVALUES%    	 AND PERI.OID_PERI IN (%value_PERIODOVALUES%)  %end_PERIODOVALUES% 	  
				)  
				UNION  
				(  
  
				SELECT PERI.PAIS_OID_PAIS,  
					   PERI.MARC_OID_MARC,  
					   PERI.CANA_OID_CANA,  
					   PERI.VAL_NOMB_PERI,  
					   (HTO.FEC_MOVI - HTO.FEC_DOCU),   
					   HTO.IMP_PAGO,  
					   'B' AS TIPO,  
					   HTO.IMP IMPORTE,  
					   NULL AS IMP_PENDIENTE  
				FROM CCC_HISTO_MOVIM_CC HTO,  
					 CCC_MOVIM_CUENT_CORRI MOV_CCC,  
					 ZON_SECCI SEC,  
				     CRA_PERIO PERI  
				WHERE MOV_CCC.ZSCC_OID_SECC = SEC.OID_SECC   
					  AND MOV_CCC.PERD_OID_PERI = PERI.OID_PERI  
					  AND MOV_CCC.OID_MOVI_CC = HTO.MVCC_OID_MOVI_CC  
				    %start_SECCIONVALUE%     AND SEC.OID_SECC =  %value_SECCIONVALUE%  %end_SECCIONVALUE%   
					%start_ZONAVALUE%      AND SEC.ZZON_OID_ZONA = %value_ZONAVALUE%  %end_ZONAVALUE% 	  
				    %start_REGIONVALUE%    	  AND MOV_CCC.ZORG_OID_REGI=   %value_REGIONVALUE%  %end_REGIONVALUE%  
					%start_CANALVALUE%    	   AND PERI.CANA_OID_CANA =    %value_CANALVALUE%  %end_CANALVALUE% 	  
					%start_MARCAVALUE%    	 AND PERI.MARC_OID_MARC =      %value_MARCAVALUE%  %end_MARCAVALUE% 	  
					AND PERI.PAIS_OID_PAIS = %value_PAISVALUE%	 		  
				 	%start_PERIODOVALUES%    	 AND PERI.OID_PERI IN (%value_PERIODOVALUES%)  %end_PERIODOVALUES%   
				)   
			) DATOS,  
			(  
			SELECT GEN.VAL_OID, GEN.VAL_I18N  
			FROM V_GEN_I18N_SICC GEN  
			WHERE GEN.ATTR_ENTI = 'SEG_PAIS'			 			  
				  AND GEN.IDIO_OID_IDIO = %value_IDIOMAVALUE%									  
			) GEN_PAIS,  
			(  
			SELECT GEN.VAL_OID, GEN.VAL_I18N  
			FROM V_GEN_I18N_SICC GEN  
			WHERE GEN.ATTR_ENTI = 'SEG_CANAL'			 			  
				  AND GEN.IDIO_OID_IDIO = %value_IDIOMAVALUE%										  
			) GEN_CANAL,  
			SEG_MARCA MARCA  
			WHERE DATOS.PAIS_OID_PAIS = GEN_PAIS.VAL_OID(+)  
				  AND DATOS.CANA_OID_CANA = GEN_CANAL.VAL_OID(+)  
				  AND DATOS.MARC_OID_MARC = MARCA.OID_MARC  
		GROUP BY GEN_PAIS.VAL_I18N,  
			  	 MARCA.DES_MARC,  
			     GEN_CANAL.VAL_I18N,  
				 VAL_NOMB_PERI,  
				 DIF_FECHA,  
				 TIPO,  
				 IMPORTE		     
		)  
	GROUP BY PAIS,  
		  	 MARCA,  
		     CANAL,  
			 VAL_NOMB_PERI  
	 %and_prefilter% ORDER BY PAIS,  
		  	 MARCA,  
			 CANAL,  
			 VAL_NOMB_PERI  
)  
)	  
UNION ALL  
(  
SELECT *  
FROM  
(  
	SELECT GEN_PAIS.VAL_I18N PAIS,  
		   DES_MARC MARCA,  
		   GEN_CANAL.VAL_I18N CANAL,  
		   'INFORMACION POR ETAPAS DE DEUDA' GRUPO,  
		   VAL_DESC||' '||VAL_EDAD_INIC||' a '||VAL_EDAD_FINA||' Dias' ETAPA,  
		   VAL_NOMB_PERI CAMP,	     
		   CARTERA,  
		   VALOR_RECUP,  
		   SALDO,  
		   NULL AS N1,  
		   NULL AS N2,  
		   NULL AS N3,  
		   NULL AS N4,  
		   NULL AS N5,  
		   NULL AS N6,  
		   NULL AS N7,  
		   NULL AS N8,  
		   NULL AS N9,  
		   NULL AS N10,  
		   NULL AS N11,  
		   NULL AS N12,  
		   NULL AS N13	     
	FROM  
	(  
		SELECT PERI.PAIS_OID_PAIS,  
			   MARCA.DES_MARC,  
			   PERI.CANA_OID_CANA,  
			   PERI.VAL_NOMB_PERI,  
			   ETAPA.VAL_DESC,  
			   ETAPA.VAL_EDAD_INIC,  
			   ETAPA.VAL_EDAD_FINA,  
			   SUM(ASI_COB.IMP_DEUD_CANC) VALOR_RECUP,  
			   SUM(ASI_COB.IMP_DEUD_ASIG) CARTERA,  
			   SUM(ASI_COB.IMP_DEUD_ASIG) - SUM(ASI_COB.IMP_DEUD_CANC) SALDO	     
		FROM COB_ETAPA_DEUDA ETAPA,  
			 COB_CRONO_COBRA CRO_COB,  
			 COB_ASIGN_COBRA ASI_COB,  
			 CCC_MOVIM_CUENT_CORRI MCC,  
			 ZON_SECCI SEC,  
			 CRA_PERIO PERI,  
			 SEG_MARCA MARCA   
		WHERE ETAPA.IND_EXCL = 1  
			  AND CRO_COB.OID_CRON_COBR = ASI_COB.CRCO_OID_CRON_COBR  
			  AND ASI_COB.MVCC_OID_MOVI_CC = MCC.OID_MOVI_CC  
			  AND CRO_COB.ETDE_OID_ETAP_DEUD = ETAPA.OID_ETAP_DEUD  
			  AND MCC.ZSCC_OID_SECC = SEC.OID_SECC  
			  AND MCC.PERD_OID_PERI = PERI.OID_PERI  
			  AND PERI.MARC_OID_MARC = MARCA.OID_MARC  
		    %start_SECCIONVALUE%     AND SEC.OID_SECC =  %value_SECCIONVALUE%  %end_SECCIONVALUE%   
			%start_ZONAVALUE%      AND SEC.ZZON_OID_ZONA = %value_ZONAVALUE%  %end_ZONAVALUE% 	  
			%start_REGIONVALUE%    	  AND MCC.ZORG_OID_REGI=   %value_REGIONVALUE%  %end_REGIONVALUE%  
			%start_CANALVALUE%    	   AND PERI.CANA_OID_CANA =    %value_CANALVALUE%  %end_CANALVALUE% 	  
			%start_MARCAVALUE%    	 AND PERI.MARC_OID_MARC =      %value_MARCAVALUE%  %end_MARCAVALUE% 	  
			AND PERI.PAIS_OID_PAIS = %value_PAISVALUE%	 		  
			%start_PERIODOVALUES%    	 AND PERI.OID_PERI IN (%value_PERIODOVALUES%)  %end_PERIODOVALUES%   
		GROUP BY PERI.PAIS_OID_PAIS,  
			  	 MARCA.DES_MARC,  
				 PERI.CANA_OID_CANA,  
				 PERI.VAL_NOMB_PERI,  
				 ETAPA.VAL_DESC,  
				 ETAPA.VAL_EDAD_INIC,  
				 ETAPA.VAL_EDAD_FINA  
	) DATOS,  
	(  
	SELECT GEN.VAL_OID, GEN.VAL_I18N  
	FROM V_GEN_I18N_SICC GEN  
	WHERE GEN.ATTR_ENTI = 'SEG_PAIS'  
		  AND GEN.IDIO_OID_IDIO =  %value_IDIOMAVALUE%		 									  
	) GEN_PAIS,  
	(  
	SELECT GEN.VAL_OID, GEN.VAL_I18N  
	FROM V_GEN_I18N_SICC GEN  
	WHERE GEN.ATTR_ENTI = 'SEG_CANAL'  
		  AND GEN.IDIO_OID_IDIO =  %value_IDIOMAVALUE%	 									  
	) GEN_CANAL  
	WHERE DATOS.PAIS_OID_PAIS = GEN_PAIS.VAL_OID(+)  
		  AND DATOS.CANA_OID_CANA = GEN_CANAL.VAL_OID(+)  
	ORDER BY VAL_EDAD_INIC  
)  
)		   
	    
  
  
" ExternalClassName="oracle.jdbc.driver.OracleDriver" ExternalSourceData="" ExternalConnectionString="" ExternalConnectionClassName="oracle.jdbc.driver.OracleDriver" ExternalConnectionLocalUrl="jdbc:oracle:thin:@192.168.118.106:1523:SICCV3D" ExternalConnectionDistributedUrl="" ExternalConnectionUser="usu_peru" ExternalConnectionPassword="peru" DatePattern="" DateTimePattern=""/>  
	</DataSourceDefinitions>  
	<ParameterValues>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="IDIOMA" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="PAIS" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="NULL_VALUE" FilterDefinitionName="MARCA" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="NULL_VALUE" FilterDefinitionName="CANAL" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="NULL_VALUE" FilterDefinitionName="REGION" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="NULL_VALUE" FilterDefinitionName="ZONA" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="NULL_VALUE" FilterDefinitionName="SECCION" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="NULL_VALUE" FilterDefinitionName="PERIODO" FilterParameter="VALUES"/>  
	</ParameterValues>  
	<Localizations/>  
</ReportSourceDefinition>  

