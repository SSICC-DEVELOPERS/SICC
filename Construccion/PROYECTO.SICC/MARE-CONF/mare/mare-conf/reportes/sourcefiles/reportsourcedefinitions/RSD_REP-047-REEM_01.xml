<?xml version="1.0" encoding="UTF-8"?>  
<!-- edited with XMLSPY v2004 rel. 2 U (http://www.xmlspy.com) by team (renegade) -->  
<ReportSourceDefinition Id="RSD_REP-047-REEM_01" Cached="false" Expiration="0" IncrementalDimension="" Multilanguage="false" MaxRowsDimensionReference="" >  
	<DimensionSourceDefinitions>  
		<DimensionSourceDefinition Name="PAIS" Description="PAIS" DataType="STRING" Calculated="false" Expression="" ExternalData="PAIS"/>  
		<DimensionSourceDefinition Name="DES_MARC" Description="DES_MARC" DataType="STRING" Calculated="false" Expression="" ExternalData="DES_MARC"/>  
		<DimensionSourceDefinition Name="CANAL" Description="CANAL" DataType="STRING" Calculated="false" Expression="" ExternalData="CANAL"/>  
		<DimensionSourceDefinition Name="ALT_REEMP" Description="ALT_REEMP" DataType="STRING" Calculated="false" Expression="" ExternalData="ALT_REEMP"/>  
		<DimensionSourceDefinition Name="VAL_CODI_VENT" Description="VAL_CODI_VENT" DataType="STRING" Calculated="false" Expression="" ExternalData="VAL_CODI_VENT"/>  
		<DimensionSourceDefinition Name="COD_SAP" Description="COD_SAP" DataType="STRING" Calculated="false" Expression="" ExternalData="COD_SAP"/>  
		<DimensionSourceDefinition Name="DESC_PROD" Description="DESC_PROD" DataType="STRING" Calculated="false" Expression="" ExternalData="DESC_PROD"/>  
		<DimensionSourceDefinition Name="ESTRAT" Description="ESTRAT" DataType="STRING" Calculated="false" Expression="" ExternalData="ESTRAT"/>  
		<DimensionSourceDefinition Name="VAL_FACT_REPE" Description="VAL_FACT_REPE" DataType="STRING" Calculated="false" Expression="" ExternalData="VAL_FACT_REPE"/>  
		<DimensionSourceDefinition Name="VAL_NOMB_PERI" Description="VAL_NOMB_PERI" DataType="STRING" Calculated="false" Expression="" ExternalData="VAL_NOMB_PERI"/>  
		<DimensionSourceDefinition Name="VAL_CODI_VENT_ORIG" Description="VAL_CODI_VENT_ORIG" DataType="STRING" Calculated="false" Expression="" ExternalData="VAL_CODI_VENT_ORIG"/>  
		<DimensionSourceDefinition Name="COD_SAP_ORIG" Description="COD_SAP_ORIG" DataType="STRING" Calculated="false" Expression="" ExternalData="COD_SAP_ORIG"/>  
		<DimensionSourceDefinition Name="DESC_PROD_ORIG" Description="DESC_PROD_ORIG" DataType="STRING" Calculated="false" Expression="" ExternalData="DESC_PROD_ORIG"/>  
		<DimensionSourceDefinition Name="ESTRAT_ORIG" Description="ESTRAT_ORIG" DataType="STRING" Calculated="false" Expression="" ExternalData="ESTRAT_ORIG"/>  
		<DimensionSourceDefinition Name="VAL_FACT_REPE_ORIG" Description="VAL_FACT_REPE_ORIG" DataType="STRING" Calculated="false" Expression="" ExternalData="VAL_FACT_REPE_ORIG"/>  
		<DimensionSourceDefinition Name="VAL_NOMB_PERI_ORIG" Description="VAL_NOMB_PERI_ORIG" DataType="STRING" Calculated="false" Expression="" ExternalData="VAL_NOMB_PERI_ORIG"/>  
	</DimensionSourceDefinitions>  
	<MetricSourceDefinitions>  
		<MetricSourceDefinition Name="IMP_PREC_CATA" Description="IMP_PREC_CATA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="IMP_PREC_CATA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="IMP_PREC_CATA_ORIG" Description="IMP_PREC_CATA_ORIG" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="IMP_PREC_CATA_ORIG" ExternalCalculated="false"/>  
	</MetricSourceDefinitions>  
	<FilterDefinitions>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="IDIOMA" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="PAIS" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="MARCA" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="CANAL" Visual="FALSE"/>  
		<FilterDefinition DataType="STRING" FilterType="EQUALTO" Name="CODIGOVENTADESDE" Visual="FALSE"/>  
		<FilterDefinition DataType="STRING" FilterType="EQUALTO" Name="CODIGOVENTAHASTA" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="PERIODO" Visual="FALSE"/>  
	</FilterDefinitions>  
	<ParameterValues>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="IDIOMA" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="PAIS" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="MARCA" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="CANAL" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="CODIGOVENTADESDE" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="999999" FilterDefinitionName="CODIGOVENTAHASTA" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="57" FilterDefinitionName="PERIODO" FilterParameter="VALUE"/>  
	</ParameterValues>  
	<DataSourceDefinitions>  
		<DataSourceDefinition Name="REP-047" SourceType="SQL" Expression="SELECT   
	ALTERN.PAIS, ALTERN.DES_MARC, ALTERN.CANAL,  
	'000000000000' as ALT_REEMP,   
	ALTERN.VAL_CODI_VENT,  
	ALTERN.COD_SAP,  
	ALTERN.DESC_PROD,  
	ALTERN.ESTRAT,  
	ALTERN.VAL_FACT_REPE,  
	ALTERN.VAL_NOMB_PERI,  
	ORIG.VAL_CODI_VENT AS VAL_CODI_VENT_ORIG,  
	ORIG.COD_SAP AS COD_SAP_ORIG,  
	ORIG.DESC_PROD AS DESC_PROD_ORIG,  
	ORIG.ESTRAT AS ESTRAT_ORIG,  
	ORIG.VAL_FACT_REPE AS VAL_FACT_REPE_ORIG,  
	ORIG.VAL_NOMB_PERI AS VAL_NOMB_PERI_ORIG,  
	ALTERN.IMP_PREC_CATA,  
	ORIG.IMP_PREC_CATA AS IMP_PREC_CATA_ORIG  
FROM  
	(  
	SELECT   
		  I18PAIS.VAL_I18N PAIS, MARCA.DES_MARC, I18CANAL.VAL_I18N CANAL,  
		  OFEDET.VAL_CODI_VENT, PROD.COD_SAP, I18PROD.VAL_I18N AS DESC_PROD,   
		  OFEDET.IMP_PREC_CATA, ES.COD_ESTR ESTRAT, OFEDET.VAL_FACT_REPE, PERI.VAL_NOMB_PERI,   
		  MF.OID_MATR_FACT, PERI.OID_PERI, PROD.OID_PROD    
	FROM  
		  CRA_PERIO PERI,  
		  PRE_OFERT OFE,  
		  PRE_OFERT_DETAL OFEDET,  
		  PRE_MATRI_FACTU MF,  
		  PRE_MATRI_FACTU_CABEC MFC,  
		  MAE_PRODU PROD,  
		  PRE_ESTRA ES,  
		  SEG_MARCA MARCA,  
		  (  
		  SELECT V.VAL_OID, V.VAL_I18N   
		  FROM V_GEN_I18N_SICC V   
		  WHERE V.ATTR_ENTI = 'MAE_PRODU'  
		  AND V.IDIO_OID_IDIO = %value_IDIOMAVALUE%  
		  ) I18PROD,  
		  (  
		  SELECT V.VAL_OID, V.VAL_I18N   
		  FROM V_GEN_I18N_SICC V   
		  WHERE V.ATTR_ENTI = 'SEG_PAIS'   
		  AND V.IDIO_OID_IDIO = %value_IDIOMAVALUE%  
		  ) I18PAIS,  
		  (  
		  SELECT V.VAL_OID, V.VAL_I18N   
		  FROM V_GEN_I18N_SICC V   
		  WHERE V.ATTR_ENTI = 'SEG_CANAL'   
		  AND V.IDIO_OID_IDIO = %value_IDIOMAVALUE%  
		  ) I18CANAL  
	WHERE  
		      PERI.OID_PERI = MFC.PERD_OID_PERI  
		  AND OFE.MFCA_OID_CABE = MFC.OID_CABE  
		  AND MF.MFCA_OID_CABE = MFC.OID_CABE  
		  AND OFE.OID_OFER = OFEDET.OFER_OID_OFER  	  
		  AND OFEDET.OID_DETA_OFER = MF.OFDE_OID_DETA_OFER  
		  AND OFEDET.PROD_OID_PROD = PROD.OID_PROD  
		  AND OFE.COES_OID_ESTR = ES.OID_ESTR  
	      AND I18PAIS.VAL_OID(+) = PERI.PAIS_OID_PAIS   
	      AND I18CANAL.VAL_OID(+) = PERI.CANA_OID_CANA   
	      AND I18PROD.VAL_OID(+) = OFEDET.PROD_OID_PROD   
		  AND PERI.MARC_OID_MARC = MARCA.OID_MARC(+)  
		  AND PERI.OID_PERI = %value_PERIODOVALUE%  
	) ALTERN,  
	(  
	SELECT   
		  I18PAIS.VAL_I18N PAIS, MARCA.DES_MARC, I18CANAL.VAL_I18N CANAL,  
		  OFEDET.VAL_CODI_VENT, PROD.COD_SAP, I18PROD.VAL_I18N AS DESC_PROD,   
		  OFEDET.IMP_PREC_CATA, ES.COD_ESTR ESTRAT, OFEDET.VAL_FACT_REPE, PERI.VAL_NOMB_PERI,  
		  MF.OID_MATR_FACT, PERI.OID_PERI, PROD.OID_PROD    
	FROM  
		  CRA_PERIO PERI,  
		  PRE_OFERT OFE,  
		  PRE_OFERT_DETAL OFEDET,  
		  PRE_MATRI_FACTU MF,  
		  PRE_MATRI_FACTU_CABEC MFC,  
		  MAE_PRODU PROD,  
		  PRE_ESTRA ES,  
		  SEG_MARCA MARCA,  
		  (  
		  SELECT V.VAL_OID, V.VAL_I18N   
		  FROM V_GEN_I18N_SICC V   
		  WHERE V.ATTR_ENTI = 'MAE_PRODU'  
		  AND V.IDIO_OID_IDIO = %value_IDIOMAVALUE%  
		  ) I18PROD,  
		  (  
		  SELECT V.VAL_OID, V.VAL_I18N   
		  FROM V_GEN_I18N_SICC V   
		  WHERE V.ATTR_ENTI = 'SEG_PAIS'   
		  AND V.IDIO_OID_IDIO = %value_IDIOMAVALUE%  
		  ) I18PAIS,  
		  (  
		  SELECT V.VAL_OID, V.VAL_I18N   
		  FROM V_GEN_I18N_SICC V   
		  WHERE V.ATTR_ENTI = 'SEG_CANAL'   
		  AND V.IDIO_OID_IDIO = %value_IDIOMAVALUE%  
		  ) I18CANAL  
	WHERE  
		      PERI.OID_PERI = MFC.PERD_OID_PERI  
		  AND OFE.MFCA_OID_CABE = MFC.OID_CABE  
		  AND MF.MFCA_OID_CABE = MFC.OID_CABE  
		  AND OFE.OID_OFER = OFEDET.OFER_OID_OFER  	  
		  AND OFEDET.OID_DETA_OFER = MF.OFDE_OID_DETA_OFER  
		  AND OFEDET.PROD_OID_PROD = PROD.OID_PROD  
		  AND OFE.COES_OID_ESTR = ES.OID_ESTR  
	      AND I18PAIS.VAL_OID(+) = PERI.PAIS_OID_PAIS   
	      AND I18CANAL.VAL_OID(+) = PERI.CANA_OID_CANA   
	      AND I18PROD.VAL_OID(+) = OFEDET.PROD_OID_PROD   
		  AND PERI.MARC_OID_MARC = MARCA.OID_MARC(+)  
		  AND PERI.PAIS_OID_PAIS = %value_PAISVALUE%  
		  AND PERI.MARC_OID_MARC = %value_MARCAVALUE%  
		  AND PERI.CANA_OID_CANA = %value_CANALVALUE%  
	) ORIG,  
	PRE_MATRI_REEMP MREEMP  
WHERE  
	 	ORIG.PAIS = ALTERN.PAIS  
	AND ORIG.DES_MARC = ALTERN.DES_MARC  
	AND ORIG.CANAL = ALTERN.CANAL  
	AND MREEMP.MAFA_OID_COD_PPAL = ORIG.OID_MATR_FACT    
	AND MREEMP.MAFA_OID_COD_REEM = ALTERN.OID_MATR_FACT    
	AND ALTERN.VAL_CODI_VENT >= %value_CODIGOVENTADESDEVALUE%	   		   
	AND ALTERN.VAL_CODI_VENT &lt;= %value_CODIGOVENTAHASTAVALUE%		  
ORDER BY  
	ALTERN.PAIS, ALTERN.DES_MARC, ALTERN.CANAL,  
	VAL_CODI_VENT" ExternalClassName="oracle.jdbc.driver.OracleDriver" ExternalSourceData="" ExternalConnectionString="" ExternalConnectionClassName="oracle.jdbc.driver.OracleDriver" ExternalConnectionLocalUrl="jdbc:oracle:thin:@cdos01bd:1523:SICCP" ExternalConnectionDistributedUrl="" ExternalConnectionUser="usu_peru" ExternalConnectionPassword="usu_peru" DatePattern="" DateTimePattern=""/>  
	</DataSourceDefinitions>  
</ReportSourceDefinition>  

