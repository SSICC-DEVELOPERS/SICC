<?xml version="1.0" encoding="UTF-8"?>  
<!-- edited with XMLSPY v2004 rel. 2 U (http://www.xmlspy.com) by a (a) -->  
<ReportSourceDefinition Id="RSD_REP-155" Cached="false" Expiration="0" IncrementalDimension="" Multilanguage="false" MaxRowsDimensionReference="" >  
	<DimensionSourceDefinitions>  
		<DimensionSourceDefinition Name="COD_PAIS" Description=" " DataType="STRING" Calculated="false" Expression="" ExternalData="COD_PAIS"/>  
		<DimensionSourceDefinition Name="1019" Description="" DataType="STRING" Calculated="false" Expression="" ExternalData="VAL_I18N"/>  
		<DimensionSourceDefinition Name="1028" Description=" " DataType="STRING" Calculated="false" Expression="" ExternalData="DES_MARC"/>  
		<DimensionSourceDefinition Name="1027" Description=" " DataType="STRING" Calculated="false" Expression="" ExternalData="VAL_I18N_1"/>  
		<DimensionSourceDefinition Name="COD_SUBG_VENT" Description=" " DataType="STRING" Calculated="false" Expression="" ExternalData="COD_SUBG_VENT"/>  
		<DimensionSourceDefinition Name="1020" Description=" " DataType="STRING" Calculated="false" Expression="" ExternalData="DES_SUBG_VENT"/>  
		<DimensionSourceDefinition Name="COD_REGI" Description=" " DataType="STRING" Calculated="false" Expression="" ExternalData="COD_REGI"/>  
		<DimensionSourceDefinition Name="1022" Description=" " DataType="STRING" Calculated="false" Expression="" ExternalData="DES_REGI"/>  
		<DimensionSourceDefinition Name="COD_ZONA" Description=" " DataType="STRING" Calculated="false" Expression="" ExternalData="COD_ZONA"/>  
		<DimensionSourceDefinition Name="1023" Description=" " DataType="STRING" Calculated="false" Expression="" ExternalData="DES_ZONA"/>  
		<DimensionSourceDefinition Name="COD_SECC" Description=" " DataType="STRING" Calculated="false" Expression="" ExternalData="COD_SECC"/>  
		<DimensionSourceDefinition Name="1024" Description=" " DataType="STRING" Calculated="false" Expression="" ExternalData="DES_SECCI"/>  
		<DimensionSourceDefinition Name="1025" Description=" " DataType="STRING" Calculated="false" Expression="" ExternalData="COD_TERR"/>  
		<DimensionSourceDefinition Name="RESP_SUBG" Description=" " DataType="STRING" Calculated="false" Expression="" ExternalData="RESP_SUBG"/>  
		<DimensionSourceDefinition Name="RESP_REG" Description="  " DataType="STRING" Calculated="false" Expression="" ExternalData="RESP_REG"/>  
		<DimensionSourceDefinition Name="1042" Description=" " DataType="STRING" Calculated="false" Expression="" ExternalData="RESP_ZON"/>  
		<DimensionSourceDefinition Name="RESP_SEC" Description=" " DataType="STRING" Calculated="false" Expression="" ExternalData="RESP_SEC"/>  
	</DimensionSourceDefinitions>  
	<MetricSourceDefinitions>  
		<MetricSourceDefinition Name="1038" Description=" " AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="ACTIVAS" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="1039" Description=" " AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="INGRESOS" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="1040" Description=" " AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="EGRESOS" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="1041" Description=" " AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="4to Pedido" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="SUM_UNID_DEMA_REAL_TOTA" Description=" " AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="SUM_UNID_DEMA_REAL_TOTA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="SUM_UNID_POR_ATEN_TOTA" Description=" " AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="SUM_UNID_POR_ATEN_TOTA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="SUM_UNID_ATEN_TOTA" Description=" " AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="SUM_UNID_ATEN_TOTA" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="1037" Description=" " AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="SUM_PREC_NETO_TOTA_LOCA" ExternalCalculated="false"/>  
	</MetricSourceDefinitions>  
	<DataSourceDefinitions>  
		<DataSourceDefinition Name="REP-155" SourceType="SQL" Expression="		  
		SELECT  
		COD_PAIS,  
		VAL_I18N,  
		DES_MARC,                  
		VAL_I18N_1,                
		COD_SUBG_VENT,             
		DES_SUBG_VENT,            
		COD_REGI,                 
		DES_REGI,                  
		COD_ZONA,                  
		DES_ZONA,                  
		COD_SECC,                  
		DES_SECCI,                 
		COD_TERR,                 
		RESP_SUBG,                 
		RESP_REG,                  
		RESP_ZON,                  
		RESP_SEC,                  
		ACTIVAS,                   
		INGRESOS,                  
		EGRESOS,                   
		CASE WHEN (CANTIDAD>=4) THEN  
			 1  
		ELSE 0 END AS &quot;4TO Pedido&quot;,                
		SUM_UNID_DEMA_REAL_TOTA,   
		SUM_UNID_POR_ATEN_TOTA,    
		SUM_UNID_ATEN_TOTA,        
		SUM_PREC_NETO_TOTA_LOCA  
FROM   
(SELECT   
	   PAIS.COD_PAIS, I18PAIS.VAL_I18N,   
	   MARC.DES_MARC, I18CANA.VAL_I18N AS VAL_I18N_1,  
	   SUBG.COD_SUBG_VENT, SUBG.DES_SUBG_VENT,			     
	   REG.COD_REGI, REG.DES_REGI,   
	   ZON.COD_ZONA, ZON.DES_ZONA,   
	   SEC.COD_SECC, SEC.DES_SECCI,  
	   TER.COD_TERR,  
   	   (CLISUBG.VAL_APE1 || ' ' || CLISUBG.VAL_APE2 || ' ' || DECODE(CLISUBG.VAL_APEL_CASA,NULL,'','de ' || CLISUBG.VAL_APEL_CASA) || ' ' || CLISUBG.VAL_NOM1 || ' ' || CLISUBG.VAL_NOM2) AS RESP_SUBG,   
   	   (CLIREG.VAL_APE1 || ' ' || CLIREG.VAL_APE2 || ' ' || DECODE(CLIREG.VAL_APEL_CASA,NULL,'','de ' || CLIREG.VAL_APEL_CASA) || ' ' || CLIREG.VAL_NOM1 || ' ' || CLIREG.VAL_NOM2) AS RESP_REG,  
	   (CLIZON.VAL_APE1 || ' ' || CLIZON.VAL_APE2 || ' ' || DECODE(CLIZON.VAL_APEL_CASA,NULL,'','de ' || CLIZON.VAL_APEL_CASA) || ' ' || CLIZON.VAL_NOM1 || ' ' || CLIZON.VAL_NOM2) AS RESP_ZON,  
	   (CLISEC.VAL_APE1 || ' ' || CLISEC.VAL_APE2 || ' ' || DECODE(CLISEC.VAL_APEL_CASA,NULL,'','de ' || CLISEC.VAL_APEL_CASA) || ' ' || CLISEC.VAL_NOM1 || ' ' || CLISEC.VAL_NOM2) AS RESP_SEC,  
   	   SUM(DECODE(CLIHIST.ESTA_OID_ESTA_CLIE,1,1,0)) AS ACTIVAS, SUM(DECODE(CLIHIST.ESTA_OID_ESTA_CLIE,2,1,0)) AS INGRESOS, SUM(DECODE(CLIHIST.ESTA_OID_ESTA_CLIE,5,1,0)) AS EGRESOS,  COUNT (ped.oid_soli_cabe) AS cantidad,  
	   SUM(PED.VAL_UNID_DEMA_REAL_TOTA) AS SUM_UNID_DEMA_REAL_TOTA, SUM(PED.NUM_UNID_POR_ATEN_TOTA) AS SUM_UNID_POR_ATEN_TOTA, SUM(PED.NUM_UNID_ATEN_TOTA) AS SUM_UNID_ATEN_TOTA, SUM(PED.VAL_PREC_NETO_TOTA_LOCA) AS SUM_PREC_NETO_TOTA_LOCA     
FROM   
	 V_GEN_I18N_SICC I18CANA,  
	 V_GEN_I18N_SICC I18PAIS,  
	 SEG_PAIS PAIS,  
	 SEG_MARCA MARC,  
	 ZON_SUB_GEREN_VENTA SUBG,   
	 ZON_REGIO REG,   
	 ZON_ZONA ZON,  
	 ZON_SECCI SEC,  
	 ZON_TERRI TER,  
	 ZON_TERRI_ADMIN TERADMIN,  
	 MAE_CLIEN CLISUBG,  
	 MAE_CLIEN CLIREG,  
	 MAE_CLIEN CLIZON,  
	 MAE_CLIEN CLISEC,  
	 MAE_CLIEN_UNIDA_ADMIN CLIADMIN,  
	 MAE_CLIEN_HISTO_ESTAT CLIHIST,  
	 MAE_CLIEN_DATOS_ADICI CLIADIC,  
	 PED_SOLIC_CABEC PED,  
	 %start_PERIODOHASTAVALUE%  
	(  
		   SELECT FEC_FINA  
		   FROM CRA_PERIO PER  
		   WHERE PER.PAIS_OID_PAIS =%value_PAISVALUE%	  
		   		 AND PER.MARC_OID_MARC =%value_MARCAVALUE%  
				 AND PER.CANA_OID_CANA =%value_CANALVALUE%  
				 AND PER.OID_PERI = %value_PERIODOHASTAVALUE%  
	 ) PER_FIN, %end_PERIODOHASTAVALUE%  
	   
	 (  
		   SELECT FEC_INIC  
		   FROM CRA_PERIO PER  
		   WHERE PER.PAIS_OID_PAIS =%value_PAISVALUE%	  
		   		 AND PER.MARC_OID_MARC =%value_MARCAVALUE%  
				 AND PER.CANA_OID_CANA =%value_CANALVALUE%  
				 AND PER.OID_PERI = %value_PERIODODESDEVALUE%  
	) PER_INI,  
%start_PERIODOHASTAVALUE%	CRA_PERIO PER_HIST_FIN, %end_PERIODOHASTAVALUE%  
	CRA_PERIO PER_HIST_INI  
WHERE   
	  	  SUBG.OID_SUBG_VENT = REG.ZSGV_OID_SUBG_VENT  
	  AND REG.OID_REGI = ZON.ZORG_OID_REGI  
	  AND ZON.OID_ZONA = SEC.ZZON_OID_ZONA  
	  AND SEC.OID_SECC = TERADMIN.ZSCC_OID_SECC  
	  AND PAIS.OID_PAIS = SUBG.PAIS_OID_PAIS  
	  AND PAIS.OID_PAIS = REG.PAIS_OID_PAIS  
	  AND PAIS.OID_PAIS = ZON.PAIS_OID_PAIS  
	  AND PAIS.OID_PAIS = TERADMIN.PAIS_OID_PAIS  
	  AND MARC.OID_MARC = SUBG.MARC_OID_MARC  
	  AND SUBG.CLIE_OID_CLIE = CLISUBG.OID_CLIE(+)  
	  AND REG.CLIE_OID_CLIE = CLIREG.OID_CLIE(+)  
	  AND ZON.CLIE_OID_CLIE = CLIZON.OID_CLIE(+)  
	  AND SEC.CLIE_OID_CLIE = CLISEC.OID_CLIE(+)  
	  AND I18PAIS.VAL_OID = PAIS.OID_PAIS  
	  AND I18CANA.VAL_OID = SUBG.CANA_OID_CANA  
	  AND I18PAIS.ATTR_ENTI = 'SEG_PAIS'	  
	  AND I18CANA.ATTR_ENTI = 'SEG_CANAL'	  
	  %start_PERIODOHASTAVALUE%  
	  AND PER_HIST_INI.PAIS_OID_PAIS = PER_HIST_FIN.PAIS_OID_PAIS   
	  AND PER_HIST_INI.MARC_OID_MARC = PER_HIST_FIN.MARC_OID_MARC   
	  AND PER_HIST_INI.CANA_OID_CANA = PER_HIST_FIN.CANA_OID_CANA   
	  %end_PERIODOHASTAVALUE%  
	  AND SUBG.IND_BORR = 0  
	  AND I18PAIS.IDIO_OID_IDIO = %value_IDIOMAVALUE%  
	  AND I18CANA.IDIO_OID_IDIO = %value_IDIOMAVALUE%  
	  AND PAIS.OID_PAIS = %value_PAISVALUE%	  	   
	  AND SUBG.MARC_OID_MARC = %value_MARCAVALUE%   
	  AND SUBG.CANA_OID_CANA = %value_CANALVALUE%  
	  AND PER_HIST_INI.PAIS_OID_PAIS = PAIS.OID_PAIS  
	  AND PER_HIST_INI.MARC_OID_MARC = %value_MARCAVALUE%   
	  AND PER_HIST_INI.CANA_OID_CANA = %value_CANALVALUE%   
	  %start_SUBGERENCIAVENTAVALUE% AND SUBG.OID_SUBG_VENT = %value_SUBGERENCIAVENTAVALUE% %end_SUBGERENCIAVENTAVALUE%  
	  %start_REGIONVALUE% AND REG.OID_REGI = %value_REGIONVALUE% %end_REGIONVALUE%  
	  %start_ZONAVALUE% AND ZON.OID_ZONA = %value_ZONAVALUE% %end_ZONAVALUE%  
	  %start_SECCIONVALUE% AND SEC.OID_SECC = %value_SECCIONVALUE% %end_SECCIONVALUE%  
	  %start_TERRITORIOVALUE% AND TER.OID_TERR = %value_TERRITORIOVALUE% %end_TERRITORIOVALUE%  
	  AND TERADMIN.OID_TERR_ADMI = CLIADMIN.ZTAD_OID_TERR_ADMI(+)  
	  AND TERADMIN.TERR_OID_TERR = TER.OID_TERR  
	  AND CLIADMIN.CLIE_OID_CLIE = CLIHIST.CLIE_OID_CLIE(+)  
	  AND CLIADMIN.CLIE_OID_CLIE = CLIADIC.CLIE_OID_CLIE(+)  
	  AND CLIADMIN.CLIE_OID_CLIE = PED.CLIE_OID_CLIE(+)  
	  AND CLIHIST.PERD_OID_PERI = PER_HIST_INI.OID_PERI  
	  AND PER_HIST_INI.FEC_INIC >= PER_INI.FEC_INIC  
	  %start_PERIODOHASTAVALUE%  
	   AND PER_HIST_FIN.FEC_FINA &lt;= PER_FIN.FEC_FINA  
  	   AND CASE WHEN (CLIHIST.PERD_OID_PERI_PERI_FIN IS NULL) THEN %value_PERIODOHASTAVALUE% ELSE CLIHIST.PERD_OID_PERI_PERI_FIN END = PER_HIST_FIN.OID_PERI  
	   %end_PERIODOHASTAVALUE%    
GROUP BY  
	   CLIADMIN.OID_CLIE_UNID_ADMI,  
	   CLIHIST.ESTA_OID_ESTA_CLIE, CLIHIST.PERD_OID_PERI,CLIHIST.PERD_OID_PERI_PERI_FIN,  
	   CLIADIC.ESTA_OID_ESTA_CLIE,   
	   PAIS.COD_PAIS, I18PAIS.VAL_I18N,   
	   MARC.DES_MARC, I18CANA.VAL_I18N,  
	   SUBG.COD_SUBG_VENT, SUBG.DES_SUBG_VENT,			     
	   REG.COD_REGI, REG.DES_REGI,   
	   ZON.COD_ZONA, ZON.DES_ZONA,   
	   SEC.COD_SECC, SEC.DES_SECCI,  
	   TER.COD_TERR,  
	   CLISUBG.VAL_APE1, CLISUBG.VAL_APE2, DECODE(CLISUBG.VAL_APEL_CASA,NULL,'','de ' || CLISUBG.VAL_APEL_CASA), CLISUBG.VAL_NOM1, CLISUBG.VAL_NOM2,  
	   CLIREG.VAL_APE1, CLIREG.VAL_APE2, DECODE(CLIREG.VAL_APEL_CASA,NULL,'','de ' || CLIREG.VAL_APEL_CASA), CLIREG.VAL_NOM1, CLIREG.VAL_NOM2,  
	   CLIZON.VAL_APE1, CLIZON.VAL_APE2, DECODE(CLIZON.VAL_APEL_CASA,NULL,'','de ' || CLIZON.VAL_APEL_CASA), CLIZON.VAL_NOM1, CLIZON.VAL_NOM2,  
	   CLISEC.VAL_APE1, CLISEC.VAL_APE2, DECODE(CLISEC.VAL_APEL_CASA,NULL,'','de ' || CLISEC.VAL_APEL_CASA), CLISEC.VAL_NOM1, CLISEC.VAL_NOM2  
)  
ORDER BY  
	  COD_SUBG_VENT,   
	  COD_REGI,   
	  COD_ZONA,   
	  COD_SECC,  
	  COD_TERR  
	" ExternalClassName="oracle.jdbc.driver.OracleDriver" ExternalSourceData="" ExternalConnectionString="" ExternalConnectionClassName="oracle.jdbc.driver.OracleDriver" ExternalConnectionLocalUrl="jdbc:oracle:thin:@192.168.118.106:1523:SICCV3D" ExternalConnectionDistributedUrl="" ExternalConnectionUser="usu_peru" ExternalConnectionPassword="peru" DatePattern="" DateTimePattern=""/>  
	</DataSourceDefinitions>  
	<FilterDefinitions>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="IDIOMA" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="PAIS" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="MARCA" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="CANAL" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="SUBGERENCIAVENTA" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="REGION" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="ZONA" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="SECCION" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="TERRITORIO" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="PERIODODESDE" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="PERIODOHASTA" Visual="FALSE"/>  
	</FilterDefinitions>  
	<ParameterValues>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="IDIOMA" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="PAIS" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="MARCA" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="CANAL" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="NULL_VALUE" FilterDefinitionName="SUBGERENCIAVENTA" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="NULL_VALUE" FilterDefinitionName="REGION" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="NULL_VALUE" FilterDefinitionName="ZONA" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="NULL_VALUE" FilterDefinitionName="SECCION" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="NULL_VALUE" FilterDefinitionName="TERRITORIO" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="24" FilterDefinitionName="PERIODODESDE" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="NULL_VALUE" FilterDefinitionName="PERIODOHASTA" FilterParameter="VALUE"/>  
	</ParameterValues>  
	<Localizations/>  
</ReportSourceDefinition>  

