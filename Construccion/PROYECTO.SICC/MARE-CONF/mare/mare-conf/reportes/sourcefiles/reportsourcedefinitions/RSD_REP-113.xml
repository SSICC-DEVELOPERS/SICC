<?xml version="1.0" encoding="UTF-8"?>  
<!-- edited with XMLSPY v2004 rel. 2 U (http://www.xmlspy.com) by team (renegade) -->  
<ReportSourceDefinition Id="RSD_REP-113" Cached="false" Expiration="0" IncrementalDimension="" Multilanguage="false" MaxRowsDimensionReference="" >  
	<DimensionSourceDefinitions>  
		<DimensionSourceDefinition Name="PAIS" Description="PAIS" DataType="STRING" Calculated="false" Expression="" ExternalData="PAIS"/>  
		<DimensionSourceDefinition Name="SOCI" Description="SOCI" DataType="STRING" Calculated="false" Expression="" ExternalData="SOCI"/>  
		<DimensionSourceDefinition Name="VAL_NOMB_PERI" Description="VAL_NOMB_PERI" DataType="STRING" Calculated="false" Expression="" ExternalData="VAL_NOMB_PERI"/>  
		<DimensionSourceDefinition Name="DES_REGI" Description="DES_REGI" DataType="STRING" Calculated="false" Expression="" ExternalData="DES_REGI"/>  
		<DimensionSourceDefinition Name="GRUPO" Description="GRUPO" DataType="STRING" Calculated="false" Expression="" ExternalData="GRUPO"/>  
	</DimensionSourceDefinitions>  
	<MetricSourceDefinitions>  
		<MetricSourceDefinition Name="FAC_NOREC_NOPRE" Description="FAC_NOREC_NOPRE" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="FAC_NOREC_NOPRE" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="FAC_SOLO_PRE" Description="FAC_SOLO_PRE" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="FAC_SOLO_PRE" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="FAC_SOLO_REC" Description="FAC_SOLO_REC" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="FAC_SOLO_REC" ExternalCalculated="false"/>  
		<MetricSourceDefinition Name="FAC_PRE_REC" Description="FAC_PRE_REC" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="FAC_PRE_REC" ExternalCalculated="false"/>  
	</MetricSourceDefinitions>  
	<FilterDefinitions>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="IDIOMA" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="PAIS" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="MARCA" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="PERIODOINICIAL" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="PERIODOFINAL" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="EQUALTO" Name="CANAL" Visual="FALSE"/>  
		<FilterDefinition DataType="INTEGER" FilterType="IN" Name="REGION" Visual="FALSE"/>  
	</FilterDefinitions>  
	<DataSourceDefinitions>  
		<DataSourceDefinition Name="REP-113" SourceType="SQL" Expression="		  
SELECT GEN_PAIS.VAL_I18N PAIS,  
	   GEN_SOCI.VAL_I18N SOCI,  
	   DATOS.VAL_NOMB_PERI,  
		DATOS.DES_REGI,  
	   DATOS.GRUPO,  
	   DATOS.FAC_NOREC_NOPRE,  
	   DATOS.FAC_SOLO_PRE,  
	   DATOS.FAC_SOLO_REC,  
	   DATOS.FAC_PRE_REC  
FROM  
(  
	(  
	SELECT PAIS_OID_PAIS,  
		   SOCI_OID_SOCI,  
		   VAL_NOMB_PERI,  
		   DES_REGI,  
		   'PEDIDOS FACTURADOS' GRUPO,  
		   SUM(PED_FAC_NOREC_NOPRE) FAC_NOREC_NOPRE,  
		   SUM(PED_FAC_SOLO_PRE) FAC_SOLO_PRE,  
		   SUM(PED_FAC_SOLO_REC) FAC_SOLO_REC,  
		   SUM(PED_FAC_REC_PRE) FAC_PRE_REC	     
	FROM  
	(  
	 	SELECT PAIS_OID_PAIS,  
			   SOCI_OID_SOCI,  
			   VAL_NOMB_PERI,  
	           DES_REGI,  			     
			   SOCA_OID_SOLI_CABE,  
			   CASE WHEN(SUM(PED_REC) = 0 AND SUM(PED_INC) = 0) THEN  
			   		1  
			   ELSE  
			   	    0  
			   END PED_FAC_NOREC_NOPRE,  
			   CASE WHEN(SUM(PED_INC) &gt; 0 AND SUM(PED_REC) = 0) THEN  
			   		1  
			   ELSE  
			   	    0  
			   END PED_FAC_SOLO_PRE,  
			   CASE WHEN(SUM(PED_REC) &gt; 0 AND SUM(PED_INC) = 0) THEN  
			   		1  
			   ELSE  
			   	    0  
			   END PED_FAC_SOLO_REC,  
			   CASE WHEN((SUM(PED_INC) + SUM(PED_REC) = SUM(TOT_PED)) AND SUM(PED_INC) &gt; 0 AND SUM(PED_REC) &gt; 0 ) THEN  
			   		1  
			   ELSE  
			   	    0  
			   END PED_FAC_REC_PRE  
	 	FROM  
	 	    (  
			SELECT SOL_CAB.PAIS_OID_PAIS,  
				   SOL_CAB.SOCI_OID_SOCI,  
				   PERI.VAL_NOMB_PERI,  
				   REG.DES_REGI,  
				   SOL_CAB.SOCA_OID_SOLI_CABE,  
				   COUNT(SOL_CAB.OID_SOLI_CABE) TOT_PED,  
				   NVL(CASE WHEN (MODU.COD_MODU = 15) THEN  
				   		COUNT(SOL_CAB.OID_SOLI_CABE)  
				   END, 0) PED_REC,  
				   NVL(CASE WHEN (MODU.COD_MODU = 13) THEN  
				   		COUNT(SOL_CAB.OID_SOLI_CABE)  
				   END, 0) PED_INC	   		  
			FROM PED_SOLIC_CABEC SOL_CAB,  
				 CRA_PERIO PERI,  
				 ZON_ZONA ZONA,  
				 ZON_REGIO REG,  
				 SEG_MODUL MODU,  
				 (  
				 SELECT FEC_INIC  
				 FROM CRA_PERIO  
				 WHERE OID_PERI = %value_PERIODOINICIALVALUE%  
				 ) FI,  
				 (  
				 SELECT FEC_FINA  
				 FROM CRA_PERIO  
				 WHERE OID_PERI =  DECODE(%value_PERIODOFINALVALUE%,-1, %value_PERIODOINICIALVALUE%,%value_PERIODOFINALVALUE%)  
  
				 ) FF	   
			WHERE PERI.FEC_INIC &gt;= FI.FEC_INIC  
				  AND SOL_CAB.ZZON_OID_ZONA = ZONA.OID_ZONA  
				  AND SOL_CAB.PERD_OID_PERI = PERI.OID_PERI  
				  AND SOL_CAB.MODU_OID_MODU = MODU.OID_MODU  
				  AND REG.OID_REGI = ZONA.ZORG_OID_REGI  
				  AND PERI.FEC_FINA &lt;= FF.FEC_FINA  
				  AND SOL_CAB.FEC_FACT IS NOT NULL  
				  AND SOL_CAB.IND_TS_NO_CONSO = 1  
				  AND PERI.PAIS_OID_PAIS = %value_PAISVALUE%	   
				  AND PERI.CANA_OID_CANA =  %value_CANALVALUE%  
				  AND PERI.MARC_OID_MARC = %value_MARCAVALUE%  
				 %start_REGIONVALUES%    AND ZONA.ZORG_OID_REGI IN (%value_REGIONVALUES%)  %end_REGIONVALUES%   
			GROUP BY SOL_CAB.PAIS_OID_PAIS,  
				   SOL_CAB.SOCI_OID_SOCI,  
				   SOL_CAB.SBAC_OID_SBAC,  
				   SOL_CAB.SOCA_OID_SOLI_CABE,  
		   		   REG.DES_REGI,  
				   PERI.VAL_NOMB_PERI,  
				   MODU.COD_MODU  
			)  
		GROUP BY PAIS_OID_PAIS,  
			   SOCI_OID_SOCI,  
			   VAL_NOMB_PERI,  
			   SOCA_OID_SOLI_CABE,  
	           DES_REGI  
	)	    
	GROUP BY PAIS_OID_PAIS,  
		   SOCI_OID_SOCI,  
		   VAL_NOMB_PERI,  
		   DES_REGI,  
		   'PEDIDOS FACTURADOS'  
	)	    
	UNION ALL  
	(  
	SELECT PAIS_OID_PAIS,  
		   SOCI_OID_SOCI,  
		   VAL_NOMB_PERI,  
		   DES_REGI,  
		   'PEDIDOS DE SERVICIOS' GRUPO,  
		   SUM(PED_REC) SERV_SOLO_REC,  
		   SUM(PED_PRE) SERV_SOLO_PREMIOS,  
		   SUM(0) SERV_REC_PED_VENT,  
		   SUM(0) SERV_PED_FACT	     
	FROM  
	(  
		SELECT SOL_CAB.PAIS_OID_PAIS,  
			   SOL_CAB.SOCI_OID_SOCI,  
			   PERI.VAL_NOMB_PERI,  
			   REG.DES_REGI,  
			   NVL(CASE WHEN (MODU.COD_MODU = 15) THEN  
			   		COUNT(SOL_CAB.OID_SOLI_CABE)  
			   END, 0) PED_REC,  
			   NVL(CASE WHEN (MODU.COD_MODU = 13) THEN  
			   		COUNT(SOL_CAB.OID_SOLI_CABE)  
			   END, 0) PED_PRE	   		  
		FROM PED_SOLIC_CABEC SOL_CAB,  
			 CRA_PERIO PERI,  
			 ZON_REGIO REG,  
			 ZON_ZONA ZONA,  
			 SEG_MODUL MODU,  
			 (  
			 SELECT FEC_INIC  
			 FROM CRA_PERIO  
			 WHERE OID_PERI = %value_PERIODOINICIALVALUE%  
			 ) FI,  
			 (  
			 SELECT FEC_FINA  
			 FROM CRA_PERIO  
			 WHERE OID_PERI = DECODE(%value_PERIODOFINALVALUE%,-1, %value_PERIODOINICIALVALUE%,%value_PERIODOFINALVALUE%)  
			 ) FF	   
		WHERE PERI.FEC_INIC &gt;= FI.FEC_INIC  
			  AND SOL_CAB.ZZON_OID_ZONA = ZONA.OID_ZONA  
			  AND SOL_CAB.PERD_OID_PERI = PERI.OID_PERI  
			  AND SOL_CAB.MODU_OID_MODU = MODU.OID_MODU  
			  AND ZONA.ZORG_OID_REGI = REG.OID_REGI  
			  AND PERI.FEC_FINA &lt;= FF.FEC_FINA  
			  AND SOL_CAB.FEC_FACT IS NULL  
			  AND PERI.PAIS_OID_PAIS = %value_PAISVALUE%	  
			  AND PERI.CANA_OID_CANA = %value_CANALVALUE%  
			  AND PERI.MARC_OID_MARC = %value_MARCAVALUE%  
			 %start_REGIONVALUES%    AND ZONA.ZORG_OID_REGI IN (%value_REGIONVALUES%)  %end_REGIONVALUES%   
		GROUP BY SOL_CAB.PAIS_OID_PAIS,  
			   SOL_CAB.SOCI_OID_SOCI,  
			   PERI.VAL_NOMB_PERI,  
			   REG.DES_REGI,  
			   MODU.COD_MODU  
	)	    
	GROUP BY PAIS_OID_PAIS,  
		   SOCI_OID_SOCI,  
		   VAL_NOMB_PERI,  
		   DES_REGI,  
		   'PEDIDOS DE SERVICIOS'  
	)	    
) DATOS,  
(  
SELECT GEN.VAL_OID, GEN.VAL_I18N  
FROM V_GEN_I18N_SICC GEN  
WHERE GEN.ATTR_ENTI = 'SEG_PAIS'  
	  AND GEN.IDIO_OID_IDIO = %value_IDIOMAVALUE%  
) GEN_PAIS,  
(  
SELECT GEN.VAL_OID, GEN.VAL_I18N  
FROM V_GEN_I18N_SICC GEN  
WHERE GEN.ATTR_ENTI = 'SEG_SOCIE'  
	  AND GEN.IDIO_OID_IDIO = %value_IDIOMAVALUE%  
) GEN_SOCI  
WHERE DATOS.PAIS_OID_PAIS = GEN_PAIS.VAL_OID(+)  
	  AND DATOS.SOCI_OID_SOCI = GEN_SOCI.VAL_OID(+)  
 %and_prefilter% ORDER BY PAIS,  
	  	 SOCI,  
		 VAL_NOMB_PERI,  
		 DES_REGI,  
		 GRUPO DESC    
" ExternalClassName="oracle.jdbc.driver.OracleDriver" ExternalSourceData="" ExternalConnectionString="" ExternalConnectionClassName="oracle.jdbc.driver.OracleDriver" ExternalConnectionLocalUrl="jdbc:oracle:thin:@192.168.118.106:1523:SICCV3D" ExternalConnectionDistributedUrl="" ExternalConnectionUser="usu_peru" ExternalConnectionPassword="peru" DatePattern="" DateTimePattern=""/>  
	</DataSourceDefinitions>  
	<ParameterValues>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="IDIOMA" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="PAIS" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="MARCA" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="1" FilterDefinitionName="CANAL" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="57" FilterDefinitionName="PERIODOINICIAL" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="-1" FilterDefinitionName="PERIODOFINAL" FilterParameter="VALUE"/>  
		<ParameterValue DefaultValue="NULL_VALUE" FilterDefinitionName="REGION" FilterParameter="VALUES"/>  
	</ParameterValues>  
	<Localizations/>  
</ReportSourceDefinition>  

