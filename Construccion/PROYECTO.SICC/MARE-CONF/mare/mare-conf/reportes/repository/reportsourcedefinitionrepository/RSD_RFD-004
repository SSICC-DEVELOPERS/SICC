<?xml version="1.0" encoding="ISO-8859-1"?>  
<ReportSourceDefinition Id="RSD_RFD-004" Cached="false" Expiration="0" IncrementalDimension="" Multilanguage="false" MaxRowsDimensionReference="" ><DimensionSourceDefinitions><DimensionSourceDefinition Name="SOCIEDAD_DEFECTO" Description="1618" DataType="STRING" Calculated="false" Expression="" ExternalData="SOCIEDAD_DEFECTO"/><DimensionSourceDefinition Name="PAIS" Description="1019" DataType="STRING" Calculated="false" Expression="" ExternalData="PAIS"/><DimensionSourceDefinition Name="DES_REGI" Description="2073" DataType="STRING" Calculated="false" Expression="" ExternalData="DES_REGI"/><DimensionSourceDefinition Name="DES_ZONA" Description="1023" DataType="STRING" Calculated="false" Expression="" ExternalData="DES_ZONA"/><DimensionSourceDefinition Name="GRUPO" Description="GRUPO" DataType="STRING" Calculated="false" Expression="" ExternalData="GRUPO"/><DimensionSourceDefinition Name="NIVEL_NUEVAS" Description="NIVEL_NUEVAS" DataType="STRING" Calculated="false" Expression="" ExternalData="NIVEL_NUEVAS"/><DimensionSourceDefinition Name="NIVEL_I" Description="NIVEL_I" DataType="STRING" Calculated="false" Expression="" ExternalData="NIVEL_I"/><DimensionSourceDefinition Name="NIVEL_II" Description="NIVEL_II" DataType="STRING" Calculated="false" Expression="" ExternalData="NIVEL_II"/><DimensionSourceDefinition Name="NIVEL_III" Description="NIVEL_III" DataType="STRING" Calculated="false" Expression="" ExternalData="NIVEL_III"/><DimensionSourceDefinition Name="NIVEL_IV" Description="NIVEL_IV" DataType="STRING" Calculated="false" Expression="" ExternalData="NIVEL_IV"/><DimensionSourceDefinition Name="NIVEL_EGRE" Description="NIVEL_EGRE" DataType="STRING" Calculated="false" Expression="" ExternalData="NIVEL_EGRE"/><DimensionSourceDefinition Name="NIVEL_REINGRE" Description="NIVEL_REINGRE" DataType="STRING" Calculated="false" Expression="" ExternalData="NIVEL_REINGRE"/></DimensionSourceDefinitions><MetricSourceDefinitions><MetricSourceDefinition Name="VENTA_NETA_ESTAD" Description="2093" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="VENTA_NETA_ESTAD" ExternalCalculated="false"/><MetricSourceDefinition Name="N_PEDIDO" Description="2094" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="N_PEDIDO" ExternalCalculated="false"/><MetricSourceDefinition Name="ACTIVIDAD" Description="2095" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="ACTIVIDAD" ExternalCalculated="false"/><MetricSourceDefinition Name="ACTI_FINALES" Description="2096" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="ACTI_FINALES" ExternalCalculated="false"/><MetricSourceDefinition Name="INGRESOS" Description="2097" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="INGRESOS" ExternalCalculated="false"/><MetricSourceDefinition Name="REINGRESOS" Description="2106" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="REINGRESOS" ExternalCalculated="false"/><MetricSourceDefinition Name="EGRESOS" Description="2098" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="EGRESOS" ExternalCalculated="false"/><MetricSourceDefinition Name="CAPITALIZACION" Description="2099" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="CAPITALIZACION" ExternalCalculated="false"/><MetricSourceDefinition Name="REZO_RECIBIDAS" Description="2100" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="REZO_RECIBIDAS" ExternalCalculated="false"/><MetricSourceDefinition Name="REZO_ENTREGADAS" Description="2101" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="REZO_ENTREGADAS" ExternalCalculated="false"/><MetricSourceDefinition Name="PMNP" Description="2102" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PMNP" ExternalCalculated="false"/><MetricSourceDefinition Name="PPU" Description="2103" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PPU" ExternalCalculated="false"/><MetricSourceDefinition Name="PUP" Description="2104" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PUP" ExternalCalculated="false"/><MetricSourceDefinition Name="CPP" Description="2105" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="CPP" ExternalCalculated="false"/><MetricSourceDefinition Name="PORC_VENTA_NIVEL_III" Description="PORC_VENTA_NIVEL_III" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PORC_VENTA_NIVEL_III" ExternalCalculated="false"/><MetricSourceDefinition Name="PORC_ACTIVAS_NIVEL_IV" Description="PORC_ACTIVAS_NIVEL_IV" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PORC_ACTIVAS_NIVEL_IV" ExternalCalculated="false"/><MetricSourceDefinition Name="PORC_VENTA_NIVEL_IV" Description="PORC_VENTA_NIVEL_IV" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PORC_VENTA_NIVEL_IV" ExternalCalculated="false"/><MetricSourceDefinition Name="PORC_ACTIVAS_NIVEL_EGRE" Description="PORC_ACTIVAS_NIVEL_EGRE" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PORC_ACTIVAS_NIVEL_EGRE" ExternalCalculated="false"/><MetricSourceDefinition Name="PORC_VENTA_NIVEL_EGRE" Description="PORC_VENTA_NIVEL_EGRE" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PORC_VENTA_NIVEL_EGRE" ExternalCalculated="false"/><MetricSourceDefinition Name="PORC_ACTIVAS_NIVEL_REINGRE" Description="PORC_ACTIVAS_NIVEL_REINGRE" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PORC_ACTIVAS_NIVEL_REINGRE" ExternalCalculated="false"/><MetricSourceDefinition Name="PORC_VENTA_NIVEL_REINGRE" Description="PORC_VENTA_NIVEL_REINGRE" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="PORC_VENTA_NIVEL_REINGRE" ExternalCalculated="false"/></MetricSourceDefinitions><FilterDefinitions><FilterDefinition Name="IDIOMA" DataType="INTEGER" FilterType="EQUALTO" Visual="false"/><FilterDefinition Name="PAIS" DataType="INTEGER" FilterType="EQUALTO" Visual="false"/><FilterDefinition Name="CANAL" DataType="INTEGER" FilterType="EQUALTO" Visual="false"/><FilterDefinition Name="MARCA" DataType="INTEGER" FilterType="EQUALTO" Visual="false"/><FilterDefinition Name="PERIODODESDE" DataType="INTEGER" FilterType="EQUALTO" Visual="false"/><FilterDefinition Name="PERIODOHASTA" DataType="INTEGER" FilterType="EQUALTO" Visual="false"/><FilterDefinition Name="REGION" DataType="INTEGER" FilterType="EQUALTO" Visual="false"/><FilterDefinition Name="ZONA" DataType="INTEGER" FilterType="EQUALTO" Visual="false"/><FilterDefinition Name="ZONEUSER" DataType="STRING" FilterType="EQUALTO" Visual="false"/></FilterDefinitions><DataSourceDefinitions><DataSourceDefinition Name="RFD-004" SourceType="SQL" Expression="    SELECT * FROM (        SELECT SOC.VAL_DENO SOCIEDAD_DEFECTO          FROM PRINCIPALS PRI,             PROPERTYVALUES PRO,         SEG_SOCIE SOC          WHERE PRI.NAME = %value_ZONEUSERVALUE%                    AND PRO.IDPROPERTY = 48                    AND PRO.IDPRINCIPAL = PRI.IDPRINCIPAL        AND SOC.OID_SOCI = PRO.STRINGVALUE  ), (   (   SELECT  PAIS,         'A' AS GRUPO,         DES_REGI,         DES_ZONA,          NULL AS NIVEL_NUEVAS,                NULL AS NIVEL_I,          NULL AS NIVEL_II,                NULL AS NIVEL_III,         NULL AS NIVEL_IV,         NULL AS NIVEL_EGRE,          NULL AS NIVEL_REINGRE,                  VENTA_NETA_ESTAD,         N_PEDIDO,         ACTIVIDAD,         ACTI_FINALES,         INGRESOS,         REINGRESOS,         EGRESOS,         CAPITALIZACION,         REZO_RECIBIDAS,         REZO_ENTREGADAS,         PMNP,         PPU,         PUP,         CPP,         NULL AS PORC_VENTA_NIVEL_III,         NULL AS PORC_ACTIVAS_NIVEL_IV,         NULL AS PORC_VENTA_NIVEL_IV,         NULL AS PORC_ACTIVAS_NIVEL_EGRE,         NULL AS PORC_VENTA_NIVEL_EGRE,                               NULL AS PORC_ACTIVAS_NIVEL_REINGRE,           NULL AS PORC_VENTA_NIVEL_REINGRE   FROM     (       SELECT PAIS,         DES_REGI,         DES_ZONA,          SUM(VTA_NETA_ESTAD) VENTA_NETA_ESTAD,         SUM(N_PEDIDOS) N_PEDIDO,         DECODE(SUM(ACTI_FINALES), 0 , 0, (SUM(N_PEDIDOS)/SUM(ACTI_FINALES))*100) ACTIVIDAD,               SUM(ACTI_FINALES) ACTI_FINALES,            SUM(INGRESOS) INGRESOS,         SUM(REINGRESOS) REINGRESOS,         SUM(EGRESOS) EGRESOS,             SUM(INGRESOS) + SUM(REINGRESOS) - SUM(EGRESOS) CAPITALIZACION,         SUM(REZO_RECIBIDAS) REZO_RECIBIDAS,         SUM(REZO_ENTREGADAS) REZO_ENTREGADAS,                  DECODE(SUM(N_PEDIDOS), 0, 0, SUM(VTA_NETA_ESTAD)/SUM(N_PEDIDOS)) PMNP,         DECODE(SUM(UNIDADES_VENDIDAS), 0, 0, SUM(VTA_NETA_ESTAD)/SUM(UNIDADES_VENDIDAS)) PPU,                     DECODE(SUM(N_PEDIDOS), 0, 0, SUM(UNIDADES_VENDIDAS)/SUM(N_PEDIDOS)) PUP,            DECODE(SUM(N_PEDIDOS), 0, 0, SUM(N_CLIENTES)/SUM(N_PEDIDOS)) CPP     FROM         (        SELECT GEN_PAIS.VAL_I18N PAIS,          REG.OID_REGI,          REG.DES_REGI,          ZONA.OID_ZONA,          ZONA.DES_ZONA,          (          SELECT SUM(NVL(VR.NUM_ACTI_FINA, 0))          FROM INT_FUENT_VENTAS_REAL VR          WHERE VR.PERD_OID_PERI = PERI.OID_PERI             AND VR.ZZON_OID_ZONA = ZONA.OID_ZONA          AND VR.ZORG_OID_REGI = REG.OID_REGI            GROUP BY REG.OID_REGI,          ZONA.OID_ZONA          ) ACTI_FINALES,          (          SELECT SUM(NVL(VR.NUM_INGR, 0))          FROM INT_FUENT_VENTAS_REAL VR          WHERE VR.PERD_OID_PERI = PERI.OID_PERI             AND VR.ZZON_OID_ZONA = ZONA.OID_ZONA          AND VR.ZORG_OID_REGI = REG.OID_REGI          GROUP BY REG.OID_REGI,          ZONA.OID_ZONA          ) INGRESOS,             (          SELECT SUM(NVL(VR.NUM_EGRE, 0))          FROM INT_FUENT_VENTAS_REAL VR          WHERE VR.PERD_OID_PERI = PERI.OID_PERI             AND VR.ZZON_OID_ZONA = ZONA.OID_ZONA          AND VR.ZORG_OID_REGI = REG.OID_REGI          GROUP BY REG.OID_REGI,          ZONA.OID_ZONA          ) EGRESOS,          (          SELECT SUM(NVL(VR.NUM_REIN, 0))          FROM INT_FUENT_VENTAS_REAL VR          WHERE VR.PERD_OID_PERI = PERI.OID_PERI             AND VR.ZZON_OID_ZONA = ZONA.OID_ZONA          AND VR.ZORG_OID_REGI = REG.OID_REGI          GROUP BY REG.OID_REGI,          ZONA.OID_ZONA          ) REINGRESOS,          (          SELECT SUM(NVL(VR.NUM_REZO_RECI, 0))          FROM INT_FUENT_VENTAS_REAL VR          WHERE VR.PERD_OID_PERI = PERI.OID_PERI             AND VR.ZZON_OID_ZONA = ZONA.OID_ZONA          AND VR.ZORG_OID_REGI = REG.OID_REGI          GROUP BY REG.OID_REGI,          ZONA.OID_ZONA          ) REZO_RECIBIDAS,          (          SELECT SUM(NVL(VR.NUM_REZO_ENTR, 0))          FROM INT_FUENT_VENTAS_REAL VR          WHERE VR.PERD_OID_PERI = PERI.OID_PERI             AND VR.ZZON_OID_ZONA = ZONA.OID_ZONA          AND VR.ZORG_OID_REGI = REG.OID_REGI          GROUP BY REG.OID_REGI,          ZONA.OID_ZONA          ) REZO_ENTREGADAS,          (          SELECT SUM(NVL(VRA.IMP_VENT_NETA_ESTA, 0))          FROM INT_FUENT_VENTA_REAL_VACUM VRA          WHERE VRA.PERD_OID_PERI = PERI.OID_PERI             AND VRA.ZZON_OID_ZONA = ZONA.OID_ZONA          AND VRA.ZORG_OID_REGI = REG.OID_REGI          GROUP BY REG.OID_REGI,          ZONA.OID_ZONA          ) VTA_NETA_ESTAD,          (          SELECT SUM(NVL(VRA.NUM_PEDI, 0))          FROM INT_FUENT_VENTA_REAL_VACUM VRA          WHERE VRA.PERD_OID_PERI = PERI.OID_PERI             AND VRA.ZZON_OID_ZONA = ZONA.OID_ZONA          AND VRA.ZORG_OID_REGI = REG.OID_REGI          GROUP BY REG.OID_REGI,          ZONA.OID_ZONA          ) N_PEDIDOS,          (          SELECT SUM(NVL(VRA.NUM_UNID_VEND, 0))          FROM INT_FUENT_VENTA_REAL_VACUM VRA          WHERE VRA.PERD_OID_PERI = PERI.OID_PERI             AND VRA.ZZON_OID_ZONA = ZONA.OID_ZONA          AND VRA.ZORG_OID_REGI = REG.OID_REGI          GROUP BY REG.OID_REGI,          ZONA.OID_ZONA          ) UNIDADES_VENDIDAS,          (          SELECT SUM(NVL(VRA.NUM_CLIE, 0))          FROM INT_FUENT_VENTA_REAL_VACUM VRA          WHERE VRA.PERD_OID_PERI = PERI.OID_PERI             AND VRA.ZZON_OID_ZONA = ZONA.OID_ZONA          AND VRA.ZORG_OID_REGI = REG.OID_REGI          GROUP BY REG.OID_REGI,          ZONA.OID_ZONA           ) N_CLIENTES      FROM CRA_PERIO PERI,        ZON_ZONA ZONA,        ZON_REGIO REG,        (        SELECT FEC_INIC        FROM CRA_PERIO         WHERE OID_PERI = %value_PERIODODESDEVALUE%                ) FI,        (        SELECT FEC_FINA        FROM CRA_PERIO         WHERE OID_PERI = %value_PERIODOHASTAVALUE%                 ) FF,        (        SELECT GEN.VAL_OID, GEN.VAL_I18N        FROM V_GEN_I18N_SICC GEN        WHERE GEN.ATTR_ENTI = 'SEG_PAIS'           AND GEN.IDIO_OID_IDIO = %value_IDIOMAVALUE%            ) GEN_PAIS      WHERE PERI.FEC_INIC >= FI.FEC_INIC         AND PERI.FEC_FINA &lt;= FF.FEC_FINA         AND ZONA.ZORG_OID_REGI = REG.OID_REGI         AND REG.PAIS_OID_PAIS = %value_PAISVALUE%         AND PERI.PAIS_OID_PAIS = GEN_PAIS.VAL_OID(+)         AND PERI.PAIS_OID_PAIS = %value_PAISVALUE%          AND PERI.MARC_OID_MARC =  %value_MARCAVALUE%          AND PERI.CANA_OID_CANA =  %value_CANALVALUE%               %start_REGIONVALUE%   AND reg.oid_regi =  (%value_REGIONVALUE%)  %end_REGIONVALUE%              %start_ZONAVALUE%   AND zona.oid_zona =  (%value_ZONAVALUE%)  %end_ZONAVALUE%         )     GROUP BY PAIS,         DES_REGI,         DES_ZONA       )    )   UNION ALL    (          SELECT PAIS,            GRUPO,            DES_REGI,            DES_ZONA,            NIVEL_NUEVAS,             NIVEL_I,       NIVEL_II,            NIVEL_III,      NIVEL_IV,      NIVEL_EGRE,       NIVEL_REINGRE,      CANTIDAD_NIVEL_NUEVAS,      CANTIDAD_NIVEL_I,      CANTIDAD_NIVEL_II,      CANTIDAD_NIVEL_III,      CANTIDAD_NIVEL_IV,      CANTIDAD_NIVEL_EGRE,      CANTIDAD_NIVEL_REINGRE,      PORC_ACTIVAS_NIVEL_NUEVAS,      POR_VENTA_NIVEL_NUEVAS,             PORC_ACTIVAS_NIVEL_I,      POR_VENTA_NIVEL_I,      PORC_ACTIVAS_NIVEL_II,      POR_VENTA_NIVEL_II,      PORC_ACTIVAS_NIVEL_III,      POR_VENTA_NIVEL_III,      PORC_ACTIVAS_NIVEL_IV,      POR_VENTA_NIVEL_IV,      PORC_ACTIVAS_NIVEL_EGRE,      POR_VENTA_NIVEL_EGRE,      PORC_ACTIVAS_NIVEL_REINGRE,      POR_VENTA_NIVEL_REINGRE                       FROM        (       SELECT PAIS,              GRUPO,           DES_REGI,           DES_ZONA,           MAX(CANTIDAD_NIVEL_NUEVAS) CANTIDAD_NIVEL_NUEVAS,           MAX(PORC_ACTIVAS_NIVEL_NUEVAS) PORC_ACTIVAS_NIVEL_NUEVAS,           MAX(PORC_VENTA_NIVEL_NUEVAS) POR_VENTA_NIVEL_NUEVAS,           MAX(CANTIDAD_NIVEL_I) CANTIDAD_NIVEL_I,           MAX(PORC_ACTIVAS_NIVEL_I) PORC_ACTIVAS_NIVEL_I,           MAX(PORC_VENTA_NIVEL_I) POR_VENTA_NIVEL_I,           MAX(CANTIDAD_NIVEL_II) CANTIDAD_NIVEL_II,           MAX(PORC_ACTIVAS_NIVEL_II) PORC_ACTIVAS_NIVEL_II,           MAX(PORC_VENTA_NIVEL_II) POR_VENTA_NIVEL_II,           MAX(CANTIDAD_NIVEL_III) CANTIDAD_NIVEL_III,           MAX(PORC_ACTIVAS_NIVEL_III) PORC_ACTIVAS_NIVEL_III,           MAX(PORC_VENTA_NIVEL_III) POR_VENTA_NIVEL_III,           MAX(CANTIDAD_NIVEL_IV) CANTIDAD_NIVEL_IV,           MAX(PORC_ACTIVAS_NIVEL_IV) PORC_ACTIVAS_NIVEL_IV,           MAX(PORC_VENTA_NIVEL_IV) POR_VENTA_NIVEL_IV,           MAX(CANTIDAD_NIVEL_EGRE) CANTIDAD_NIVEL_EGRE,           MAX(PORC_ACTIVAS_NIVEL_EGRE) PORC_ACTIVAS_NIVEL_EGRE,           MAX(PORC_VENTA_NIVEL_EGRE) POR_VENTA_NIVEL_EGRE,           MAX(CANTIDAD_NIVEL_REINGRE) CANTIDAD_NIVEL_REINGRE,           MAX(PORC_ACTIVAS_NIVEL_REINGRE) PORC_ACTIVAS_NIVEL_REINGRE,           MAX(PORC_VENTA_NIVEL_REINGRE) POR_VENTA_NIVEL_REINGRE               FROM     (      SELECT NIV.VAL_I18N PAIS,               'B' AS GRUPO,                       NIV.DES_REGI,               NIV.DES_ZONA,            CASE WHEN (NIV.COD_NIVE_SEGM = 'N')THEN                    CANTIDAD            END CANTIDAD_NIVEL_NUEVAS,            CASE WHEN (NIV.COD_NIVE_SEGM = 'N')THEN                    DECODE(CANTIDAD_SUMA,0,0, (CANTIDAD/CANTIDAD_SUMA)*100)             END PORC_ACTIVAS_NIVEL_NUEVAS,            CASE WHEN (NIV.COD_NIVE_SEGM = 'N')THEN                   DECODE(VENTA_SUMA,0,0, (VENTA/VENTA_SUMA) *100)            END PORC_VENTA_NIVEL_NUEVAS,            CASE WHEN (NIV.COD_NIVE_SEGM = 'I')THEN                    CANTIDAD            END CANTIDAD_NIVEL_I,            CASE WHEN (NIV.COD_NIVE_SEGM = 'I')THEN                    DECODE(CANTIDAD_SUMA,0,0, (CANTIDAD/CANTIDAD_SUMA) *100)            END PORC_ACTIVAS_NIVEL_I,            CASE WHEN (NIV.COD_NIVE_SEGM = 'I')THEN                   DECODE(VENTA_SUMA,0,0, (VENTA/VENTA_SUMA) *100)            END PORC_VENTA_NIVEL_I,            CASE WHEN (NIV.COD_NIVE_SEGM = 'II')THEN                    CANTIDAD            END CANTIDAD_NIVEL_II,            CASE WHEN (NIV.COD_NIVE_SEGM = 'II')THEN                    DECODE(CANTIDAD_SUMA,0,0, (CANTIDAD/CANTIDAD_SUMA) *100)            END PORC_ACTIVAS_NIVEL_II,            CASE WHEN (NIV.COD_NIVE_SEGM = 'II')THEN                   DECODE(VENTA_SUMA,0,0, (VENTA/VENTA_SUMA)*100)            END PORC_VENTA_NIVEL_II,            CASE WHEN (NIV.COD_NIVE_SEGM = 'III')THEN                    CANTIDAD            END CANTIDAD_NIVEL_III,            CASE WHEN (NIV.COD_NIVE_SEGM = 'III')THEN                    DECODE(CANTIDAD_SUMA,0,0, (CANTIDAD/CANTIDAD_SUMA) *100)            END PORC_ACTIVAS_NIVEL_III,            CASE WHEN (NIV.COD_NIVE_SEGM = 'III')THEN                   DECODE(VENTA_SUMA,0,0, (VENTA/VENTA_SUMA) *100)            END PORC_VENTA_NIVEL_III,            CASE WHEN (NIV.COD_NIVE_SEGM = 'IV')THEN                    CANTIDAD            END CANTIDAD_NIVEL_IV,            CASE WHEN (NIV.COD_NIVE_SEGM = 'IV')THEN                    DECODE(CANTIDAD_SUMA,0,0, (CANTIDAD/CANTIDAD_SUMA) *100)            END PORC_ACTIVAS_NIVEL_IV,            CASE WHEN (NIV.COD_NIVE_SEGM = 'IV')THEN                   DECODE(VENTA_SUMA,0,0,( VENTA/VENTA_SUMA) *100)            END PORC_VENTA_NIVEL_IV,            CASE WHEN (NIV.COD_NIVE_SEGM = 'E')THEN                    CANTIDAD            END CANTIDAD_NIVEL_EGRE,            CASE WHEN (NIV.COD_NIVE_SEGM = 'E')THEN                    DECODE(CANTIDAD_SUMA,0,0, (CANTIDAD/CANTIDAD_SUMA)*100)             END PORC_ACTIVAS_NIVEL_EGRE,            CASE WHEN (NIV.COD_NIVE_SEGM = 'E')THEN                   DECODE(VENTA_SUMA,0,0, (VENTA/VENTA_SUMA)*100)             END PORC_VENTA_NIVEL_EGRE,            CASE WHEN (NIV.COD_NIVE_SEGM = 'R')THEN                    CANTIDAD            END CANTIDAD_NIVEL_REINGRE,            CASE WHEN (NIV.COD_NIVE_SEGM = 'R')THEN                    DECODE(CANTIDAD_SUMA,0,0, (CANTIDAD/CANTIDAD_SUMA)*100)             END PORC_ACTIVAS_NIVEL_REINGRE,            CASE WHEN (NIV.COD_NIVE_SEGM = 'R')THEN                   DECODE(VENTA_SUMA,0,0, (VENTA/VENTA_SUMA)*100)             END PORC_VENTA_NIVEL_REINGRE       FROM       (        SELECT   REG.OID_REGI,             ZON.OID_ZONA,             DNS.OID_NIVE_SEGM,                DNS.VAL_DESC,             COUNT(*) CANTIDAD,             SUM(DSC.VAL_VENT) VENTA,             SUM(COUNT(*)) OVER (PARTITION BY ZON.OID_ZONA) CANTIDAD_SUMA,             SUM(SUM(DSC.VAL_VENT)) OVER (PARTITION BY ZON.OID_ZONA) VENTA_SUMA             FROM DTR_NIVEL_SEGME DNS,              DTR_SEGME_CLIEN DSC,             (                SELECT FEC_INIC             FROM CRA_PERIO             WHERE OID_PERI = %value_PERIODODESDEVALUE%                  ) PER_INI,             (                SELECT FEC_FINA             FROM CRA_PERIO             WHERE OID_PERI = %value_PERIODOHASTAVALUE%                      ) PER_FIN,             CRA_PERIO PER,             ZON_ZONA ZON,             ZON_REGIO REG         WHERE DSC.NVSG_OID_NIVE_SEGM = DNS.OID_NIVE_SEGM              AND PER.OID_PERI = DSC.PERD_OID_PERI              AND  PER_INI.FEC_INIC &lt;= PER.FEC_INIC            AND PER_FIN.FEC_FINA >= PER.FEC_FINA            AND DSC.ZORG_OID_REGI = REG.OID_REGI            AND DSC.ZZON_OID_ZONA = ZON.OID_ZONA            AND REG.OID_REGI = ZON.ZORG_OID_REGI            AND ZON.OID_ZONA = DSC.ZZON_OID_ZONA            AND REG.PAIS_OID_PAIS = PER.PAIS_OID_PAIS            AND PER.PAIS_OID_PAIS = %value_PAISVALUE%            AND PER.MARC_OID_MARC =  %value_MARCAVALUE%            AND PER.CANA_OID_CANA = %value_CANALVALUE%        %start_REGIONVALUE%   AND reg.oid_regi =  (%value_REGIONVALUE%)  %end_REGIONVALUE%               %start_ZONAVALUE%   AND zon.oid_zona =  (%value_ZONAVALUE%)  %end_ZONAVALUE%         GROUP BY  REG.OID_REGI,               ZON.OID_ZONA,               DNS.OID_NIVE_SEGM,               DNS.VAL_DESC         ) DAT,       (           SELECT  *         FROM DTR_NIVEL_SEGME,               ZON_REGIO REG,              ZON_ZONA ZON,                 (            SELECT GEN.VAL_OID, GEN.VAL_I18N            FROM V_GEN_I18N_SICC GEN            WHERE GEN.ATTR_ENTI = 'SEG_PAIS'               AND GEN.IDIO_OID_IDIO = %value_IDIOMAVALUE%                ) GEN_PAIS             WHERE COD_NIVE_SEGM &lt;> 'F'                 AND REG.OID_REGI = ZON.ZORG_OID_REGI               AND REG.PAIS_OID_PAIS = GEN_PAIS.VAL_OID(+)               AND REG.PAIS_OID_PAIS =  %value_PAISVALUE%         %start_REGIONVALUE%   AND reg.oid_regi =  (%value_REGIONVALUE%)  %end_REGIONVALUE%                %start_ZONAVALUE%   AND zon.oid_zona =  (%value_ZONAVALUE%)  %end_ZONAVALUE%        ) NIV       WHERE  DAT.OID_NIVE_SEGM(+) = NIV.OID_NIVE_SEGM              AND NIV.OID_ZONA = DAT.OID_ZONA(+)           AND NIV.OID_REGI = DAT.OID_REGI(+)     )     GROUP BY PAIS,              GRUPO,           DES_REGI,           DES_ZONA       ) ,           (                 SELECT MAX(NIVEL_NUEVAS) NIVEL_NUEVAS,                 MAX(NIVEL_I) NIVEL_I,              MAX(NIVEL_II) NIVEL_II,              MAX(NIVEL_III) NIVEL_III,              MAX(NIVEL_IV) NIVEL_IV,              MAX(NIVEL_EGRE) NIVEL_EGRE,              MAX(NIVEL_REINGRE) NIVEL_REINGRE                  FROM          (           SELECT CASE WHEN (NIV.COD_NIVE_SEGM = 'N')THEN                    VAL_DESC                END NIVEL_NUEVAS,            CASE WHEN (NIV.COD_NIVE_SEGM = 'I')THEN                    VAL_DESC                END NIVEL_I,                CASE WHEN (NIV.COD_NIVE_SEGM = 'II')THEN                    VAL_DESC                END NIVEL_II,                CASE WHEN (NIV.COD_NIVE_SEGM = 'III')THEN                    VAL_DESC                END NIVEL_III,                CASE WHEN (NIV.COD_NIVE_SEGM = 'IV')THEN                    VAL_DESC                END NIVEL_IV,                CASE WHEN (NIV.COD_NIVE_SEGM = 'E')THEN                    VAL_DESC                END NIVEL_EGRE,                CASE WHEN (NIV.COD_NIVE_SEGM = 'R')THEN                    VAL_DESC                END NIVEL_REINGRE         FROM DTR_NIVEL_SEGME NIV         WHERE NIV.COD_NIVE_SEGM &lt;> 'F'         )     )   ) )   " ExternalClassName="oracle.jdbc.driver.OracleDriver" ExternalSourceData="" ExternalConnectionString="" ExternalConnectionClassName="oracle.jdbc.driver.OracleDriver" ExternalConnectionLocalUrl="jdbc:oracle:thin:@192.168.118.106:1523:SICCV3D" ExternalConnectionDistributedUrl="" ExternalConnectionUser="usu_peru" ExternalConnectionPassword="peru" DatePattern="" DateTimePattern=""/></DataSourceDefinitions><ParameterValues><ParameterValue FilterDefinitionName="IDIOMA" FilterParameter="VALUE" DefaultValue="1"/><ParameterValue FilterDefinitionName="PAIS" FilterParameter="VALUE" DefaultValue="1"/><ParameterValue FilterDefinitionName="CANAL" FilterParameter="VALUE" DefaultValue="1"/><ParameterValue FilterDefinitionName="MARCA" FilterParameter="VALUE" DefaultValue="1"/><ParameterValue FilterDefinitionName="PERIODODESDE" FilterParameter="VALUE" DefaultValue="55"/><ParameterValue FilterDefinitionName="PERIODOHASTA" FilterParameter="VALUE" DefaultValue="67"/><ParameterValue FilterDefinitionName="REGION" FilterParameter="VALUE" DefaultValue="NULL_VALUE"/><ParameterValue FilterDefinitionName="ZONA" FilterParameter="VALUE" DefaultValue="NULL_VALUE"/><ParameterValue FilterDefinitionName="ZONEUSER" FilterParameter="VALUE" DefaultValue="PEPRUEBAS"/></ParameterValues><Localizations/></ReportSourceDefinition>  

