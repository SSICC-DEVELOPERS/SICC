<?xml version="1.0" encoding="ISO-8859-1"?>  
<ReportSourceDefinition Id="RSD_REP-049" Cached="false" Expiration="0" IncrementalDimension="" Multilanguage="false" MaxRowsDimensionReference="" ><DimensionSourceDefinitions><DimensionSourceDefinition Name="PAIS" Description="PAIS" DataType="STRING" Calculated="false" Expression="" ExternalData="PAIS"/><DimensionSourceDefinition Name="PER_DESDE" Description="PER_DESDE" DataType="STRING" Calculated="false" Expression="" ExternalData="PER_DESDE"/><DimensionSourceDefinition Name="PER_HASTA" Description="PER_HASTA" DataType="STRING" Calculated="false" Expression="" ExternalData="PER_HASTA"/><DimensionSourceDefinition Name="VAL_NOMB_PERI" Description="VAL_NOMB_PERI" DataType="STRING" Calculated="false" Expression="" ExternalData="VAL_NOMB_PERI"/><DimensionSourceDefinition Name="DES_SUBG_VENT" Description="DES_SUBG_VENT" DataType="STRING" Calculated="false" Expression="" ExternalData="DES_SUBG_VENT"/><DimensionSourceDefinition Name="DES_REGI" Description="DES_REGI" DataType="STRING" Calculated="false" Expression="" ExternalData="DES_REGI"/><DimensionSourceDefinition Name="DES_ZONA" Description="DES_ZONA" DataType="STRING" Calculated="false" Expression="" ExternalData="DES_ZONA"/><DimensionSourceDefinition Name="COD_TERR" Description="COD_TERR" DataType="STRING" Calculated="false" Expression="" ExternalData="COD_TERR"/><DimensionSourceDefinition Name="COD_CLIE" Description="COD_CLIE" DataType="STRING" Calculated="false" Expression="" ExternalData="COD_CLIE"/><DimensionSourceDefinition Name="APYNO" Description="APYNO" DataType="STRING" Calculated="false" Expression="" ExternalData="APYNO"/><DimensionSourceDefinition Name="NUM_CONC" Description="NUM_CONC" DataType="STRING" Calculated="false" Expression="" ExternalData="NUM_CONC"/><DimensionSourceDefinition Name="NUM_NIVE" Description="NUM_NIVE" DataType="STRING" Calculated="false" Expression="" ExternalData="NUM_NIVE"/><DimensionSourceDefinition Name="DESCRIPCION" Description="DESCRIPCION" DataType="STRING" Calculated="false" Expression="" ExternalData="DESCRIPCION"/><DimensionSourceDefinition Name="TC_TERR" Description="TC_TERR" DataType="STRING" Calculated="false" Expression="" ExternalData="TC_TERR"/><DimensionSourceDefinition Name="TC_ZONA" Description="TC_ZONA" DataType="STRING" Calculated="false" Expression="" ExternalData="TC_ZONA"/><DimensionSourceDefinition Name="TC_REGION" Description="TC_REGION" DataType="STRING" Calculated="false" Expression="" ExternalData="TC_REGION"/></DimensionSourceDefinitions><MetricSourceDefinitions><MetricSourceDefinition Name="DISPONIBLES" Description="DISPONIBLES" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="DISPONIBLES" ExternalCalculated="false"/><MetricSourceDefinition Name="CANJEADOS" Description="CANJEADOS" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="CANJEADOS" ExternalCalculated="false"/><MetricSourceDefinition Name="ACUMULADO_NO_CANJEADOS" Description="ACUMULADO_NO_CANJEADOS" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="ACUMULADO_NO_CANJEADOS" ExternalCalculated="false"/><MetricSourceDefinition Name="CANJEADOS_SIN_DISPONIBLES" Description="CANJEADOS_SIN_DISPONIBLES" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="CANJEADOS_SIN_DISPONIBLES" ExternalCalculated="false"/><MetricSourceDefinition Name="CANJEADOS_CON_DISPONIBLES" Description="CANJEADOS_CON_DISPONIBLES" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="CANJEADOS_CON_DISPONIBLES" ExternalCalculated="false"/></MetricSourceDefinitions><FilterDefinitions><FilterDefinition Name="IDIOMA" DataType="INTEGER" FilterType="EQUALTO" Visual="false"/><FilterDefinition Name="PAIS" DataType="INTEGER" FilterType="IN" Visual="false"/><FilterDefinition Name="SUBGERENCIAVENTA" DataType="INTEGER" FilterType="IN" Visual="false"/><FilterDefinition Name="REGION" DataType="INTEGER" FilterType="IN" Visual="false"/><FilterDefinition Name="ZONA" DataType="INTEGER" FilterType="IN" Visual="false"/><FilterDefinition Name="TERRITORIO" DataType="INTEGER" FilterType="IN" Visual="false"/><FilterDefinition Name="NUMEROCONCURSO" DataType="INTEGER" FilterType="IN" Visual="false"/></FilterDefinitions><DataSourceDefinitions><DataSourceDefinition Name="REP-049" SourceType="SQL" Expression=" select pais, per_desde, per_hasta, val_nomb_peri,  des_subg_vent, des_regi,        des_zona, cod_terr, cod_clie, apyno, num_conc, num_nive,        descripcion,        tc_terr,        tc_zona,        tc_region,        disponibles,        canjeados,        case when (control = 1) then         acumulado_no_canjeados     else         0     end acumulado_no_canjeados,        case when (control = 1) then           canjeados_sin_disponibles     else          0     end canjeados_sin_disponibles,     case when (control = 1) then           canjeados_con_disponibles     else          0     end canjeados_con_disponibles from ( SELECT PAIS,     PER_DESDE,     PER_HASTA,val_nomb_peri, des_subg_vent, des_regi,        des_zona, cod_terr, cod_clie, apyno, num_conc, num_nive,        descripcion,        tc_terr,        tc_zona,        tc_region,        disponibles,        canjeados,        acumulado_no_canjeados,        canjeados_sin_disponibles,        canjeados_con_disponibles,     sum(1) over (partition by num_conc, cod_clie order by rownum) control FROM (   select PAIS,     per_desde,     per_hasta,     val_nomb_peri,     DES_SUBG_VENT,     DES_REGI,     DES_ZONA,     COD_TERR,     COD_CLIE,     apyno,     NUM_CONC,     NUM_NIVE,     DESCRIPCION,     COUNT(DISTINCT COD_CLIE) OVER (PARTITION BY PAIS,PER_DESDE,PER_HASTA,DES_SUBG_VENT, DES_REGI,DES_ZONA, COD_TERR) TC_TERR,        COUNT(DISTINCT COD_CLIE) OVER (PARTITION BY PAIS,PER_DESDE,PER_HASTA,DES_SUBG_VENT, DES_REGI,DES_ZONA) TC_ZONA,        COUNT(DISTINCT COD_CLIE) OVER (PARTITION BY PAIS,PER_DESDE,PER_HASTA,DES_SUBG_VENT, DES_REGI) TC_REGION,     sum(abono + cargo + canje)  as disponibles,     sum(canje)*(-1) as canjeados,        case when sum(canje) = 0 and sum(abono + cargo + canje) &lt;> 0 then 1 end as acumulado_no_canjeados,     case when sum(canje) &lt;> 0 and sum(abono + cargo + canje) = 0 then 1 end as canjeados_sin_disponibles,     case when sum(canje) &lt;> 0 and sum(abono + cargo + canje) &lt;> 0 then 1 end as canjeados_con_disponibles from (  select paises.PAIS,       per2.val_nomb_peri as per_desde,      per3.val_nomb_peri as per_hasta,      per.val_nomb_peri,      subg.DES_SUBG_VENT,      reg.DES_REGI,      zon.DES_ZONA,      ter.COD_TERR,      cli.COD_CLIE,      cli.VAL_NOM1||' '||cli.VAL_APE1 as apyno,      par_gen.NUM_CONC,      niv_pre.NUM_NIVE,      PQ_APL_REP.FN_049_CONCAT_PREMIO(niv_pre.oid_para_nive_prem, 1) descripcion,      decode(cc_pun.TMOV_OID_TIPO_MOVI,1,sum(cc_pun.NUM_PUNT),0) as abono,      case          when cc_pun.TMOV_OID_TIPO_MOVI = 2 and (par_gen.IND_ANUL = 1 or par_gen.IND_DEVO = 1) then         sum(cc_pun.NUM_PUNT)       else 0      end as cargo,      case          when cc_pun.TMOV_OID_TIPO_MOVI = 3 then         sum(cc_pun.NUM_PUNT)        else 0      end as canje  from   inc_concu_param_gener par_gen,   inc_cuent_corri_punto cc_pun,   inc_premi_elegi pre_el,   mae_clien cli,   zon_zona zon,   zon_regio reg,   zon_secci sec,   zon_terri_admin ter_adm,   zon_sub_geren_venta subg,   zon_terri ter,   cra_perio per,   cra_perio per2,   cra_perio per3,   inc_param_nivel_premi niv_pre,   inc_param_gener_premi par_pre,   mae_clien_unida_admin un_adm,   (     select gen.VAL_OID, gen.val_i18n PAIS     from v_gen_i18n_sicc gen     where gen.ATTR_ENTI = 'SEG_PAIS'     and idio_oid_idio = %value_IDIOMAVALUE%     and gen.VAL_OID in (%value_PAISVALUES%)    )paises  where    par_gen.IND_ACTI = 1    and par_gen.OID_PARA_GRAL = cc_pun.COPA_OID_PARA_GRAL    and cc_pun.CLIE_OID_CLIE = cli.oid_clie    and cc_pun.clie_oid_clie = un_adm.clie_oid_clie    and un_adm.IND_ACTI = 1    and un_adm.ZTAD_OID_TERR_ADMI = ter_adm.OID_TERR_ADMI    and par_gen.PERD_OID_PERI_DESD = per2.oid_peri    and par_gen.PERD_OID_PERI_HAST = per3.oid_peri    and ter_adm.ZSCC_OID_SECC = sec.OID_SECC    and sec.ZZON_OID_ZONA = zon.OID_ZONA    and zon.ZORG_OID_REGI = reg.oid_regi    and reg.ZSGV_OID_SUBG_VENT = subg.OID_SUBG_VENT    and ter_adm.TERR_OID_TERR = ter.OID_TERR    and cc_pun.PERD_OID_PERI = per.oid_peri    and pre_el.COPA_OID_PARA_GRAL = par_gen.OID_PARA_GRAL    and pre_el.CLIE_OID_CLIE = cli.OID_CLIE      and par_pre.COPA_OID_PARA_GRAL = par_gen.oid_para_gral     and par_pre.OID_PARA_GENE_PREM = niv_pre.PAGP_OID_PARA_GENE_PREM    and pre_el.PANP_OID_PARA_NIVE_PREM = niv_pre.OID_PARA_NIVE_PREM          and subg.OID_SUBG_VENT in (%value_SUBGERENCIAVENTAVALUES%)    and reg.OID_REGI in (%value_REGIONVALUES%)     %start_ZONAVALUES% and zon.OID_ZONA in (%value_ZONAVALUES%) %end_ZONAVALUES%    %start_TERRITORIOVALUES% and ter_adm.TERR_OID_TERR in (%value_TERRITORIOVALUES%) %end_TERRITORIOVALUES%    and par_gen.oid_para_gral in (%value_NUMEROCONCURSOVALUES%)    and par_gen.pais_oid_pais in (%value_PAISVALUES%)    and par_gen.pais_oid_pais = paises.VAL_OID (+)  group by       paises.PAIS,      per.val_nomb_peri,      subg.DES_SUBG_VENT,      reg.DES_REGI,      zon.DES_ZONA,      ter.COD_TERR,      cli.COD_CLIE,      cli.VAL_NOM1||' '||cli.VAL_APE1,      par_gen.NUM_CONC,      cc_pun.TMOV_OID_TIPO_MOVI,      par_gen.IND_ANUL,      par_gen.IND_DEVO,      niv_pre.NUM_NIVE,         niv_pre.oid_para_nive_prem,         per2.val_nomb_peri,      per3.val_nomb_peri ) group by    PAIS,    per_desde,     per_hasta,     val_nomb_peri,     DES_SUBG_VENT,     DES_REGI,     DES_ZONA,     COD_TERR,     COD_CLIE,     apyno,     NUM_CONC,     NUM_NIVE,     DESCRIPCION))" ExternalClassName="oracle.jdbc.driver.OracleDriver" ExternalSourceData="" ExternalConnectionString="" ExternalConnectionClassName="oracle.jdbc.driver.OracleDriver" ExternalConnectionLocalUrl="jdbc:oracle:thin:@192.168.118.106:1523:SICCV3D" ExternalConnectionDistributedUrl="" ExternalConnectionUser="own_peru" ExternalConnectionPassword="peru_own" DatePattern="" DateTimePattern=""/></DataSourceDefinitions><ParameterValues><ParameterValue FilterDefinitionName="IDIOMA" FilterParameter="VALUE" DefaultValue="1"/><ParameterValue FilterDefinitionName="PAIS" FilterParameter="VALUES" DefaultValue="1,2,3,4,5,6,7,8,9,10,11"/><ParameterValue FilterDefinitionName="SUBGERENCIAVENTA" FilterParameter="VALUES" DefaultValue="1,2,3,4,5,6,7,8,9,10,11"/><ParameterValue FilterDefinitionName="REGION" FilterParameter="VALUES" DefaultValue="1,2,3,4,5,6,7,8,9,10,11"/><ParameterValue FilterDefinitionName="ZONA" FilterParameter="VALUES" DefaultValue="NULL_VALUE"/><ParameterValue FilterDefinitionName="TERRITORIO" FilterParameter="VALUES" DefaultValue="NULL_VALUE"/><ParameterValue FilterDefinitionName="NUMEROCONCURSO" FilterParameter="VALUES" DefaultValue="1','2','3','4','05/002','6"/></ParameterValues></ReportSourceDefinition>  

