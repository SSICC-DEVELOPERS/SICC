<?xml version="1.0" encoding="ISO-8859-1"?>  
<ReportSourceDefinition Id="RSD_REP-031_03" Cached="false" Expiration="0" IncrementalDimension="" Multilanguage="false" MaxRowsDimensionReference="" ><DimensionSourceDefinitions><DimensionSourceDefinition Name="PAIS" Description="PAIS" DataType="STRING" Calculated="false" Expression="" ExternalData="PAIS"/><DimensionSourceDefinition Name="MARCA" Description="MARCA" DataType="STRING" Calculated="false" Expression="" ExternalData="MARCA"/><DimensionSourceDefinition Name="CANAL" Description="CANAL" DataType="STRING" Calculated="false" Expression="" ExternalData="CANAL"/><DimensionSourceDefinition Name="VAL_NOMB_PERI" Description="VAL_NOMB_PERI" DataType="STRING" Calculated="false" Expression="" ExternalData="VAL_NOMB_PERI"/><DimensionSourceDefinition Name="OID_DETA_MAV" Description="OID_DETA_MAV" DataType="STRING" Calculated="false" Expression="" ExternalData="OID_DETA_MAV"/><DimensionSourceDefinition Name="ACTIV" Description="ACTIV" DataType="STRING" Calculated="false" Expression="" ExternalData="ACTIV"/><DimensionSourceDefinition Name="VAL_CODI_VENT" Description="VAL_CODI_VENT" DataType="STRING" Calculated="false" Expression="" ExternalData="VAL_CODI_VENT"/><DimensionSourceDefinition Name="COD_SAP" Description="COD_SAP" DataType="STRING" Calculated="false" Expression="" ExternalData="COD_SAP"/><DimensionSourceDefinition Name="DESC_PROD" Description="DESC_PROD" DataType="STRING" Calculated="false" Expression="" ExternalData="DESC_PROD"/><DimensionSourceDefinition Name="COD_CICL_VIDA" Description="COD_CICL_VIDA" DataType="STRING" Calculated="false" Expression="" ExternalData="COD_CICL_VIDA"/><DimensionSourceDefinition Name="COD_TIPO_OFER" Description="COD_TIPO_OFER" DataType="STRING" Calculated="false" Expression="" ExternalData="COD_TIPO_OFER"/><DimensionSourceDefinition Name="DESC_TIPO_CLIEN" Description="DESC_TIPO_CLIEN" DataType="STRING" Calculated="false" Expression="" ExternalData="DESC_TIPO_CLIEN"/><DimensionSourceDefinition Name="SUB_TIPO_CLIEN" Description="SUB_TIPO_CLIEN" DataType="STRING" Calculated="false" Expression="" ExternalData="SUB_TIPO_CLIEN"/><DimensionSourceDefinition Name="TIPO_CLASI_CLIEN" Description="TIPO_CLASI_CLIEN" DataType="STRING" Calculated="false" Expression="" ExternalData="TIPO_CLASI_CLIEN"/><DimensionSourceDefinition Name="CLASI_CLIEN" Description="CLASI_CLIEN" DataType="STRING" Calculated="false" Expression="" ExternalData="CLASI_CLIEN"/><DimensionSourceDefinition Name="COD_REGI" Description="COD_REGI" DataType="STRING" Calculated="false" Expression="" ExternalData="COD_REGI"/><DimensionSourceDefinition Name="COD_ZONA" Description="COD_ZONA" DataType="STRING" Calculated="false" Expression="" ExternalData="COD_ZONA"/><DimensionSourceDefinition Name="DES_TIPO_DESP" Description="DES_TIPO_DESP" DataType="STRING" Calculated="false" Expression="" ExternalData="DES_TIPO_DESP"/><DimensionSourceDefinition Name="DES_SUBC" Description="DES_SUBC" DataType="STRING" Calculated="false" Expression="" ExternalData="DES_SUBC"/><DimensionSourceDefinition Name="VAL_CRIT" Description="VAL_CRIT" DataType="STRING" Calculated="false" Expression="" ExternalData="VAL_CRIT"/></DimensionSourceDefinitions><MetricSourceDefinitions><MetricSourceDefinition Name="IMP_PREC_CATA" Description="IMP_PREC_CATA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="IMP_PREC_CATA" ExternalCalculated="false"/><MetricSourceDefinition Name="IMP_PREC_POSI" Description="IMP_PREC_POSI" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="IMP_PREC_POSI" ExternalCalculated="false"/><MetricSourceDefinition Name="CANTIDAD_ESTIMADA" Description="CANTIDAD_ESTIMADA" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="CANTIDAD_ESTIMADA" ExternalCalculated="false"/><MetricSourceDefinition Name="TOTAL_DESPACHADO" Description="TOTAL_DESPACHADO" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="TOTAL_DESPACHADO" ExternalCalculated="false"/><MetricSourceDefinition Name="TOTAL_A_ENVIAR" Description="TOTAL_A_ENVIAR" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="TOTAL_A_ENVIAR" ExternalCalculated="false"/><MetricSourceDefinition Name="UN_ESTIM" Description="UN_ESTIM" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="UN_ESTIM" ExternalCalculated="false"/><MetricSourceDefinition Name="UN_PEND_ENVIO" Description="UN_PEND_ENVIO" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="UN_PEND_ENVIO" ExternalCalculated="false"/><MetricSourceDefinition Name="UN_DISTRIBUIDAS" Description="UN_DISTRIBUIDAS" AggregateType="SUM" GroupFooterType="NONE" Calculated="false" AggregateFunction="" GroupFooterFunction="" ExternalData="UN_DISTRIBUIDAS" ExternalCalculated="false"/></MetricSourceDefinitions><FilterDefinitions><FilterDefinition Name="IDIOMA" DataType="INTEGER" FilterType="EQUALTO" Visual="false"/><FilterDefinition Name="PAIS" DataType="INTEGER" FilterType="EQUALTO" Visual="false"/><FilterDefinition Name="MARCA" DataType="INTEGER" FilterType="EQUALTO" Visual="false"/><FilterDefinition Name="CANAL" DataType="INTEGER" FilterType="EQUALTO" Visual="false"/><FilterDefinition Name="PERIODO" DataType="INTEGER" FilterType="EQUALTO" Visual="false"/><FilterDefinition Name="CODIGOPRODUCTODESDE" DataType="STRING" FilterType="EQUALTO" Visual="false"/><FilterDefinition Name="CODIGOPRODUCTOHASTA" DataType="STRING" FilterType="EQUALTO" Visual="false"/><FilterDefinition Name="CODIGOVENTADESDE" DataType="STRING" FilterType="EQUALTO" Visual="false"/><FilterDefinition Name="CODIGOVENTAHASTA" DataType="STRING" FilterType="EQUALTO" Visual="false"/><FilterDefinition Name="ACTIVIDAD" DataType="INTEGER" FilterType="IN" Visual="false"/><FilterDefinition Name="OPERADORPRECIOCATALOGO" DataType="STRING" FilterType="EQUALTO" Visual="false"/><FilterDefinition Name="PRECIOCATALOGO" DataType="FLOAT" FilterType="EQUALTO" Visual="false"/><FilterDefinition Name="OPERADORPRECIOCONTABLE" DataType="STRING" FilterType="EQUALTO" Visual="false"/><FilterDefinition Name="PRECIOCONTABLE" DataType="FLOAT" FilterType="EQUALTO" Visual="false"/><FilterDefinition Name="OPERADORCANTIDADESTIMADA" DataType="STRING" FilterType="EQUALTO" Visual="false"/><FilterDefinition Name="CANTIDADESTIMADA" DataType="FLOAT" FilterType="EQUALTO" Visual="false"/><FilterDefinition Name="TIPOCLIENTE" DataType="INTEGER" FilterType="IN" Visual="false"/><FilterDefinition Name="CICLOVIDA" DataType="INTEGER" FilterType="IN" Visual="false"/><FilterDefinition Name="TIPOOFERTA" DataType="INTEGER" FilterType="IN" Visual="false"/></FilterDefinitions><DataSourceDefinitions><DataSourceDefinition Name="REP-031" SourceType="SQL" Expression="SELECT pq_apl_aux.valor_gen_i18n_sicc (%value_IDIOMAVALUE%, peri.pais_oid_pais, 'SEG_PAIS') AS PAIS,        marc.des_marc AS MARCA,        pq_apl_aux.valor_gen_i18n_sicc (%value_IDIOMAVALUE%, peri.cana_oid_cana, 'SEG_CANAL') AS CANAL,        peri.val_nomb_peri AS VAL_NOMB_PERI,        pq_apl_aux.valor_gen_i18n_sicc (%value_IDIOMAVALUE%, base.acti_oid_acti, 'MAV_ACTIV') AS ACTIV,        ofde.val_codi_vent AS VAL_CODI_VENT,         prod.cod_sap AS COD_SAP,        pq_apl_aux.valor_gen_i18n_sicc (%value_IDIOMAVALUE%, base.prod_oid_prod, 'MAE_PRODU') AS DESC_PROD,        TO_CHAR(base.oid_deta_mav) AS OID_DETA_MAV,        civi.cod_cicl_vida || ' - ' || pq_apl_aux.valor_gen_i18n_sicc (%value_IDIOMAVALUE%, civi.OID_CICL_VIDA, 'PRE_CICLO_VIDA') ||         ' / ' || pq_apl_aux.valor_gen_i18n_sicc (%value_IDIOMAVALUE%, tofe.OID_TIPO_OFER, 'PRE_TIPO_OFERT') AS COD_CICL_VIDA,        tofe.cod_tipo_ofer AS COD_TIPO_OFER,        pq_apl_aux.valor_gen_i18n_sicc (%value_IDIOMAVALUE%, base.ticl_oid_tipo_clie, 'MAE_TIPO_CLIEN') AS DESC_TIPO_CLIEN,        pq_apl_aux.valor_gen_i18n_sicc (%value_IDIOMAVALUE%, base.sbti_oid_subt_clie, 'MAE_SUBTI_CLIEN') AS SUB_TIPO_CLIEN,        pq_apl_aux.valor_gen_i18n_sicc (%value_IDIOMAVALUE%, base.tccl_oid_tipo_clas, 'MAE_TIPO_CLASI_CLIEN') AS TIPO_CLASI_CLIEN,        pq_apl_aux.valor_gen_i18n_sicc (%value_IDIOMAVALUE%, base.clas_oid_clas, 'MAE_CLASI') AS CLASI_CLIEN,        (SELECT zreg.des_regi           FROM zon_regio zreg          WHERE zreg.oid_regi = base.zorg_oid_regi) AS COD_REGI,        (SELECT zzon.des_zona           FROM zon_zona zzon          WHERE zzon.oid_zona = base.zzon_oid_zona) AS COD_ZONA,        (SELECT tdes.des_tipo_desp           FROM mav_activ_tipo_despa atde,                mav_tipo_despa tdes          WHERE atde.oid_acti_tipo_desp = base.atde_oid_acti_tipo_desp            AND atde.tdch_oid_tipo_desp = tdes.oid_tipo_desp) AS DES_TIPO_DESP,        (SELECT scri.des_subc           FROM mav_subcr_asign scri          WHERE scri.oid_subc = base.scas_oid_subc) AS DES_SUBC,         base.val_crit AS VAL_CRIT,        ofde.imp_prec_cata AS IMP_PREC_CATA,         ofde.imp_prec_posi AS IMP_PREC_POSI,         (base.tot_clientes * base.num_unid_clie) AS CANTIDAD_ESTIMADA,        (base.cnt_clientes * base.num_unid_clie) AS TOTAL_A_ENVIAR,         base.un_estim AS UN_ESTIM,         (base.cnt_clientes * base.num_unid_clie) - base.cnt_despachado AS UN_PEND_ENVIO,        base.cnt_despachado AS UN_DISTRIBUIDAS,        base.tot_despachado AS TOTAL_DESPACHADO FROM   ( SELECT det.oid_deta_mav, scr.cras_oid_crit_asig, det.scas_oid_subc,        (SELECT env.mafa_oid_matr_fact           FROM mav_envio env          WHERE env.denv_oid_deta_mav = det.oid_deta_mav            AND ROWNUM = 1) mafa_oid_matr_fact,        detua.zsgv_oid_subg_vent, detua.zorg_oid_regi, detua.zzon_oid_zona,        det.ticl_oid_tipo_clie, detst.sbti_oid_subt_clie,        det.tccl_oid_tipo_clas, det.clas_oid_clas,        det.acti_oid_acti,        det.prod_oid_prod,        det.tofe_oid_tipo_ofer,        det.civi_oid_cicl_vida,        det.atde_oid_acti_tipo_desp,        NVL(det.num_unid_clie,0) num_unid_clie,        NVL ((  det.val_base_esti_dest * det.val_fact_corr * det.num_unid_esti),0) AS un_estim,        (CASE            WHEN (det.scas_oid_subc = 3)               THEN TO_CHAR (det.num_aniv)            WHEN (det.scas_oid_subc = 4)               THEN TO_CHAR (   det.val_edad_desd || ' - ' || det.val_edad_hast)            WHEN (det.scas_oid_subc IN (5,6,7,8,9))               THEN TO_CHAR (det.val_mont)            ELSE ''         END        ) AS val_crit,        (SELECT COUNT (oid_clie)           FROM mae_clien clie          WHERE EXISTS (                   SELECT 1                     FROM mae_clien_unida_admin uadm,                          zon_terri_admin tad,                          zon_secci sec,                          zon_zona zon,                          zon_regio reg                    WHERE uadm.clie_oid_clie = clie.oid_clie                      AND uadm.ind_acti = 1                      AND uadm.ztad_oid_terr_admi = tad.oid_terr_admi                      AND tad.zscc_oid_secc = sec.oid_secc                      AND sec.zzon_oid_zona = zon.oid_zona                      AND zon.zorg_oid_regi = reg.oid_regi                      AND NVL (detua.zsgv_oid_subg_vent, reg.zsgv_oid_subg_vent) = reg.zsgv_oid_subg_vent                      AND NVL (detua.zorg_oid_regi, zon.zorg_oid_regi) = zon.zorg_oid_regi                      AND NVL (detua.zzon_oid_zona, sec.zzon_oid_zona) = sec.zzon_oid_zona)            AND (   (    (   det.ticl_oid_tipo_clie IS NOT NULL                          OR detst.sbti_oid_subt_clie IS NOT NULL                         )                     AND EXISTS (                            SELECT 1                              FROM mae_clien_tipo_subti tsub                             WHERE tsub.clie_oid_clie = clie.oid_clie                               AND NVL (det.ticl_oid_tipo_clie, tsub.ticl_oid_tipo_clie) = tsub.ticl_oid_tipo_clie                               AND NVL (detst.sbti_oid_subt_clie, tsub.sbti_oid_subt_clie) = tsub.sbti_oid_subt_clie                               AND (   (    (   det.tccl_oid_tipo_clas IS NOT NULL                                             OR det.clas_oid_clas IS NOT NULL                                            )                                        AND EXISTS (                                               SELECT 1                                                 FROM mae_clien_clasi clas                                                WHERE clas.ctsu_oid_clie_tipo_subt = tsub.oid_clie_tipo_subt                                                  AND NVL(det.tccl_oid_tipo_clas, clas.tccl_oid_tipo_clasi) = clas.tccl_oid_tipo_clasi                                                  AND NVL (det.clas_oid_clas, clas.clas_oid_clas) = clas.clas_oid_clas)                                       )                                    OR det.tccl_oid_tipo_clas IS NULL                                   ))                    )                 OR det.ticl_oid_tipo_clie IS NULL                )            AND (   det.scas_oid_subc = 1                 OR (    det.scas_oid_subc = 2                     AND EXISTS (                            SELECT 1                              FROM mae_clien_datos_adici adic                             WHERE adic.clie_oid_clie = clie.oid_clie                               AND adic.fec_naci IS NOT NULL                               AND TO_DATE                                      (   CASE                                             WHEN TO_CHAR (adic.fec_naci, 'DD/MM/') = '29/02/'                                                THEN '28/02/'                                             ELSE TO_CHAR (adic.fec_naci, 'DD/MM/')                                          END                                       || CASE                                             WHEN TO_CHAR (per.fec_inic, 'yyyy') &lt; TO_CHAR (per.fec_fina,'yyyy')                                                THEN TO_CHAR (per.fec_inic,'YYYY')                                             ELSE TO_CHAR (per.fec_fina,'yyyy')                                          END,                                       'dd/mm/yyyy'                                      ) BETWEEN per.fec_inic AND per.fec_fina)                    )                 OR (    det.scas_oid_subc = 3                     AND TRUNC (  MONTHS_BETWEEN (per.fec_fina, clie.fec_ingr) / 12) = det.num_aniv                    )                 OR (    det.scas_oid_subc = 4                     AND EXISTS (                            SELECT 1                              FROM mae_clien_datos_adici adic                             WHERE adic.clie_oid_clie = clie.oid_clie                               AND adic.fec_naci IS NOT NULL                               AND TRUNC (  MONTHS_BETWEEN (per.fec_fina, adic.fec_naci) / 12) BETWEEN det.val_edad_desd AND det.val_edad_hast)                    )                 OR (    det.scas_oid_subc = 5                     AND (SELECT NVL (SUM (ped.val_prec_cata_tota_loc_uni_dem), 0)                            FROM ped_solic_cabec ped                           WHERE ped.perd_oid_peri = pant.oid_peri                             AND ped.clie_oid_clie = clie.oid_clie) > det.val_mont                    )                 OR (    det.scas_oid_subc = 6                     AND (SELECT NVL (SUM (pos.val_prec_cata_tota_loca_unid), 0)                            FROM ped_solic_cabec ped,                                 ped_solic_posic pos,                                 mae_produ prd                           WHERE ped.oid_soli_cabe = pos.soca_oid_soli_cabe                             AND pos.prod_oid_prod = prd.oid_prod                             AND prd.mapr_oid_marc_prod = per.marc_oid_marc                             AND ped.perd_oid_peri = per.oid_peri                             AND ped.clie_oid_clie = clie.oid_clie) > det.val_mont                    )                 OR (    det.scas_oid_subc = 7                     AND (SELECT NVL (SUM (pos.val_prec_cata_tota_loca_unid), 0)                            FROM ped_solic_cabec ped,                                 ped_solic_posic pos,                                 mae_produ prd                           WHERE ped.oid_soli_cabe = pos.soca_oid_soli_cabe                             AND pos.prod_oid_prod = prd.oid_prod                             AND prd.uneg_oid_unid_nego = det.uneg_oid_unid_nego                             AND ped.perd_oid_peri = per.oid_peri                             AND ped.clie_oid_clie = clie.oid_clie) > det.val_mont                    )                )) cnt_clientes,                (SELECT NVL(SUM(NUM_UNID),0)                    FROM MAV_ENVIO env                   WHERE env.DENV_OID_DETA_MAV = det.OID_DETA_MAV                    AND env.IND_ENVI = 'E'                    AND EXISTS (                             SELECT 1                               FROM mae_clien clie                              WHERE EXISTS (                                       SELECT 1                                         FROM mae_clien_unida_admin uadm,                                              zon_terri_admin tad,                                              zon_secci sec,                                              zon_zona zon,                                              zon_regio reg                                        WHERE uadm.clie_oid_clie = env.clie_oid_clie                                          AND uadm.ind_acti = 1                                          AND uadm.ztad_oid_terr_admi = tad.oid_terr_admi                                          AND tad.zscc_oid_secc = sec.oid_secc                                          AND sec.zzon_oid_zona = zon.oid_zona                                          AND zon.zorg_oid_regi = reg.oid_regi                                          AND NVL (detua.zsgv_oid_subg_vent, reg.zsgv_oid_subg_vent) = reg.zsgv_oid_subg_vent                                          AND NVL (detua.zorg_oid_regi, zon.zorg_oid_regi) = zon.zorg_oid_regi                                          AND NVL (detua.zzon_oid_zona, sec.zzon_oid_zona) = sec.zzon_oid_zona)                                AND (   (    (   det.ticl_oid_tipo_clie IS NOT NULL                                              OR detst.sbti_oid_subt_clie IS NOT NULL                                             )                                         AND EXISTS (                                                SELECT 1                                                  FROM mae_clien_tipo_subti tsub                                                 WHERE tsub.clie_oid_clie = env.clie_oid_clie                                                   AND NVL (det.ticl_oid_tipo_clie, tsub.ticl_oid_tipo_clie) = tsub.ticl_oid_tipo_clie                                                   AND NVL (detst.sbti_oid_subt_clie, tsub.sbti_oid_subt_clie) = tsub.sbti_oid_subt_clie                                                   AND (   (    (   det.tccl_oid_tipo_clas IS NOT NULL                                                                 OR det.clas_oid_clas IS NOT NULL                                                                )                                                            AND EXISTS (                                                                   SELECT 1                                                                     FROM mae_clien_clasi clas                                                                    WHERE clas.ctsu_oid_clie_tipo_subt = tsub.oid_clie_tipo_subt                                                                      AND NVL(det.tccl_oid_tipo_clas, clas.tccl_oid_tipo_clasi) = clas.tccl_oid_tipo_clasi                                                                      AND NVL (det.clas_oid_clas, clas.clas_oid_clas) = clas.clas_oid_clas)                                                           )                                                        OR det.tccl_oid_tipo_clas IS NULL                                                       ))                                        )                                     OR det.ticl_oid_tipo_clie IS NULL                                    )                        )                ) cnt_despachado,                totales.tot_clientes,                totales.tot_despachado   FROM mav_detal_mav det,        mav_detal_mav_unida_admin detua,        mav_subti_clien_detal detst,        mav_subcr_asign scr,        cra_perio per,        (SELECT   per.oid_peri             FROM cra_perio per,                  (SELECT *                     FROM cra_perio per1                    WHERE oid_peri = %value_PERIODOVALUE%) pact            WHERE per.marc_oid_marc = pact.marc_oid_marc              AND per.pais_oid_pais = pact.pais_oid_pais              AND per.cana_oid_cana = pact.cana_oid_cana              AND per.fec_inic &lt; pact.fec_inic              AND ROWNUM = 1         ORDER BY per.fec_inic DESC) pant,         (             SELECT   oid_deta_mav, SUM (cnt_clientes) tot_clientes, SUM (cnt_despachado) tot_despachado                 FROM (SELECT det.oid_deta_mav,                               (SELECT COUNT (oid_clie)                                 FROM mae_clien clie                                WHERE EXISTS (                                         SELECT 1                                           FROM mae_clien_unida_admin uadm,                                                zon_terri_admin tad,                                                zon_secci sec,                                                zon_zona zon,                                                zon_regio reg                                          WHERE uadm.clie_oid_clie = clie.oid_clie                                            AND uadm.ind_acti = 1                                            AND uadm.ztad_oid_terr_admi = tad.oid_terr_admi                                            AND tad.zscc_oid_secc = sec.oid_secc                                            AND sec.zzon_oid_zona = zon.oid_zona                                            AND zon.zorg_oid_regi = reg.oid_regi                                            AND NVL (detua.zsgv_oid_subg_vent, reg.zsgv_oid_subg_vent) = reg.zsgv_oid_subg_vent                                            AND NVL (detua.zorg_oid_regi, zon.zorg_oid_regi) = zon.zorg_oid_regi                                            AND NVL (detua.zzon_oid_zona, sec.zzon_oid_zona) = sec.zzon_oid_zona)                                  AND (   (    (   det.ticl_oid_tipo_clie IS NOT NULL                                                OR detst.sbti_oid_subt_clie IS NOT NULL                                               )                                           AND EXISTS (                                                  SELECT 1                                                    FROM mae_clien_tipo_subti tsub                                                   WHERE tsub.clie_oid_clie = clie.oid_clie                                                     AND NVL (det.ticl_oid_tipo_clie, tsub.ticl_oid_tipo_clie) = tsub.ticl_oid_tipo_clie                                                     AND NVL (detst.sbti_oid_subt_clie, tsub.sbti_oid_subt_clie) = tsub.sbti_oid_subt_clie                                                     AND (   (    (   det.tccl_oid_tipo_clas IS NOT NULL                                                                   OR det.clas_oid_clas IS NOT NULL                                                                  )                                                              AND EXISTS (                                                                     SELECT 1                                                                       FROM mae_clien_clasi clas                                                                      WHERE clas.ctsu_oid_clie_tipo_subt = tsub.oid_clie_tipo_subt                                                                        AND NVL(det.tccl_oid_tipo_clas, clas.tccl_oid_tipo_clasi) = clas.tccl_oid_tipo_clasi                                                                        AND NVL(det.clas_oid_clas, clas.clas_oid_clas) = clas.clas_oid_clas)                                                             )                                                          OR det.tccl_oid_tipo_clas IS NULL                                                         ))                                          )                                       OR det.ticl_oid_tipo_clie IS NULL                                      )                                  AND (   det.scas_oid_subc = 1                                       OR (    det.scas_oid_subc = 2                                           AND EXISTS (                                                  SELECT 1                                                    FROM mae_clien_datos_adici adic                                                   WHERE adic.clie_oid_clie = clie.oid_clie                                                     AND adic.fec_naci IS NOT NULL                                                     AND TO_DATE                                                            (   CASE                                                                   WHEN TO_CHAR(adic.fec_naci, 'DD/MM/') = '29/02/'                                                                      THEN '28/02/'                                                                   ELSE TO_CHAR(adic.fec_naci, 'DD/MM/')                                                                END                                                             || CASE                                                                   WHEN TO_CHAR(per.fec_inic,'yyyy') &lt; TO_CHAR(per.fec_fina,'yyyy')                                                                      THEN TO_CHAR(per.fec_inic,'YYYY')                                                                   ELSE TO_CHAR(per.fec_fina,'yyyy')                                                                END,                                                             'dd/mm/yyyy'                                                            ) BETWEEN per.fec_inic AND per.fec_fina)                                          )                                       OR (    det.scas_oid_subc = 3                                           AND TRUNC (  MONTHS_BETWEEN (per.fec_fina, clie.fec_ingr) / 12) = det.num_aniv                                          )                                       OR (    det.scas_oid_subc = 4                                           AND EXISTS (                                                  SELECT 1                                                    FROM mae_clien_datos_adici adic                                                   WHERE adic.clie_oid_clie = clie.oid_clie                                                     AND adic.fec_naci IS NOT NULL                                                     AND TRUNC(MONTHS_BETWEEN(per.fec_fina, adic.fec_naci) / 12) BETWEEN det.val_edad_desd AND det.val_edad_hast                                                      )                                          )                                       OR (    det.scas_oid_subc = 5                                           AND (SELECT NVL(SUM(ped.val_prec_cata_tota_loc_uni_dem), 0)                                                  FROM ped_solic_cabec ped                                                 WHERE ped.perd_oid_peri = pant.oid_peri                                                   AND ped.clie_oid_clie = clie.oid_clie) > det.val_mont                                          )                                       OR (    det.scas_oid_subc = 6                                           AND (SELECT NVL(SUM(pos.val_prec_cata_tota_loca_unid), 0)                                                  FROM ped_solic_cabec ped,                                                       ped_solic_posic pos,                                                       mae_produ prd                                                 WHERE ped.oid_soli_cabe = pos.soca_oid_soli_cabe                                                   AND pos.prod_oid_prod = prd.oid_prod                                                   AND prd.mapr_oid_marc_prod = per.marc_oid_marc                                                   AND ped.perd_oid_peri = per.oid_peri                                                   AND ped.clie_oid_clie = clie.oid_clie) > det.val_mont                                          )                                       OR (    det.scas_oid_subc = 7                                           AND (SELECT NVL(SUM(pos.val_prec_cata_tota_loca_unid), 0)                                                  FROM ped_solic_cabec ped,                                                       ped_solic_posic pos,                                                       mae_produ prd                                                 WHERE ped.oid_soli_cabe = pos.soca_oid_soli_cabe                                                   AND pos.prod_oid_prod = prd.oid_prod                                                   AND prd.uneg_oid_unid_nego = det.uneg_oid_unid_nego                                                   AND ped.perd_oid_peri = per.oid_peri                                                   AND ped.clie_oid_clie = clie.oid_clie) > det.val_mont                                          )                                      )) cnt_clientes,                              (SELECT NVL (SUM (num_unid), 0)                                 FROM mav_envio env                                WHERE env.denv_oid_deta_mav = det.oid_deta_mav                                  AND env.ind_envi = 'E'                                  AND EXISTS (                                         SELECT 1                                           FROM mae_clien clie                                          WHERE EXISTS (                                                   SELECT 1                                                     FROM mae_clien_unida_admin uadm,                                                          zon_terri_admin tad,                                                          zon_secci sec,                                                          zon_zona zon,                                                          zon_regio reg                                                    WHERE uadm.clie_oid_clie = env.clie_oid_clie                                                      AND uadm.ind_acti = 1                                                      AND uadm.ztad_oid_terr_admi = tad.oid_terr_admi                                                      AND tad.zscc_oid_secc = sec.oid_secc                                                      AND sec.zzon_oid_zona = zon.oid_zona                                                      AND zon.zorg_oid_regi = reg.oid_regi                                                      AND NVL (detua.zsgv_oid_subg_vent, reg.zsgv_oid_subg_vent) = reg.zsgv_oid_subg_vent                                                      AND NVL (detua.zorg_oid_regi, zon.zorg_oid_regi) = zon.zorg_oid_regi                                                      AND NVL (detua.zzon_oid_zona, sec.zzon_oid_zona) = sec.zzon_oid_zona)                                            AND (   (    (   det.ticl_oid_tipo_clie IS NOT NULL                                                          OR detst.sbti_oid_subt_clie IS NOT NULL                                                         )                                                     AND EXISTS (                                                            SELECT 1                                                              FROM mae_clien_tipo_subti tsub                                                             WHERE tsub.clie_oid_clie = env.clie_oid_clie                                                               AND NVL(det.ticl_oid_tipo_clie, tsub.ticl_oid_tipo_clie) = tsub.ticl_oid_tipo_clie                                                               AND NVL(detst.sbti_oid_subt_clie, tsub.sbti_oid_subt_clie) = tsub.sbti_oid_subt_clie                                                               AND (   (    (   det.tccl_oid_tipo_clas IS NOT NULL                                                                             OR det.clas_oid_clas IS NOT NULL                                                                            )                                                                        AND EXISTS (                                                                               SELECT 1                                                                                 FROM mae_clien_clasi clas                                                                                WHERE clas.ctsu_oid_clie_tipo_subt = tsub.oid_clie_tipo_subt                                                                                  AND NVL(det.tccl_oid_tipo_clas, clas.tccl_oid_tipo_clasi) = clas.tccl_oid_tipo_clasi                                                                                  AND NVL(det.clas_oid_clas, clas.clas_oid_clas) = clas.clas_oid_clas)                                                                       )                                                                    OR det.tccl_oid_tipo_clas IS NULL                                                                   ))                                                    )                                                 OR det.ticl_oid_tipo_clie IS NULL                                                ))) cnt_despachado                         FROM mav_detal_mav det,                              mav_detal_mav_unida_admin detua,                              mav_subti_clien_detal detst,                              mav_subcr_asign scr,                              cra_perio per,                              (SELECT   per.oid_peri                                   FROM cra_perio per,                                        (SELECT *                                           FROM cra_perio per1                                          WHERE oid_peri = %value_PERIODOVALUE%) pact                                  WHERE per.marc_oid_marc = pact.marc_oid_marc                                    AND per.pais_oid_pais = pact.pais_oid_pais                                    AND per.cana_oid_cana = pact.cana_oid_cana                                    AND per.fec_inic &lt; pact.fec_inic                                    AND ROWNUM = 1                               ORDER BY per.fec_inic DESC) pant                        WHERE detua.denv_oid_deta_mav(+) = det.oid_deta_mav                          AND detst.denv_oid_deta_mav(+) = det.oid_deta_mav                          AND scr.oid_subc = det.scas_oid_subc                          AND det.perd_oid_peri = per.oid_peri                          AND per.oid_peri = %value_PERIODOVALUE%                          AND scr.cras_oid_crit_asig = 1                          AND det.tepr_oid_tipo_esta_proc != 5)             GROUP BY oid_deta_mav                 ) totales  WHERE detua.denv_oid_deta_mav(+) = det.oid_deta_mav    AND detst.denv_oid_deta_mav(+) = det.oid_deta_mav    AND scr.oid_subc = det.scas_oid_subc    AND det.perd_oid_peri = per.oid_peri    AND totales.oid_deta_mav = det.oid_deta_mav    AND per.oid_peri = %value_PERIODOVALUE%    AND scr.cras_oid_crit_asig = 1    AND det.tepr_oid_tipo_esta_proc != 5            ) base,        cra_perio peri,        seg_marca marc,        mae_produ prod,        pre_matri_factu mafa,        pre_ofert_detal ofde,        pre_ciclo_vida civi,        pre_tipo_ofert tofe  WHERE peri.oid_peri = %value_PERIODOVALUE%    AND peri.marc_oid_marc = marc.oid_marc    AND base.prod_oid_prod = prod.oid_prod    AND base.mafa_oid_matr_fact = mafa.oid_matr_fact(+)    AND mafa.ofde_oid_deta_ofer = ofde.oid_deta_ofer(+)    AND civi.oid_cicl_vida = base.civi_oid_cicl_vida    AND tofe.oid_tipo_ofer = base.tofe_oid_tipo_ofer      %start_ACTIVIDADVALUES%   AND base.acti_oid_acti IN ( %value_ACTIVIDADVALUES% ) %end_ACTIVIDADVALUES%      %start_CODIGOPRODUCTODESDEVALUE%   AND PROD.COD_SAP >= %value_CODIGOPRODUCTODESDEVALUE% %end_CODIGOPRODUCTODESDEVALUE%      %start_CODIGOPRODUCTOHASTAVALUE%   AND PROD.COD_SAP &lt;= %value_CODIGOPRODUCTOHASTAVALUE% %end_CODIGOPRODUCTOHASTAVALUE%      %start_CODIGOVENTADESDEVALUE%   AND OFDE.VAL_CODI_VENT >= %value_CODIGOVENTADESDEVALUE% %end_CODIGOVENTADESDEVALUE%      %start_CODIGOVENTAHASTAVALUE%   AND OFDE.VAL_CODI_VENT &lt;= %value_CODIGOVENTAHASTAVALUE% %end_CODIGOVENTAHASTAVALUE%      %start_PRECIOCATALOGOVALUE%   AND OFDE.IMP_PREC_CATA %value_OPERADORPRECIOCATALOGOVALUE% %value_PRECIOCATALOGOVALUE% %end_PRECIOCATALOGOVALUE%      %start_PRECIOCONTABLEVALUE%   AND OFDE.IMP_PREC_POSI %value_OPERADORPRECIOCONTABLEVALUE% %value_PRECIOCONTABLEVALUE% %end_PRECIOCONTABLEVALUE%      %start_CANTIDADESTIMADAVALUE%   AND base.UN_ESTIM %value_OPERADORCANTIDADESTIMADAVALUE% %value_CANTIDADESTIMADAVALUE% %end_CANTIDADESTIMADAVALUE%      %start_TIPOCLIENTEVALUES%   AND base.TICL_OID_TIPO_CLIE IN ( %value_TIPOCLIENTEVALUES% ) %end_TIPOCLIENTEVALUES%      %start_CICLOVIDAVALUES%   AND base.CIVI_OID_CICL_VIDA IN ( %value_CICLOVIDAVALUES% ) %end_CICLOVIDAVALUES%              %start_TIPOOFERTAVALUES%   AND base.TOFE_OID_TIPO_OFER IN ( %value_TIPOOFERTAVALUES% ) %end_TIPOOFERTAVALUES%  ORDER BY activ,          val_codi_vent,          cod_sap,          oid_deta_mav,          sub_tipo_clien,          tipo_clasi_clien,          clasi_clien,          cod_regi,          cod_zona" ExternalClassName="oracle.jdbc.driver.OracleDriver" ExternalSourceData="" ExternalConnectionString="" ExternalConnectionClassName="oracle.jdbc.driver.OracleDriver" ExternalConnectionLocalUrl="jdbc:oracle:thin:@192.168.118.106:1523:SICCV3D" ExternalConnectionDistributedUrl="" ExternalConnectionUser="usu_peru" ExternalConnectionPassword="peru" DatePattern="" DateTimePattern=""/></DataSourceDefinitions><ParameterValues><ParameterValue FilterDefinitionName="IDIOMA" FilterParameter="VALUE" DefaultValue="1"/><ParameterValue FilterDefinitionName="PAIS" FilterParameter="VALUE" DefaultValue="1"/><ParameterValue FilterDefinitionName="MARCA" FilterParameter="VALUE" DefaultValue="1"/><ParameterValue FilterDefinitionName="CANAL" FilterParameter="VALUE" DefaultValue="1"/><ParameterValue FilterDefinitionName="PERIODO" FilterParameter="VALUE" DefaultValue="41"/><ParameterValue FilterDefinitionName="CODIGOPRODUCTODESDE" FilterParameter="VALUE" DefaultValue="NULL_VALUE"/><ParameterValue FilterDefinitionName="CODIGOPRODUCTOHASTA" FilterParameter="VALUE" DefaultValue="NULL_VALUE"/><ParameterValue FilterDefinitionName="CODIGOVENTADESDE" FilterParameter="VALUE" DefaultValue="NULL_VALUE"/><ParameterValue FilterDefinitionName="CODIGOVENTAHASTA" FilterParameter="VALUE" DefaultValue="NULL_VALUE"/><ParameterValue FilterDefinitionName="ACTIVIDAD" FilterParameter="VALUES" DefaultValue="NULL_VALUE"/><ParameterValue FilterDefinitionName="OPERADORPRECIOCATALOGO" FilterParameter="VALUE" DefaultValue="'>'"/><ParameterValue FilterDefinitionName="PRECIOCATALOGO" FilterParameter="VALUE" DefaultValue="NULL_VALUE"/><ParameterValue FilterDefinitionName="OPERADORPRECIOCONTABLE" FilterParameter="VALUE" DefaultValue="'>'"/><ParameterValue FilterDefinitionName="PRECIOCONTABLE" FilterParameter="VALUE" DefaultValue="NULL_VALUE"/><ParameterValue FilterDefinitionName="OPERADORCANTIDADESTIMADA" FilterParameter="VALUE" DefaultValue="'>'"/><ParameterValue FilterDefinitionName="CANTIDADESTIMADA" FilterParameter="VALUE" DefaultValue="NULL_VALUE"/><ParameterValue FilterDefinitionName="TIPOCLIENTE" FilterParameter="VALUES" DefaultValue="NULL_VALUE"/><ParameterValue FilterDefinitionName="CICLOVIDA" FilterParameter="VALUES" DefaultValue="NULL_VALUE"/><ParameterValue FilterDefinitionName="TIPOOFERTA" FilterParameter="VALUES" DefaultValue="NULL_VALUE"/></ParameterValues></ReportSourceDefinition>  

