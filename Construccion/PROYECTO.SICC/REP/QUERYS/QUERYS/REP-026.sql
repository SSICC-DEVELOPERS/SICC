select val_nomb_prog AS FUN, val_i18n AS NOMBRE, count(idmember) as CANTIDAD from ( select distinct VAL_NOMB_PROG, i18.VAL_I18N, us.IDMEMBER from    MEN_FUNCI fu    LEFT OUTER JOIN PRINCIPALS pr ON TO_CHAR(fu.OID_FUNC) = pr.NAME    INNER JOIN MEMBEROF per on per.IDROLE = pr.IDPRINCIPAL   INNER JOIN MEMBEROF us on per.IDMEMBER = us.IDROLE   INNER JOIN V_GEN_I18N_SICC i18 on fu.OID_FUNC = i18.VAL_OID  where IND_NIVE = 1 and IDIO_OID_IDIO =  1  and i18.attr_enti='MEN_FUNCI' and us.IDMEMBER  < > 4) group by VAL_I18N, VAL_NOMB_PROG  order by upper(VAL_I18N), VAL_NOMB_PROG