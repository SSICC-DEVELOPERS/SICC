SELECT  	   I18PAIS.VAL_I18N AS PAIS, 	   MARCA.DES_MARC AS MARCA,  	   I18CANAL.VAL_I18N AS CANAL,  	   PERI.VAL_NOMB_PERI,    	   I18ACTIV.VAL_I18N AS ACTIV, 	   OFDET.VAL_CODI_VENT, 	   PRODU.COD_SAP, 	   I18PRODU.VAL_I18N AS DESC_PROD, 	   CIVI.COD_CICL_VIDA,  	   TOFE.COD_TIPO_OFER, 	   I18TCLIEN.VAL_I18N AS DESC_TIPO_CLIEN, 	   SUBT_CLIEN.COD_SUBT_CLIE AS SUB_TIPO_CLIEN,	      	   T_CLASI_CLIEN.COD_TIPO_CLAS AS TIPO_CLASI_CLIEN,  	   CLASI_CLIEN.CLAS_OID_CLAS AS CLASI_CLIEN,	 	   REGION.COD_REGI,  	   ZONA.COD_ZONA,  	   T_DESPA.DES_TIPO_DESP, 	   SCRIT.DES_SUBC, 	   ( 	   	CASE WHEN (DETAL_MAV.SCAS_OID_SUBC = 3) THEN  				 TO_CHAR(DETAL_MAV.NUM_ANIV) 		 	WHEN (DETAL_MAV.SCAS_OID_SUBC = 4) THEN  				 TO_CHAR(DETAL_MAV.VAL_EDAD_DESD || ' - ' || DETAL_MAV.VAL_EDAD_HAST)   		 	WHEN (DETAL_MAV.SCAS_OID_SUBC = 5) THEN  				 TO_CHAR(DETAL_MAV.VAL_MONT) 		 	WHEN (DETAL_MAV.SCAS_OID_SUBC = 6) THEN  				 TO_CHAR(DETAL_MAV.VAL_MONT) 		 	WHEN (DETAL_MAV.SCAS_OID_SUBC = 7) THEN  				 TO_CHAR(DETAL_MAV.VAL_MONT) 			ELSE '' 	   END 	   ) AS VAL_CRIT,   	   OFDET.IMP_PREC_CATA, 	   OFDET.IMP_PREC_POSI, 	   (COUNT(DISTINCT(ENVIO_ATRIBUTO.CLIE_OID_CLIE))*DETAL_MAV.NUM_UNID_CLIE) AS CANTIDAD_ESTIMADA, 	   SUM(ENVIO.NUM_UNID) AS TOTAL_A_ENVIAR, 	   NVL((DETAL_MAV.VAL_BASE_ESTI_DEST * DETAL_MAV.VAL_FACT_CORR * DETAL_MAV.NUM_UNID_ESTI), 0) AS UN_ESTIM, 	   SUM(DECODE(ENVIO.IND_ENVI,'P',ENVIO.NUM_UNID,0)) AS UN_PEND_ENVIO,    	   SUM(DECODE(ENVIO.IND_ENVI,'E',ENVIO.NUM_UNID,0)) AS UN_DISTRIBUIDAS  FROM 	CRA_PERIO PERI, 	SEG_MARCA MARCA, 	MAV_DETAL_MAV DETAL_MAV, 	PRE_MATRI_FACTU MAFA, 	PRE_OFERT_DETAL OFDET, 	MAV_ENVIO ENVIO, 	MAV_ACTIV_TIPO_DESPA ACTIV_T_DESPA, 	MAV_TIPO_DESPA T_DESPA,  	MAE_CLIEN_TIPO_SUBTI T_SUBTI_CLIEN, 	MAE_SUBTI_CLIEN SUBT_CLIEN, 	MAE_TIPO_CLIEN T_CLIEN, 	MAE_TIPO_CLASI_CLIEN T_CLASI_CLIEN, 	MAE_CLIEN_CLASI CLASI_CLIEN,  	MAE_CLIEN_UNIDA_ADMIN UNADMIN, 	ZON_TERRI_ADMIN TERR_ADMI, 	ZON_SECCI SECCI, 	ZON_ZONA ZONA, 	ZON_REGIO REGION,  	PRE_CICLO_VIDA CIVI, 	PRE_TIPO_OFERT TOFE, 	MAE_PRODU PRODU,    	MAV_SUBCR_ASIGN SCRIT, 	(  	 SELECT  		   ENV.CLIE_OID_CLIE, ENV.DENV_OID_DETA_MAV, ENV.ACTI_OID_ACTI, ENV.NUM_UNID, 		   FECH_DESDE_HASTA.FEC_INIC,  		   TO_DATE(  TO_CHAR(  CLIEN_ADICI.FEC_NACI,'DD/MM' ) ||  		   			 		   			CASE WHEN (  											 	  TO_CHAR(FECH_DESDE_HASTA.FEC_INIC,'YYYY')  <  											 	  TO_CHAR(FECH_DESDE_HASTA.FEC_FINA,'YYYY') 												  ) 											 THEN TO_CHAR(FECH_DESDE_HASTA.FEC_INIC,'YYYY') 											 ELSE TO_CHAR(FECH_DESDE_HASTA.FEC_FINA,'YYYY')  										END) AS CUMPLE, 		   FECH_DESDE_HASTA.FEC_FINA, 	 	   TRUNC((FECH_DESDE_HASTA.FEC_FINA-CLIEN.FEC_INGR)/365) AS ANIVERSARIO, 		   CLIEN_ADICI.VAL_EDAD, 		   NVL((  		    SELECT SUM(PED.VAL_PREC_CATA_TOTA_LOC_UNI_DEM) AS MONTO 			FROM PED_SOLIC_CABEC PED 			WHERE PERD_OID_PERI = PERI_ANTERIOR.OID_PERI 				  AND PED.CLIE_OID_CLIE = ENV.CLIE_OID_CLIE  			GROUP BY PERD_OID_PERI, PED.CLIE_OID_CLIE 		   ),0) AS MONTO, 		   NVL(( 		    SELECT SUM(PED_POSIC.VAL_PREC_CATA_TOTA_LOCA_UNID) AS MONTO_MARCA 			FROM PED_SOLIC_CABEC PED, 				 PED_SOLIC_POSIC PED_POSIC, 				 MAE_PRODU PRODU 			WHERE PED.OID_SOLI_CABE = PED_POSIC.SOCA_OID_SOLI_CABE 				  AND PED_POSIC.PROD_OID_PROD = PRODU.OID_PROD 				  AND PRODU.MAPR_OID_MARC_PROD = PERI_ANTERIOR.MARC_OID_MARC 				  AND PERD_OID_PERI = PERI_ANTERIOR.OID_PERI 				  AND PED.CLIE_OID_CLIE = ENV.CLIE_OID_CLIE  		   ),0) AS MONTO_MARCA, 		   NVL(( 		    SELECT SUM(PED_POSIC.VAL_PREC_CATA_TOTA_LOCA_UNID) AS MONTO_MARCA 			FROM PED_SOLIC_CABEC PED, 				 PED_SOLIC_POSIC PED_POSIC, 				 MAE_PRODU PRODU 			WHERE PED.OID_SOLI_CABE = PED_POSIC.SOCA_OID_SOLI_CABE 				  AND PED_POSIC.PROD_OID_PROD = PRODU.OID_PROD 				  AND PRODU.NEGO_OID_NEGO = DET.NEGO_OID_NEGO 				  AND PERD_OID_PERI = PERI_ANTERIOR.OID_PERI 				  AND PED.CLIE_OID_CLIE = ENV.CLIE_OID_CLIE  		   ),0) AS MONTO_UN_NEGO 	 FROM 		   MAV_DETAL_MAV DET, 	 	   MAV_ENVIO ENV, 		   MAV_SUBCR_ASIGN SCRI, 		   MAV_CRITE_ASIGN CRI, 		   MAE_CLIEN_UNIDA_ADMIN UNADMIN, 		   ZON_TERRI_ADMIN TERR_ADMI, 		   ZON_SECCI SECCI, 		   ZON_ZONA ZONA, 		   ZON_REGIO REGION, 		   MAE_CLIEN CLIEN, 		   MAE_CLIEN_DATOS_ADICI CLIEN_ADICI, 		   ( 		 	SELECT OID_PERI, FEC_INIC, MARC_OID_MARC   			FROM ( 				  SELECT PER3.OID_PERI, PER3.FEC_INIC, PER3.MARC_OID_MARC 			 	  FROM ( 				  	   	SELECT PER2.OID_PERI, PER2.FEC_INIC, PER2.MARC_OID_MARC 					 	FROM CRA_PERIO PER2 					 	WHERE PER2.OID_PERI =  41 	 				 		) PER_PARA, 				 		CRA_PERIO PER3 				  WHERE PER3.FEC_INIC  <  PER_PARA.FEC_INIC 				  ORDER BY PER3.FEC_INIC DESC 				 ) 			WHERE ROWNUM=1 		   ) PERI_ANTERIOR, 		   ( 		    SELECT PERI_DH.OID_PERI, PERI_DH.FEC_INIC, PERI_DH.FEC_FINA 			FROM CRA_PERIO PERI_DH 		   ) FECH_DESDE_HASTA 	 WHERE 		       DET.SCAS_OID_SUBC = SCRI.OID_SUBC 		   AND SCRI.CRAS_OID_CRIT_ASIG = CRI.OID_CRIT_ASIG 	 	   AND ENV.DENV_OID_DETA_MAV = DET.OID_DETA_MAV 	 	   AND ENV.ACTI_OID_ACTI = DET.ACTI_OID_ACTI 	 	   AND CRI.OID_CRIT_ASIG = 1 		   AND FECH_DESDE_HASTA.OID_PERI = DET.PERD_OID_PERI  	 	   AND ENV.CLIE_OID_CLIE = UNADMIN.CLIE_OID_CLIE 		   AND UNADMIN.IND_ACTI = 1 		   AND UNADMIN.ZTAD_OID_TERR_ADMI = TERR_ADMI.OID_TERR_ADMI 		   AND TERR_ADMI.ZSCC_OID_SECC = SECCI.OID_SECC 		   AND SECCI.ZZON_OID_ZONA = ZONA.OID_ZONA 		   AND ZONA.ZORG_OID_REGI = REGION.OID_REGI  		   AND ENV.CLIE_OID_CLIE = CLIEN_ADICI.CLIE_OID_CLIE 		   AND ENV.CLIE_OID_CLIE = CLIEN.OID_CLIE		     	) ENVIO_ATRIBUTO, 	( 	 SELECT V.VAL_OID, V.VAL_I18N  	  FROM V_GEN_I18N_SICC V  	   WHERE V.ATTR_ENTI = 'SEG_PAIS'  	    AND V.IDIO_OID_IDIO =  1  	) I18PAIS, 	( 	 SELECT V.VAL_OID, V.VAL_I18N  	  FROM V_GEN_I18N_SICC V  	   WHERE V.ATTR_ENTI = 'SEG_CANAL'  	    AND V.IDIO_OID_IDIO =  1  	) I18CANAL, 	( 	 SELECT V.VAL_OID, V.VAL_I18N  	  FROM V_GEN_I18N_SICC V  	   WHERE V.ATTR_ENTI = 'MAE_PRODU'  	    AND V.IDIO_OID_IDIO =  1  	) I18PRODU, 	( 	 SELECT V.VAL_OID, V.VAL_I18N  	  FROM V_GEN_I18N_SICC V  	   WHERE V.ATTR_ENTI = 'MAV_ACTIV'  	    AND V.IDIO_OID_IDIO =  1  	) I18ACTIV, 	( 	 SELECT V.VAL_OID, V.VAL_I18N  	  FROM V_GEN_I18N_SICC V  	   WHERE V.ATTR_ENTI = 'MAE_TIPO_CLIEN'  	    AND V.IDIO_OID_IDIO =  1  	) I18TCLIEN WHERE 	 	DETAL_MAV.PERD_OID_PERI = PERI.OID_PERI 	AND	DETAL_MAV.CIVI_OID_CICL_VIDA = CIVI.OID_CICL_VIDA 	AND DETAL_MAV.TOFE_OID_TIPO_OFER = TOFE.OID_TIPO_OFER 	AND PERI.MARC_OID_MARC = MARCA.OID_MARC 	AND DETAL_MAV.OID_DETA_MAV = ENVIO.DENV_OID_DETA_MAV 	AND ENVIO.MAFA_OID_MATR_FACT = MAFA.OID_MATR_FACT 	AND MAFA.OFDE_OID_DETA_OFER = OFDET.OID_DETA_OFER 	AND DETAL_MAV.PROD_OID_PROD = PRODU.OID_PROD 	AND DETAL_MAV.SCAS_OID_SUBC = SCRIT.OID_SUBC  	AND DETAL_MAV.ATDE_OID_ACTI_TIPO_DESP = ACTIV_T_DESPA.OID_ACTI_TIPO_DESP(+) 	AND ACTIV_T_DESPA.TDCH_OID_TIPO_DESP = T_DESPA.OID_TIPO_DESP  	AND ENVIO.ACTI_OID_ACTI = DETAL_MAV.ACTI_OID_ACTI 	AND ENVIO.DENV_OID_DETA_MAV = DETAL_MAV.OID_DETA_MAV 	AND ENVIO_ATRIBUTO.ACTI_OID_ACTI(+) = DETAL_MAV.ACTI_OID_ACTI 	AND ENVIO_ATRIBUTO.DENV_OID_DETA_MAV(+) = DETAL_MAV.OID_DETA_MAV  	AND (  		 ( DETAL_MAV.SCAS_OID_SUBC = 2 AND ENVIO_ATRIBUTO.CUMPLE BETWEEN ENVIO_ATRIBUTO.FEC_INIC AND ENVIO_ATRIBUTO.FEC_FINA  ) 		  OR  	 		 ( DETAL_MAV.SCAS_OID_SUBC = 3 AND ENVIO_ATRIBUTO.ANIVERSARIO = DETAL_MAV.NUM_ANIV  ) 		  OR  	 		 ( DETAL_MAV.SCAS_OID_SUBC = 4 AND ENVIO_ATRIBUTO.VAL_EDAD BETWEEN DETAL_MAV.VAL_EDAD_DESD AND DETAL_MAV.VAL_EDAD_HAST )  		  OR  	 		 ( DETAL_MAV.SCAS_OID_SUBC = 5 AND ENVIO_ATRIBUTO.MONTO > DETAL_MAV.VAL_MONT )  		  OR  	 		 ( DETAL_MAV.SCAS_OID_SUBC = 6 AND ENVIO_ATRIBUTO.MONTO_MARCA > DETAL_MAV.VAL_MONT )  		  OR  	 		 ( DETAL_MAV.SCAS_OID_SUBC = 7 AND ENVIO_ATRIBUTO.MONTO_UN_NEGO > DETAL_MAV.VAL_MONT )  		)   	AND I18PAIS.VAL_OID (+)= PERI.PAIS_OID_PAIS 	AND I18CANAL.VAL_OID (+)= PERI.CANA_OID_CANA 	AND I18PRODU.VAL_OID (+)= DETAL_MAV.PROD_OID_PROD 	AND I18TCLIEN.VAL_OID (+)= DETAL_MAV.TICL_OID_TIPO_CLIE 	AND I18ACTIV.VAL_OID (+)= DETAL_MAV.ACTI_OID_ACTI  	AND ENVIO.CLIE_OID_CLIE = UNADMIN.CLIE_OID_CLIE(+) 	AND UNADMIN.IND_ACTI = 1 	AND UNADMIN.ZTAD_OID_TERR_ADMI = TERR_ADMI.OID_TERR_ADMI 	AND TERR_ADMI.ZSCC_OID_SECC = SECCI.OID_SECC 	AND SECCI.ZZON_OID_ZONA = ZONA.OID_ZONA 	AND ZONA.ZORG_OID_REGI = REGION.OID_REGI	  	AND ENVIO.CLIE_OID_CLIE = T_SUBTI_CLIEN.CLIE_OID_CLIE 	AND T_SUBTI_CLIEN.SBTI_OID_SUBT_CLIE = SUBT_CLIEN.OID_SUBT_CLIE 	AND SUBT_CLIEN.TICL_OID_TIPO_CLIE = T_CLIEN.OID_TIPO_CLIE 	AND SUBT_CLIEN.OID_SUBT_CLIE = T_CLASI_CLIEN.SBTI_OID_SUBT_CLIE 	AND T_CLASI_CLIEN.OID_TIPO_CLAS = CLASI_CLIEN.TCCL_OID_TIPO_CLASI			  	AND CLASI_CLIEN.CTSU_OID_CLIE_TIPO_SUBT = T_SUBTI_CLIEN.OID_CLIE_TIPO_SUBT 	   	AND PERI.PAIS_OID_PAIS =  1  	AND PERI.MARC_OID_MARC =  1  	AND PERI.CANA_OID_CANA =  1  	AND PERI.OID_PERI =  41  	 AND DETAL_MAV.ACTI_OID_ACTI IN (  1  )  	 AND PRODU.COD_SAP >=  '1'   	 AND PRODU.COD_SAP  < =  '1'   	 AND OFDET.VAL_CODI_VENT >=  '1'   	 AND OFDET.VAL_CODI_VENT  < =  '1'   	 AND OFDET.IMP_PREC_CATA  >   '1'   	 AND OFDET.IMP_PREC_POSI  >   '1'   	 AND NVL((DETAL_MAV.VAL_BASE_ESTI_DEST * DETAL_MAV.VAL_FACT_CORR * DETAL_MAV.NUM_UNID_ESTI), 0)  >   '1'   	 AND DETAL_MAV.TICL_OID_TIPO_CLIE IN (  1  )  	 AND DETAL_MAV.CIVI_OID_CICL_VIDA IN (  1  ) 		 	 AND DETAL_MAV.TOFE_OID_TIPO_OFER IN (  1  )  GROUP BY     	I18PAIS.VAL_I18N, 	   MARCA.DES_MARC,  	   I18CANAL.VAL_I18N,  	   PERI.VAL_NOMB_PERI,    	   I18ACTIV.VAL_I18N, 	   OFDET.VAL_CODI_VENT, 	   PRODU.COD_SAP, 	   I18PRODU.VAL_I18N, 	   OFDET.IMP_PREC_CATA, 	   OFDET.IMP_PREC_POSI, 	   CIVI.COD_CICL_VIDA,  	   TOFE.COD_TIPO_OFER, 	   I18TCLIEN.VAL_I18N, 	   SUBT_CLIEN.COD_SUBT_CLIE,	      	   T_CLASI_CLIEN.COD_TIPO_CLAS,  	   CLASI_CLIEN.CLAS_OID_CLAS,	 	   REGION.COD_REGI,  	   ZONA.COD_ZONA,  	   T_DESPA.DES_TIPO_DESP,  	   DETAL_MAV.VAL_CRIT,	     	   DETAL_MAV.NUM_UNID_CLIE, 	   SCRIT.DES_SUBC, 	   NVL((DETAL_MAV.VAL_BASE_ESTI_DEST * DETAL_MAV.VAL_FACT_CORR * DETAL_MAV.NUM_UNID_ESTI), 0), 	   DETAL_MAV.SCAS_OID_SUBC, DETAL_MAV.NUM_ANIV, DETAL_MAV.VAL_EDAD_DESD, DETAL_MAV.VAL_EDAD_HAST, DETAL_MAV.VAL_MONT ORDER BY 	I18ACTIV.VAL_I18N, 	OFDET.VAL_CODI_VENT,  	PRODU.COD_SAP