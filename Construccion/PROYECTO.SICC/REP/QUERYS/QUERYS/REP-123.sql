	 SELECT cob.pais, cob.soci, cob.region, cob.zona, cob.seccion, cob.territorio,        cob.cod_consultora, cob.consultora, cob.documento, cob.tipo_via,        cob.nombre_via, cob.numero, cob.OBSERVACIONES, cob.telefono, cob.camp, cob.boleta, cob.fecha_fact,        mov.fec_rango1, mov.fec_rango2, mov.fec_rango3, mov.fec_rango4,        mov.fec_rango5, mov.fec_rango6, cob.importe_facturado,        cob.saldo_cartera, mov.rango_1, mov.rango_2, mov.rango_3, mov.rango_4,        mov.rango_5, mov.rango_6, cob.rebaja,        (  NVL (cob.saldo_cartera, 0)         - (  NVL (mov.rango_1, 0)            + NVL (mov.rango_2, 0)            + NVL (mov.rango_3, 0)            + NVL (mov.rango_4, 0)            + NVL (mov.rango_5, 0)            + NVL (mov.rango_6, 0)           )        ) saldo_preliminar,        cob.saldo_liquida   FROM (SELECT gen_pais.val_i18n pais, gen_soci.val_i18n soci,                mcc.oid_movi_cc, subg.oid_subg_vent, reg.des_regi region,                zona.des_zona zona, sec.des_secci seccion,                ter.cod_terr territorio,                CLI.COD_CLIE COD_CONSULTORA,                 cli.val_nom1                || ' '                || cli.val_nom2                || ' '                || cli.val_ape1                || ' '                || cli.val_ape2 consultora,                datos_cli.num_docu_iden documento,                gen_tip_via.val_i18n tipo_via,                DECODE(cli_dir.val_nomb_via, 	   						  		null,  	   						  		(Select VIA.NOM_VIA 									 From ZON_VIA VIA 									 Where VIA.OID_VIA = cli_dir.ZVIA_OID_VIA 									), 									cli_dir.val_nomb_via) as nombre_via,  		  datos_cli.num_ppal numero,  					   cli_dir.VAL_OBSE AS OBSERVACIONES, 		  datos_cli.val_text_comu telefono, perio.val_nomb_peri camp,                mcc.num_iden_cuot boleta,                asi_cob.imp_orig_deud importe_facturado,                asi_cob.imp_deud_asig saldo_cartera, mcc.fec_docu fecha_fact, 			   NVL(( 			   	SELECT SUM(ASI.IMP_DEUD_ASIG) 				FROM COB_ASIGN_COBRA ASI, 					 COB_CRONO_COBRA CRO, 					 ccc_movim_cuent_corri movi,  					 COB_ESTAD_ASIGN EST_ASG	 	  				WHERE ASI.MVCC_OID_MOVI_CC = movi.OID_MOVI_CC 					  AND movi.CLIE_OID_CLIE = CLI.OID_CLIE  					  AND EST_ASG.OID_ESTA_ASIG = ASI.ESAS_OID_ESTA_ASIG  					  AND EST_ASG.OID_ESTA_ASIG = 4 					  AND CRO.ETDE_OID_ETAP_DEUD = CRO_COB.ETDE_OID_ETAP_DEUD 					  AND CRO.PERD_OID_PERI = CRO_COB.PERD_OID_PERI 				GROUP BY movi.CLIE_OID_CLIE  			   ), 0) REBAJA,                pq_apl_rep.fn_cu_calc_saldo_cta_cte                                             (cli.oid_clie                                             ) saldo_liquida,                asi_cob.fec_asig           FROM cob_asign_cobra asi_cob,                cob_crono_cobra cro_cob,                seg_marca marca,                seg_canal canal,                cra_perio perio,                cob_usuar_cobra usu_cob,                cob_usuar_grupo_usuar gru_usu,                zon_sub_geren_venta subg,                zon_zona zona,                zon_regio reg,                zon_secci sec,                zon_terri ter,                zon_terri_admin ter_adm,                ccc_movim_cuent_corri mcc,                mae_clien cli,                cob_estad_asign est_asg,                  mae_clien_direc cli_dir,                (SELECT cli_ide.clie_oid_clie, cli_dir.val_nomb_via,                        cli_dir.num_ppal, cli_dir.val_inte, cli_dir.val_manz,                        cli_dir.val_lote, cli_dir.val_km,                        cli_ide.num_docu_iden, tip_via.oid_tipo_via,                        cli_com.val_text_comu                   FROM mae_clien_ident cli_ide,                        mae_clien_direc cli_dir,                        seg_tipo_via tip_via,                        mae_clien_comun cli_com                  WHERE cli_ide.val_iden_docu_prin = 1                    AND cli_dir.ind_dire_ppal = 1                    AND cli_dir.clie_oid_clie(+) = cli_ide.clie_oid_clie                    AND tip_via.oid_tipo_via = cli_dir.tivi_oid_tipo_via                    AND cli_com.clie_oid_clie(+) = cli_ide.clie_oid_clie) datos_cli,                (SELECT gen.val_oid, gen.val_i18n                   FROM v_gen_i18n_sicc gen                  WHERE gen.attr_enti = 'SEG_PAIS' AND gen.idio_oid_idio =  1 	) gen_pais,                (SELECT gen.val_oid, gen.val_i18n                   FROM v_gen_i18n_sicc gen                  WHERE gen.attr_enti = 'SEG_SOCIE' AND gen.idio_oid_idio =  1 ) gen_soci,                (SELECT gen.val_oid, gen.val_i18n                   FROM v_gen_i18n_sicc gen                  WHERE gen.attr_enti = 'SEG_TIPO_VIA'                        AND gen.idio_oid_idio =  1 ) gen_tip_via          WHERE asi_cob.crco_oid_cron_cobr = cro_cob.oid_cron_cobr            AND perio.cana_oid_cana = canal.oid_cana            AND perio.marc_oid_marc = marca.oid_marc            AND perio.oid_peri = cro_cob.perd_oid_peri            AND usu_cob.oid_usua_cobr = cro_cob.usco_oid_usua_cobr            AND gru_usu.usco_oid_usua_cobr = usu_cob.oid_usua_cobr            AND subg.oid_subg_vent = reg.zsgv_oid_subg_vent            AND zona.zorg_oid_regi = reg.oid_regi            AND zona.oid_zona = sec.zzon_oid_zona            AND sec.oid_secc = ter_adm.zscc_oid_secc            AND ter_adm.terr_oid_terr = ter.oid_terr            AND subg.cana_oid_cana = canal.oid_cana            AND subg.marc_oid_marc = marca.oid_marc            AND datos_cli.clie_oid_clie(+) = cli.oid_clie            AND cli_dir.clie_oid_clie(+) = cli.oid_clie            AND mcc.zorg_oid_regi = reg.oid_regi            AND mcc.zscc_oid_secc = sec.oid_secc            AND mcc.zsgv_oid_subg_vent = subg.oid_subg_vent            AND mcc.ztad_oid_terr_admi = ter_adm.oid_terr_admi            AND asi_cob.mvcc_oid_movi_cc = mcc.oid_movi_cc            AND cli.oid_clie = mcc.clie_oid_clie            AND est_asg.oid_esta_asig = asi_cob.esas_oid_esta_asig            AND (   est_asg.oid_esta_asig = 2                 OR est_asg.oid_esta_asig = 3                 OR est_asg.oid_esta_asig = 6                )            AND datos_cli.oid_tipo_via = gen_tip_via.val_oid(+)            AND zona.pais_oid_pais = gen_pais.val_oid(+)            AND asi_cob.soci_oid_soci = gen_soci.val_oid(+)                  AND CRO_COB.USCO_OID_USUA_COBR =  1     						 		     AND GRU_USU.GUCO_OID_GRUP_USUA_COBR =   1 	    			 		    	AND MARCA.OID_MARC =      1     		    	 AND CANAL.OID_CANA =     1     		    	 AND CRO_COB.PERD_OID_PERI =  1    	 		    	AND REG.OID_REGI =   1   		 		      AND ZONA.OID_ZONA =   1    			 		      AND SEC.OID_SECC =  1    	 		     AND TER.COD_TERR =   '1'     	  			  AND ASI_COB.PAIS_OID_PAIS =  1 	 					            AND TO_DATE (asi_cob.fec_asig) >                                           TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' ) ) cob,        (SELECT   oid_movi_cc, fec_rango1, SUM (rango_1) rango_1, fec_rango2,                  SUM (rango_2) rango_2, fec_rango3, SUM (rango_3) rango_3,                  fec_rango4, SUM (rango_4) rango_4, fec_rango5,                  SUM (rango_5) rango_5, fec_rango6, SUM (rango_6) rango_6             FROM (SELECT   oid_movi_cc,                            CASE                               WHEN (TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )  + 15                                    ) > SYSDATE                                  THEN    TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )                                        || ' '                                       || SYSDATE                               ELSE    TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )                                     || ' '                                    || (  TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )                                         + 15                                       )                            END AS fec_rango1,                            CASE                               WHEN (    TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )   < =                                                                          fecha                                     AND (  TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )                                           + 15                                         ) >= fecha                                    )                                  THEN SUM (importe)                            END AS rango_1,                            CASE                               WHEN (TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )  + 16                                    ) > SYSDATE                                  THEN NULL                               ELSE CASE                               WHEN (TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )  + 30) >                                                                        SYSDATE                                  THEN    (  TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )+ 16)                                       || ' '                                       || SYSDATE                               ELSE    (  TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )+ 16)                                    || ' '                                    || (  TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )+ 30)                            END                            END AS fec_rango2,                            CASE                               WHEN (    (  TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' ) + 16 )  < = fecha                                     AND (  TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )  + 30) >= fecha                                    )                                  THEN SUM (importe)                            END AS rango_2,                            CASE                               WHEN (TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )  + 31                                    ) > SYSDATE                                  THEN NULL                               ELSE CASE                               WHEN (TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )  + 45) >                                                                        SYSDATE                                  THEN    (  TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )  + 31)                                       || ' '                                       || SYSDATE                               ELSE    (  TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )                                         + 31                                       )                                    || ' '                                    || (  TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )                                         + 45                                       )                            END                            END AS fec_rango3,                            CASE                               WHEN (    (  TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )+ 31)  < = fecha                                     AND (  TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' ) + 45) >= fecha                                    )                                  THEN SUM (importe)                            END AS rango_3,                            CASE                               WHEN (TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )  + 46                                    ) > SYSDATE                                  THEN NULL                               ELSE CASE                               WHEN (TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )  + 60) >                                                                        SYSDATE                                  THEN    (  TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )+ 46)                                       || ' '                                       || SYSDATE                               ELSE    (  TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )                                         + 46                                       )                                    || ' '                                    || (  TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )                                         + 60                                       )                            END                            END AS fec_rango4,                            CASE                               WHEN (    (  TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )+ 46)  < = fecha                                     AND (  TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )+ 60) >= fecha                                    )                                  THEN SUM (importe)                            END AS rango_4,                            CASE                               WHEN (TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )  + 61                                    ) > SYSDATE                                  THEN NULL                               ELSE CASE                               WHEN (TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )  + 75) >                                                                        SYSDATE                                  THEN    (  TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )+ 61)                                       || ' '                                       || SYSDATE                               ELSE    (  TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )                                         + 61                                       )                                    || ' '                                    || (  TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )                                         + 75                                       )                            END                            END AS fec_rango5,                            CASE                               WHEN (    (  TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )+ 61)  < = fecha                                     AND (  TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )+ 75) >= fecha                                    )                                  THEN SUM (importe)                            END AS rango_5,                            CASE                               WHEN (TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )  + 76                                    ) > SYSDATE                                  THEN NULL                               ELSE CASE                               WHEN (TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )  + 90) >                                                                        SYSDATE                                  THEN    (  TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )+ 76)                                       || ' '                                       || SYSDATE                               ELSE    (  TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )                                         + 76                                       )                                    || ' '                                    || (  TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )                                         + 90                                       )                            END                            END AS fec_rango6,                            CASE                               WHEN (    (  TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )                                          + 76                                         )  < = fecha                                     AND (  TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )                                          + 90                                         ) >= fecha                                    )                                  THEN SUM (importe)                            END AS rango_6                       FROM (SELECT oid_movi_cc, fecha, importe                               FROM ((SELECT mov_ccc.oid_movi_cc,                                             mov_ccc.fec_ulti_movi fecha,                                             mov_ccc.imp_pago importe                                        FROM cob_asign_cobra asi_cob,                                             cob_estad_asign est_asg,                                             ccc_movim_cuent_corri mov_ccc                                       WHERE TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )  < = mov_ccc.fec_ulti_movi                                         AND mov_ccc.fec_ulti_movi  < =                                                (CASE                                                    WHEN (  TO_DATE                                                                ( '01/03/2005' , 'dd/MM/yyyy' )                                                          + 90                                                         ) > SYSDATE                                                       THEN SYSDATE                                                    ELSE (  TO_DATE                                                              ( '01/03/2005' , 'dd/MM/yyyy' )                                                          + 90                                                         )                                                 END                                                )                                         AND est_asg.oid_esta_asig =                                                     asi_cob.esas_oid_esta_asig                                         AND (   est_asg.oid_esta_asig = 2                                              OR est_asg.oid_esta_asig = 3                                              OR est_asg.oid_esta_asig = 6                                             )                                         AND asi_cob.pais_oid_pais =  1 	                                          AND TO_DATE (asi_cob.fec_asig) >                                                TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' ))                                     UNION                                     (SELECT hto.mvcc_oid_movi_cc,                                             hto.fec_movi fecha,                                             hto.imp_pago importe                                        FROM cob_asign_cobra asi_cob,                                             cob_estad_asign est_asg,                                             ccc_histo_movim_cc hto,                                             ccc_movim_cuent_corri mov_ccc                                       WHERE mov_ccc.oid_movi_cc =                                                           hto.mvcc_oid_movi_cc                                         AND TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' )  < = hto.fec_movi                                         AND hto.fec_movi  < =                                                (CASE                                                    WHEN (  TO_DATE                                                                ( '01/03/2005' , 'dd/MM/yyyy' )                                                          + 90                                                         ) > SYSDATE                                                       THEN SYSDATE                                                    ELSE (  TO_DATE                                                               ( '01/03/2005' , 'dd/MM/yyyy' )                                                          + 90                                                         )                                                 END                                                )                                         AND est_asg.oid_esta_asig =                                                     asi_cob.esas_oid_esta_asig                                         AND (   est_asg.oid_esta_asig = 2                                              OR est_asg.oid_esta_asig = 3                                              OR est_asg.oid_esta_asig = 6                                             )                                         AND asi_cob.pais_oid_pais =  1 	                                          AND TO_DATE (asi_cob.fec_asig) >                                                TO_DATE ( '01/03/2005' , 'dd/MM/yyyy' ))))                   GROUP BY oid_movi_cc, fecha)         GROUP BY  oid_movi_cc,                  fec_rango1,                  fec_rango2,                  fec_rango3,                  fec_rango4,                  fec_rango5,                  fec_rango6) mov  WHERE cob.oid_movi_cc = mov.oid_movi_cc  ORDER BY  /* ORDENCOLUMNA1*/ ,   /* ORDENCOLUMNA2*/ 	,   /* ORDENCOLUMNA3*/ 	   