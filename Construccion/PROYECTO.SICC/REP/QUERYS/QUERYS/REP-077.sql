 		SELECT SUBG, 	   REGION, 	   ZONA, 	   NUM_CONC, 	   GRUPO_DES, 	   GRUPO_HAS, 	   GRUPO_PEDI, 	   TOTAL_CON_RANGO, 	   (TOTAL_CON_RANGO/TOTAL_CON_CONCU)*100 PORC_CON_RANGO, 	   SUM((CASE WHEN (XX = 1) THEN 	   			 ((TOTAL_CON_RANGO/TOTAL_CON_CONCU)*100) 		    ELSE 				0 			END)) OVER (PARTITION BY SUBG, REGION, ZONA, NUM_CONC ORDER BY GRUPO_DES) PORC_ACUM, 	 	   COUNT(*) CANT_PERI, 	   (COUNT(*)/TOTAL_CON_RANGO)*100 PORC_PERI	    FROM (	 	SELECT SUBG, 		   REGION, 		   ZONA, 		   NUM_CONC, 		   GRUPO, 		   CLIEN, 		   CASE WHEN (GRUPO = 1000) THEN 		   	   GRUPO 		   ELSE 		   	   GRUPO + 1 		   END GRUPO_DES, 		   CASE WHEN (GRUPO  <  3000) THEN 		   		GRUPO + 500 		   ELSE 		   	    GRUPO + 1000 		   END GRUPO_HAS,	    		   SUM(1) OVER (PARTITION BY SUBG, REGION, ZONA, NUM_CONC, GRUPO ORDER BY GRUPO_PEDI) XX,   		   COUNT(CLIEN) OVER (PARTITION BY SUBG, REGION, ZONA, OID_PARA_GRAL, NUM_CONC, GRUPO) TOTAL_CON_RANGO, 		   COUNT(CLIEN) OVER (PARTITION BY SUBG, REGION, ZONA, OID_PARA_GRAL, NUM_CONC) TOTAL_CON_CONCU, 		   GRUPO_PEDI		    	FROM 		( 			SELECT SUBG, 				   REGION, 				   ZONA, 				   OID_PARA_GRAL, 				   NUM_CONC, 				   CLIEN, 				   pq_apl_rep.FN_072_RANGO(META) GRUPO, 				   CASE WHEN (COUNT(*) - 1 = SUM(PASO_PED)) THEN 				   		SUM(PASO_PED)||'-'||COUNT(*) 				   END GRUPO_PEDI 			FROM 				( 				 SELECT DAT.SUBG, 				 		DAT.REGION, 						DAT.ZONA, 						DAT.OID_PARA_GRAL, 						DAT.NUM_CONC, 						DAT.CLIEN, 						DAT.META, 						PERIO.OID_PERI, 						( 						SELECT CASE WHEN (COUNT(*) > 0) THEN 							   		1 							   ELSE 							   	    0 							   END 						FROM PED_SOLIC_CABEC SC 						WHERE SC.CLIE_OID_CLIE = DAT.CLIEN 							  AND SC.PERD_OID_PERI = PERIO.OID_PERI 					    ) PASO_PED 				 FROM 				 	(		 					SELECT SUBG.DES_SUBG_VENT SUBG, 						   REG.DES_REGI REGION, 						   ZONA.DES_ZONA ZONA, 						   CPG.OID_PARA_GRAL, 						   CPG.NUM_CONC, 						   MET.CLIE_OID_CLIE CLIEN, 						   CASE WHEN (CPG.BCAL_OID_BASE_CALC = 1) THEN 						   		MET.VAL_META*MONEDA.TIP_CAM 						   ELSE 						   	   	MET.VAL_META 						   END META, 						   MET.VAL_META/OP.VAL_FACT_CONV*OP.NUM_PUNT_ASIG PUN_META, 						   NVL(( 						   SELECT SUM(CCP.NUM_PUNT) 						   FROM INC_CUENT_CORRI_PUNTO CCP 						   WHERE CCP.CLIE_OID_CLIE = MET.CLIE_OID_CLIE 						   		 AND CCP.COPA_OID_PARA_GRAL = CPG.OID_PARA_GRAL 								 AND CCP.TMOV_OID_TIPO_MOVI  < > 2 						   ), 0) PUN_OBTE, 						   CASE WHEN (CLI.FEC_INGR  < = P_INI.FEC_INIC) THEN 						   	   P_INI.FEC_INIC						    						   ELSE 						   	   ( 							   SELECT FEC_INIC 							   FROM CRA_PERIO P 							   WHERE P.OID_PERI = PERI2.OID_PERI 							   ) 						   END FEC_PERIDESDE, 						   ( 							   SELECT P.FEC_FINA 							   FROM CRA_PERIO P 							   WHERE P.OID_PERI = CPG.PERD_OID_PERI_HAST 						   ) FEC_PERIHASTA 					FROM INC_CONCU_PARAM_GENER CPG, 						 INC_DESCA DES, 						 INC_CAUSA_DESCA CD, 						 MAE_CLIEN_UNIDA_ADMIN CLI_UA, 						 ZON_SUB_GEREN_VENTA SUBG, 						 ZON_REGIO REG, 						 ZON_ZONA ZONA, 						 ZON_SECCI SEC, 						 ZON_TERRI_ADMIN TA, 						 MAE_CLIEN_TIPO_SUBTI CLI_SUB, 						 MAE_CLIEN_CLASI CLA, 						 INC_METAS_TIPO_VENTA MET, 						 INC_OBTEN_PUNTO OP, 						 INC_PLANT_CONCU PLA_CON, 						 MAE_CLIEN CLI, 			 			 ( 						 SELECT CASE WHEN (PAIS.MONE_OID_MONE =  1 ) THEN		 						 			 1 								ELSE 									 (SELECT TC.VAL_TIPO_CAMB 									 FROM SEG_TIPO_CAMBI TC 									 WHERE TC.MONE_OID_MON1 = PAIS.MONE_OID_MONE  									 	   AND TC.MONE_OID_MON2 =  1 		 										   AND TC.FEC_DESD  < = SYSDATE 										   AND TC.FEC_HAST >= SYSDATE 									 ) 								END TIP_CAM 						 FROM SEG_PAIS PAIS 						 WHERE PAIS.OID_PAIS =  1    						 ) MONEDA, 						 ( 						 SELECT P.FEC_INIC 						 FROM INC_CONCU_PARAM_GENER CPG, 						 	  CRA_PERIO P 						 WHERE CPG.OID_PARA_GRAL =  1    						 	   AND CPG.PERD_OID_PERI_DESD = P.OID_PERI 						 ) P_INI, 						 CRA_PERIO PERI2		 		  					WHERE CPG.OID_PARA_GRAL =  1    						  AND DES.COPA_OID_PARA_GRAL = CPG.OID_PARA_GRAL  						  AND DES.CADE_OID_CAUS_DESC = CD.OID_CAUS_DESC 												   						AND CD.COD_CAUS IN ('FC', 'FA') 						   						  AND CLI_UA.CLIE_OID_CLIE = DES.CLIE_OID_CLIE 						  AND CLI_UA.IND_ACTI = 1 						  AND TA.OID_TERR_ADMI = CLI_UA.ZTAD_OID_TERR_ADMI 						  AND SUBG.OID_SUBG_VENT = REG.ZSGV_OID_SUBG_VENT 						  AND REG.OID_REGI = ZONA.ZORG_OID_REGI 						  AND ZONA.OID_ZONA = SEC.ZZON_OID_ZONA 						  AND SEC.OID_SECC = TA.ZSCC_OID_SECC 						  AND CLI.OID_CLIE = MET.CLIE_OID_CLIE 					      AND CLI_SUB.CLIE_OID_CLIE = CLI_UA.CLIE_OID_CLIE 						  AND CLA.CTSU_OID_CLIE_TIPO_SUBT = CLI_SUB.OID_CLIE_TIPO_SUBT 						  AND MET.CLIE_OID_CLIE = CLI_UA.CLIE_OID_CLIE 						  AND MET.COPA_OID_PARA_GRAL = CPG.OID_PARA_GRAL 						  AND OP.COPA_OID_PARA_GRAL = CPG.OID_PARA_GRAL 						  AND PLA_CON.OID_PLAN_CONC = CPG.PLC2_OID_PLAN_CONC 						  AND PERI2.FEC_INIC  < = CLI.FEC_INGR 						  AND PERI2.FEC_FINA >= CLI.FEC_INGR 						  AND PERI2.PAIS_OID_PAIS = SUBG.PAIS_OID_PAIS 						  AND PERI2.MARC_OID_MARC = SUBG.MARC_OID_MARC 						  AND PERI2.CANA_OID_CANA = SUBG.CANA_OID_CANA 						  AND CLI_SUB.IND_PPAL = 1 						  AND CLA.IND_PPAL = 1 						  AND SUBG.PAIS_OID_PAIS =  1   						  AND SUBG.MARC_OID_MARC =  1   						  AND SUBG.CANA_OID_CANA =  1  	 						   						   								  	 AND SUBG.OID_SUBG_VENT IN  ( 1 )  			  AND REG.OID_REGI IN ( 1 )   			     AND ZONA.OID_ZONA IN   ( 1 )  			      AND CLA.TCCL_OID_TIPO_CLASI IN  ( 1 )   			  	  AND CLA.CLAS_OID_CLAS IN ( 1 )   			  	AND CLI_SUB.TICL_OID_TIPO_CLIE IN  ( 1 )  		 			  	   AND CLI_SUB.SBTI_OID_SUBT_CLIE IN ( 1 )      						  AND CPG.BCAL_OID_BASE_CALC =  3   						  AND PLA_CON.TVEN_OID_TIPO_VENT =   1    				) DAT, 				( 				SELECT * 				FROM CRA_PERIO PE 				WHERE PE.PAIS_OID_PAIS =  1   					  AND PE.MARC_OID_MARC =  1   					  AND PE.CANA_OID_CANA =  1  	 				) PERIO 				WHERE PERIO.FEC_INIC >= DAT.FEC_PERIDESDE 					  AND PERIO.FEC_FINA  < = DAT.FEC_PERIHASTA  					 AND PUN_OBTE >= PUN_META 				 					   			  ) 			GROUP BY SUBG, 				   REGION, 				   ZONA, 				   OID_PARA_GRAL, 				   NUM_CONC, 				   CLIEN, 	               META		 		) 	WHERE GRUPO_PEDI IS NOT NULL ) WHERE GRUPO IN ( 1500, 6000, 49000 	) GROUP BY SUBG, 	   REGION, 	   ZONA, 	   NUM_CONC, 	   GRUPO_DES, 	   GRUPO_HAS, 	   TOTAL_CON_RANGO, 	   TOTAL_CON_CONCU,    	   GRUPO_PEDI, 	   XX 	