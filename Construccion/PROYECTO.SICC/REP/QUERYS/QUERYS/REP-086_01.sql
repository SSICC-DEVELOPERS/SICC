select nombrecompleto, sum(tipo_cli_1)tipo_cli_1, sum(tipo_cli_2)tipo_cli_2, sum(tipo_cli_3)tipo_cli_3,  	   sum(tipo_cli_4)tipo_cli_4, sum(tipo_cli_5)tipo_cli_5, sum(tipo_cli_6)tipo_cli_6, sum(pendiente)pendientes, 	   sum(atendida) atendidas, sum(menos_24) menos_24, sum(mas_24_menos_48) mas_24_menos_48, sum(mas_48) mas_48,  	   decode(sum(pendiente + atendida),0,0, sum(fin_inicio) / sum(pendiente + atendida))promedio, 	   count(OID_CONT )total 	from (  	select usu.VAL_APEL_PATE||' '||usu.VAL_APE_MATE||' '||usu.VAL_NOM1||' '||usu.VAL_NOM2 nombrecompleto, 		   con.OID_CONT, 		   case when (con.ticl_oid_tipo_clie =  1 ) then		  		   		1 		   else  		   		0 		   end tipo_cli_1, 		   case when (con.ticl_oid_tipo_clie =  -1 ) then		  		   		1 		   else  		   		0 		   end tipo_cli_2,    		   case when (con.ticl_oid_tipo_clie =  -1 ) then		  		   		1 		   else 		        0 		   end tipo_cli_3, 		   case when (con.ticl_oid_tipo_clie =  -1 ) then		  		   		1 		   else  		   		0 		   end tipo_cli_4, 		   case when (con.ticl_oid_tipo_clie =  -1 ) then 		   		1 		   else 		   	    0 		   end tipo_cli_5, 		   case when (con.ticl_oid_tipo_clie =  -1 ) then	 		   		1 		   else 		        0 		   end tipo_cli_6, 		   decode(est.cod_esta,'03',1,0) atendida, 		   decode(est.cod_esta,'03',0,1)pendiente, 		   		   case when (est.cod_esta = '03') then 		   		case when (nvl(trunc((((86400*(decode(con.fec_hora_cier, null, sysdate, con.fec_hora_cier)-con.val_hora_inic))/60)/60)/24),0)  <  1) then 					 1 				else 					 0 			    end  		   else 		   	   0		   	    		   end menos_24,	 		   case when (est.cod_esta = '03') then 		   		case when ((nvl(trunc((((86400*(decode(con.fec_hora_cier, null, sysdate, con.fec_hora_cier)-con.val_hora_inic))/60)/60)/24),0) >= 1) and (nvl(trunc((((86400*(decode(con.fec_hora_cier, null, sysdate, con.fec_hora_cier)-con.val_hora_inic))/60)/60)/24),0)  <  2)) then 					 1 				else 					 0 			    end  		   else 		   	   0		   	    		   end mas_24_menos_48,	 		   case when (est.cod_esta = '03') then 		   		case when (nvl(trunc((((86400*(decode(con.fec_hora_cier, null, sysdate, con.fec_hora_cier)-con.val_hora_inic))/60)/60)/24),0) >= 2) then 					 1 				else 					 0 			    end  		   else 		   	   0		   	    		   end mas_48, 		   con.val_hora_fin-con.val_hora_inic fin_inicio 	from cal_conta con, 		 cal_motiv_conta mot, 		 cal_atrib_estad_conta atr, 		 cal_tipo_estad_conta est, 		 V_REP_USUAR_LARGO usu 	where con.MOCO_OID_MOTI_CONT = mot.OID_MOTI_CONT 		  and mot.COD_MOTI = '00'	 		  and con.COD_OPER = usu.VAL_NOMB_USUA 		   and con.COD_OPER =  '1'   		  and con.ATEC_OID_ATRI_ESTA_CONT = atr.oid_atri_esta_cont 		  and atr.teco_oid_tipo_esta_cont = est.oid_tipo_esta_cont 		  and con.PAIS_OID_PAIS =  1  		  and con.VAL_HORA_INIC >= to_date( '01/01/2000' ,  'dd/MM/yyyy'  ) 		  and con.VAL_HORA_FIN  < = to_date( '01/01/2099' ,  'dd/MM/yyyy'  )	   		  AND CON.TICL_OID_TIPO_CLIE IN ( 1 , -1 , -1 , -1 , -1 , -1 ) ) group by nombrecompleto order by nombrecompleto