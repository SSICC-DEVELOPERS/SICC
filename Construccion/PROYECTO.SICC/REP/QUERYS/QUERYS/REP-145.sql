 select gen_comis.val_i18n comision,          subg.DES_SUBG_VENT,          reg.DES_REGI,          per3.VAL_NOMB_PERI as per_comision,          cli.VAL_APE1||' '||cli.VAL_APE2||' '||cli.VAL_NOM1||' '||cli.VAL_NOM2 as gerente,          cli2.cod_clie,          cli2.VAL_APE1||' '||cli2.VAL_APE2||' '||cli2.VAL_NOM1||' '||cli2.VAL_NOM2 as cliente,     	   com_cli.IMP_MONT_PAGA,          cpt.NUM_IMPO as monto_neto,          cpt.NUM_IMPO_PAGO as monto_recuperado,          cpt.NUM_IMPO_PAGO * 100 / cpt.NUM_IMPO as por_recuperado,          cpt.NUM_IMPO_PAGO * com_cli.VAL_PORC_COMI / 100 as monto_abonar,          cpt.VAL_EJER_CUOT||'-'||cpt.ID_CUOTA as numero_factura,          cpt.FEC_FECH_DOCU as fecha_factura,          cpt.FEC_FECH_VALO as fecha_pago from zon_regio reg,        zon_sub_geren_venta subg,        cra_perio per3,        mae_clien cli,        mae_clien cli2,        com_comis_cobra_acumu_clien com_cli,        com_comis_cobra_acumu com_acu,        com_cuota_por_tramo_com_calcu cpt,        (         select gen.val_oid, gen.val_i18n         from v_gen_i18n_sicc gen         where gen.attr_enti = 'COM_COMIS'                   and gen.idio_oid_idio =  1         ) gen_comis where       reg.ZSGV_OID_SUBG_VENT = subg.OID_SUBG_VENT        and reg.clie_oid_clie(+) = cli.oid_clie        and com_cli.COC2_OID_COMI_COBR_ACUM = com_acu.OID_COMI_COBR_ACUM        and cpt.ACTR_OID_COMI_COBR_ACUM = com_cli.OID_COMI_COBR_ACUM        and com_acu.CLIE_OID_CLIE = cli.oid_clie        and com_acu.COMI_OID_COMI = gen_comis.val_oid(+)        and com_acu.PERD_OID_PERI = per3.oid_peri        and cpt.CLIE_OID_CLIE = cli2.oid_clie  	    AND (INSTR( 	    ( 		    CASE WHEN (REG.PERD_OID_PERI_FINA IS NOT NULL) THEN 	   		 	 ( 				  	 SELECT PQ_APL_REP.FN_013_FACDTR_CONCAT_PERI(REG.PERD_OID_PERI_INIC, REG.PERD_OID_PERI_FINA) 					 FROM DUAL 				 ) 	 		  	ELSE 	   		 	 ( 				  	 SELECT PQ_APL_REP.FN_013_FACDTR_CONCAT_PERI(REG.PERD_OID_PERI_INIC,( 																		SELECT * 																		FROM 																			(		 																			SELECT P.OID_PERI     																				FROM CRA_PERIO P        																				WHERE P.MARC_OID_MARC =  1           																				AND P.CANA_OID_CANA = 1     																				AND  P.PAIS_OID_PAIS =  1    																				AND SYSDATE  < = P.FEC_FINA         																				AND SYSDATE >= P.FEC_INIC 																			ORDER BY FEC_FINA DESC 	 																			) 																		WHERE ROWNUM = 1 																		)) 					 FROM DUAL 				 ) 	 			END 		), 			 	    	  	 ','|| 57 ||','					 		) > 0)  	    and reg.OID_REGI in ( 1 )    	AND  COM_ACU.PERD_OID_PERI =  57         and subg.OID_SUBG_VENT in ( 1,2,3,4,5,65,7,8,9,10 )        and com_acu.COMI_OID_COMI =  1319         and com_cli.VAL_NIVE_TRAM =  '1'  		 