SELECT LOCAL_, 	   COD_CAJA, 	   COD_ESP, 	   NOM_ESP, 	   COD_OPER, 	   VAL_NUME_SOLI, 	   COD_CLIE, 	   NUM_UNID, 	   VAL_TOTA_PAGA_LOCA TOTAL_FACT, 	       NVL((	 			SELECT SUM(MOV_CAJ_DET.IMP_MOVI) IMPORTE 			    			FROM BEL_MEDIO_PAGO MED_PAG, 			 	  BEL_MEDIO_PAGO_BELCE MED_PAG_BEL, 				  BEL_MOVIM_CAJA_DETAL MOV_CAJ_DET, 				  BEL_TIPO_MEDIO_PAGO TIP_MED_PAG			 			WHERE MED_PAG_BEL.MPAB_OID_MEDI_PAGO = MED_PAG.OID_MEDI_PAGO 				  AND TIP_MED_PAG.OID_TIPO_MEDI_PAGO = MED_PAG.TMEP_OID_TIPO_MEDI_PAGO 				  AND TIP_MED_PAG.OID_TIPO_MEDI_PAGO = 1 				  AND MOV_CAJ_DET.MCAC_OID_CABE = TABLA.OID_CABE  				  AND MOV_CAJ_DET.MPBC_OID_MEDI_PAGO_BELC = MED_PAG_BEL.OID_MEDI_PAGO_BELC 				  AND MOV_CAJ_DET.IMP_MOVI >= 0			    			GROUP BY TIP_MED_PAG.OID_TIPO_MEDI_PAGO 		), 0) IMP_ENTRE, 		         	   NVL((	 			SELECT SUM(MOV_CAJ_DET.IMP_MOVI) IMPORTE 			    			FROM BEL_MEDIO_PAGO MED_PAG, 			 	  BEL_MEDIO_PAGO_BELCE MED_PAG_BEL, 				  BEL_MOVIM_CAJA_DETAL MOV_CAJ_DET, 				  BEL_TIPO_MEDIO_PAGO TIP_MED_PAG 			WHERE MED_PAG_BEL.MPAB_OID_MEDI_PAGO = MED_PAG.OID_MEDI_PAGO 				  AND TIP_MED_PAG.OID_TIPO_MEDI_PAGO = MED_PAG.TMEP_OID_TIPO_MEDI_PAGO 				  AND TIP_MED_PAG.OID_TIPO_MEDI_PAGO = 5 				  AND TABLA.OID_CABE = MOV_CAJ_DET.MCAC_OID_CABE 				  AND MOV_CAJ_DET.MPBC_OID_MEDI_PAGO_BELC = MED_PAG_BEL.OID_MEDI_PAGO_BELC			    			GROUP BY TIP_MED_PAG.OID_TIPO_MEDI_PAGO 		),0) NOTA_CRED, 		         NVL((	 			SELECT SUM(MOV_CAJ_DET.IMP_MOVI) IMPORTE 			    			FROM BEL_MEDIO_PAGO MED_PAG, 			 	  BEL_MEDIO_PAGO_BELCE MED_PAG_BEL, 				  BEL_MOVIM_CAJA_DETAL MOV_CAJ_DET, 				  BEL_TIPO_MEDIO_PAGO TIP_MED_PAG 			WHERE MED_PAG_BEL.MPAB_OID_MEDI_PAGO = MED_PAG.OID_MEDI_PAGO 				  AND TIP_MED_PAG.OID_TIPO_MEDI_PAGO = MED_PAG.TMEP_OID_TIPO_MEDI_PAGO 				  AND TIP_MED_PAG.OID_TIPO_MEDI_PAGO = 2 				  AND TABLA.OID_CABE = MOV_CAJ_DET.MCAC_OID_CABE 				  AND MOV_CAJ_DET.MPBC_OID_MEDI_PAGO_BELC = MED_PAG_BEL.OID_MEDI_PAGO_BELC			    			GROUP BY TIP_MED_PAG.OID_TIPO_MEDI_PAGO 		),0) TARJETA, 		         NVL((	 			SELECT SUM(MOV_CAJ_DET.IMP_MOVI) IMPORTE 			    			FROM BEL_MEDIO_PAGO MED_PAG, 			 	  BEL_MEDIO_PAGO_BELCE MED_PAG_BEL, 				  BEL_MOVIM_CAJA_DETAL MOV_CAJ_DET, 				  BEL_TIPO_MEDIO_PAGO TIP_MED_PAG 			WHERE MED_PAG_BEL.MPAB_OID_MEDI_PAGO = MED_PAG.OID_MEDI_PAGO 				  AND TIP_MED_PAG.OID_TIPO_MEDI_PAGO = MED_PAG.TMEP_OID_TIPO_MEDI_PAGO 				  AND TIP_MED_PAG.OID_TIPO_MEDI_PAGO = 3 				  AND TABLA.OID_CABE = MOV_CAJ_DET.MCAC_OID_CABE 				  AND MOV_CAJ_DET.MPBC_OID_MEDI_PAGO_BELC = MED_PAG_BEL.OID_MEDI_PAGO_BELC			    			GROUP BY TIP_MED_PAG.OID_TIPO_MEDI_PAGO 		),0) CHEQUE, 		         NVL((	 			SELECT SUM(MOV_CAJ_DET.IMP_MOVI) IMPORTE 			    			FROM BEL_MEDIO_PAGO MED_PAG, 			 	  BEL_MEDIO_PAGO_BELCE MED_PAG_BEL, 				  BEL_MOVIM_CAJA_DETAL MOV_CAJ_DET, 				  BEL_TIPO_MEDIO_PAGO TIP_MED_PAG 			WHERE MED_PAG_BEL.MPAB_OID_MEDI_PAGO = MED_PAG.OID_MEDI_PAGO 				  AND TIP_MED_PAG.OID_TIPO_MEDI_PAGO = MED_PAG.TMEP_OID_TIPO_MEDI_PAGO 				  AND TIP_MED_PAG.OID_TIPO_MEDI_PAGO = 4 				  AND TABLA.OID_CABE = MOV_CAJ_DET.MCAC_OID_CABE 				  AND MOV_CAJ_DET.MPBC_OID_MEDI_PAGO_BELC = MED_PAG_BEL.OID_MEDI_PAGO_BELC			    			GROUP BY TIP_MED_PAG.OID_TIPO_MEDI_PAGO 		),0) VALE_C, 				         NVL((	 			SELECT SUM(MOV_CAJ_DET.IMP_MOVI) IMPORTE 			    			FROM BEL_MEDIO_PAGO MED_PAG, 			 	  BEL_MEDIO_PAGO_BELCE MED_PAG_BEL, 				  BEL_MOVIM_CAJA_DETAL MOV_CAJ_DET, 				  BEL_TIPO_MEDIO_PAGO TIP_MED_PAG 			WHERE MED_PAG_BEL.MPAB_OID_MEDI_PAGO = MED_PAG.OID_MEDI_PAGO 				  AND TIP_MED_PAG.OID_TIPO_MEDI_PAGO = MED_PAG.TMEP_OID_TIPO_MEDI_PAGO 				  AND TIP_MED_PAG.OID_TIPO_MEDI_PAGO  < > 5 				  AND TIP_MED_PAG.OID_TIPO_MEDI_PAGO  < > 2 				  AND TIP_MED_PAG.OID_TIPO_MEDI_PAGO  < > 3 				  AND TIP_MED_PAG.OID_TIPO_MEDI_PAGO  < > 4 				  AND TIP_MED_PAG.OID_TIPO_MEDI_PAGO  < > 1															   				  AND MOV_CAJ_DET.MCAC_OID_CABE = TABLA.OID_CABE  				  AND MOV_CAJ_DET.MPBC_OID_MEDI_PAGO_BELC = MED_PAG_BEL.OID_MEDI_PAGO_BELC			    			GROUP BY MOV_CAJ_DET.MCAC_OID_CABE  		),0) OTROS, 			         NVL((	 			SELECT SUM(MOV_CAJ_DET.IMP_MOVI) IMPORTE 			    			FROM BEL_MEDIO_PAGO MED_PAG, 			 	  BEL_MEDIO_PAGO_BELCE MED_PAG_BEL, 				  BEL_MOVIM_CAJA_DETAL MOV_CAJ_DET, 				  BEL_TIPO_MEDIO_PAGO TIP_MED_PAG 			WHERE MED_PAG_BEL.MPAB_OID_MEDI_PAGO = MED_PAG.OID_MEDI_PAGO 				  AND TIP_MED_PAG.OID_TIPO_MEDI_PAGO = MED_PAG.TMEP_OID_TIPO_MEDI_PAGO 				  AND TIP_MED_PAG.OID_TIPO_MEDI_PAGO = 1															   				  AND TABLA.OID_CABE = MOV_CAJ_DET.MCAC_OID_CABE 				  AND MOV_CAJ_DET.MPBC_OID_MEDI_PAGO_BELC = MED_PAG_BEL.OID_MEDI_PAGO_BELC			    			GROUP BY TIP_MED_PAG.OID_TIPO_MEDI_PAGO 		),0) MON_NAC, 		         NVL((		 			SELECT SUM(MOV_CAJ_DET.IMP_DIVI) IMPORTE 			    			FROM BEL_MEDIO_PAGO MED_PAG, 			 	  BEL_MEDIO_PAGO_BELCE MED_PAG_BEL, 				  BEL_MOVIM_CAJA_DETAL MOV_CAJ_DET, 				  BEL_TIPO_MEDIO_PAGO TIP_MED_PAG 			WHERE MED_PAG_BEL.MPAB_OID_MEDI_PAGO = MED_PAG.OID_MEDI_PAGO 				  AND TIP_MED_PAG.OID_TIPO_MEDI_PAGO = MED_PAG.TMEP_OID_TIPO_MEDI_PAGO 				  AND TIP_MED_PAG.OID_TIPO_MEDI_PAGO = 1															   				  AND TABLA.OID_CABE = MOV_CAJ_DET.MCAC_OID_CABE 				  AND MOV_CAJ_DET.MPBC_OID_MEDI_PAGO_BELC = MED_PAG_BEL.OID_MEDI_PAGO_BELC			    			GROUP BY TIP_MED_PAG.OID_TIPO_MEDI_PAGO 		),0) MON_EXT, 		         NVL((		 			SELECT SUM(MOV_CAJ_DET.IMP_MOVI) IMPORTE 			    			FROM BEL_MEDIO_PAGO MED_PAG, 			 	  BEL_MEDIO_PAGO_BELCE MED_PAG_BEL, 				  BEL_MOVIM_CAJA_DETAL MOV_CAJ_DET, 				  BEL_TIPO_MEDIO_PAGO TIP_MED_PAG 			WHERE MED_PAG_BEL.MPAB_OID_MEDI_PAGO = MED_PAG.OID_MEDI_PAGO 				  AND TIP_MED_PAG.OID_TIPO_MEDI_PAGO = MED_PAG.TMEP_OID_TIPO_MEDI_PAGO 				  AND TIP_MED_PAG.OID_TIPO_MEDI_PAGO = 1															   				  AND TABLA.OID_CABE = MOV_CAJ_DET.MCAC_OID_CABE 				  AND MOV_CAJ_DET.MPBC_OID_MEDI_PAGO_BELC = MED_PAG_BEL.OID_MEDI_PAGO_BELC 				  AND MOV_CAJ_DET.IMP_MOVI  <  0			    			GROUP BY TIP_MED_PAG.OID_TIPO_MEDI_PAGO 		),0) MON_VUELTO	 FROM (  	(  	SELECT SUBA.COD_SBAC||' '||GEN_SUBA.VAL_I18N LOCAL_, 		   CAJA.COD_CAJA, 		   SOL_CAB.VAL_USUA COD_ESP, 		   USU.VAL_NOM1||''||USU.VAL_APEL_PATE NOM_ESP,  		   'VT' COD_OPER,    		   SOL_CAB.VAL_NUME_SOLI, 		   CLI.COD_CLIE, 		   SOL_POS.NUM_UNID_VENT NUM_UNID, 		   SOL_CAB.VAL_TOTA_PAGA_LOCA, 		   SUBA.OID_SBAC, 		   BEL_MOV_CAJ_CAB.OID_CABE, 		   SOL_POS.OID_SOLI_POSI 	FROM BEL_MOVIM_CAJA_CABEC BEL_MOV_CAJ_CAB, 		 PED_SOLIC_CABEC SOL_CAB, 		 BEL_CAJA CAJA, 		 SEG_SUBAC SUBA, 		 MAE_CLIEN CLI, 		 V_REP_USUAR_LARGO USU, 		 PED_TIPO_SOLIC TIP_SOL, 		 PED_TIPO_SOLIC_PAIS TIP_SOL_PAIS, 		 PED_SOLIC_POSIC SOL_POS, 		 SEG_ACCES ACCE, 		 ( 		 SELECT GEN.VAL_OID, GEN.VAL_I18N	  		 FROM V_GEN_I18N_SICC GEN 		 WHERE GEN.ATTR_ENTI = 'SEG_SUBAC' 		 	   AND GEN.IDIO_OID_IDIO =  1  		 ) GEN_SUBA 	WHERE SOL_CAB.OID_SOLI_CABE = BEL_MOV_CAJ_CAB.SOCA_OID_SOLI_CABE 		  AND CAJA.OID_CAJA = BEL_MOV_CAJ_CAB.CAJA_OID_CAJA 		  AND SOL_CAB.IND_TS_NO_CONSO  < > 1 		  AND SOL_CAB.IND_PEDI_PRUE  < > 1 		  AND SOL_CAB.SBAC_OID_SBAC = SUBA.OID_SBAC 		  AND CLI.OID_CLIE = SOL_CAB.CLIE_OID_CLIE 		  AND USU.VAL_NOMB_USUA = SOL_CAB.VAL_USUA 		  AND TIP_SOL.OID_TIPO_SOLI = TIP_SOL_PAIS.TSOL_OID_TIPO_SOLI 		  AND TIP_SOL_PAIS.OID_TIPO_SOLI_PAIS = SOL_CAB.TSPA_OID_TIPO_SOLI_PAIS 		  AND TIP_SOL_PAIS.PAIS_OID_PAIS = CAJA.PAIS_OID_PAIS 		  AND SOL_POS.SOCA_OID_SOLI_CABE = SOL_CAB.OID_SOLI_CABE   		  AND SUBA.ACCE_OID_ACCE = ACCE.OID_ACCE 		  AND SUBA.OID_SBAC = GEN_SUBA.VAL_OID(+)  		  AND SOL_POS.NUM_UNID_VENT IS NOT NULL 		  AND SOL_POS.NUM_UNID_VENT  < > 0 		  AND TO_DATE(BEL_MOV_CAJ_CAB.FEC_MOVI) >= TO_DATE(  '01/01/2000'  ,  'dd/MM/yyyy' ) 		  AND TO_DATE(BEL_MOV_CAJ_CAB.FEC_MOVI)  < = TO_DATE( '01/01/2050' ,  'dd/MM/yyyy'  )    		  AND CAJA.PAIS_OID_PAIS =  1  		   AND SOL_CAB.SBAC_OID_SBAC IN (  8  )  		   AND CAJA.OID_CAJA IN (  1  )  		  AND TIP_SOL.ACCE_OID_ACCE =  1 	   		  AND ACCE.CANA_OID_CANA =  1  	) 	UNION ALL 	(  	SELECT SUBA.COD_SBAC||' '||GEN_SUBA.VAL_I18N LOCAL_, 		   CAJA.COD_CAJA, 		   SOL_CAB.VAL_USUA COD_ESP, 		   USU.VAL_NOM1||''||USU.VAL_APEL_PATE NOM_ESP,  		   'CM' COD_OPER,    		   SOL_CAB.VAL_NUME_SOLI, 		   CLI.COD_CLIE, 		   SOL_POS.NUM_UNID_CAMB NUM_UNID, 		   SOL_CAB.VAL_TOTA_PAGA_LOCA, 		   SUBA.OID_SBAC, 		   BEL_MOV_CAJ_CAB.OID_CABE, 		   SOL_POS.OID_SOLI_POSI 	FROM BEL_MOVIM_CAJA_CABEC BEL_MOV_CAJ_CAB, 		 PED_SOLIC_CABEC SOL_CAB, 		 BEL_CAJA CAJA, 		 SEG_SUBAC SUBA, 		 MAE_CLIEN CLI, 		 V_REP_USUAR_LARGO USU, 		 PED_TIPO_SOLIC TIP_SOL, 		 PED_TIPO_SOLIC_PAIS TIP_SOL_PAIS, 		 PED_SOLIC_POSIC SOL_POS, 		 SEG_ACCES ACCE, 		 ( 		 SELECT GEN.VAL_OID, GEN.VAL_I18N	  		 FROM V_GEN_I18N_SICC GEN 		 WHERE GEN.ATTR_ENTI = 'SEG_SUBAC' 		 	   AND GEN.IDIO_OID_IDIO =  1  		 ) GEN_SUBA 	WHERE SOL_CAB.OID_SOLI_CABE = BEL_MOV_CAJ_CAB.SOCA_OID_SOLI_CABE 		  AND CAJA.OID_CAJA = BEL_MOV_CAJ_CAB.CAJA_OID_CAJA 		  AND SOL_CAB.IND_TS_NO_CONSO  < > 1 		  AND SOL_CAB.IND_PEDI_PRUE  < > 1 		  AND SOL_CAB.SBAC_OID_SBAC = SUBA.OID_SBAC 		  AND CLI.OID_CLIE = SOL_CAB.CLIE_OID_CLIE 		  AND USU.VAL_NOMB_USUA = SOL_CAB.VAL_USUA 		  AND TIP_SOL.OID_TIPO_SOLI = TIP_SOL_PAIS.TSOL_OID_TIPO_SOLI 		  AND TIP_SOL_PAIS.OID_TIPO_SOLI_PAIS = SOL_CAB.TSPA_OID_TIPO_SOLI_PAIS 		  AND TIP_SOL_PAIS.PAIS_OID_PAIS = CAJA.PAIS_OID_PAIS 		  AND SUBA.ACCE_OID_ACCE = ACCE.OID_ACCE 		  AND SOL_POS.SOCA_OID_SOLI_CABE = SOL_CAB.OID_SOLI_CABE 		  AND SUBA.OID_SBAC = GEN_SUBA.VAL_OID(+) 		  AND SOL_POS.NUM_UNID_CAMB IS NOT NULL 		  AND SOL_POS.NUM_UNID_CAMB  < > 0 		  AND TO_DATE(BEL_MOV_CAJ_CAB.FEC_MOVI) >= TO_DATE(  '01/01/2000'  ,  'dd/MM/yyyy' ) 		  AND TO_DATE(BEL_MOV_CAJ_CAB.FEC_MOVI)  < = TO_DATE( '01/01/2050' ,  'dd/MM/yyyy'  )    		  AND CAJA.PAIS_OID_PAIS =  1  		   AND SOL_CAB.SBAC_OID_SBAC IN (  8  )  		   AND CAJA.OID_CAJA IN (  1  )  		  AND TIP_SOL.ACCE_OID_ACCE =  1 	   		  AND ACCE.CANA_OID_CANA =  1  	) ) TABLA ORDER BY     	   COD_CLIE, 	   VAL_NUME_SOLI DESC