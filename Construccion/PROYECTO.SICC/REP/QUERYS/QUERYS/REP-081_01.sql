SELECT SUBG, 	   REGION, 	   COD_CLI_RECTE, 	   PERIODO, 	   NOMBRE_RECTE, 	   COD_CLIE_RECDO, 	   NOMBRE_RECDO, 	   CASE WHEN (CONTROL = 1) THEN 	   	   L_CALI 	   END L_CALI, 	   CASE WHEN (CONTROL = 1) THEN 	   	   VENTA_IND_RECTE 	   END VENTA_IND_RECTE, 	   CASE WHEN (CONTROL = 1) THEN 	   	   BENEFICIO 	   END BENEFICIO, 	   CASE WHEN (CONTROL = 1) THEN 	   	   PROM_BENE 	   END PROM_BENE, 	   VENTA_IND_RECDA FROM( 		SELECT SUBG, 	   REGION, 	   COD_CLI_RECTE, 	   PERIODO, 	   NOMBRE_RECTE, 	   COD_CLIE_RECDO, 	   NOMBRE_RECDO, 	   L_CALI, 	   VENTA_IND_RECTE, 	   BENEFICIO, 	   DECODE((SUM(BENEFICIO) OVER (PARTITION BY SUBG, REGION, COD_CLI_RECTE)), 0, 0, BENEFICIO/(SUM(BENEFICIO) OVER (PARTITION BY SUBG, REGION, COD_CLI_RECTE))) PROM_BENE, 	 	   VENTA_IND_RECDA, 	      SUM(1) OVER (PARTITION BY SUBG,REGION,COD_CLI_RECTE, PERIODO ORDER BY ROWNUM) CONTROL FROM ( 	SELECT SUBG, 		   REGION, 		   PERIODO, 		   COD_CLI_RECTE, 		   NOMBRE_RECTE, 		   CASE WHEN (L_CALI = 1) THEN 		   		'SI' 		   ELSE 		   	    'NO' 		   END L_CALI, 		   VENTA_IND_RECTE, 		   CASE WHEN (L_CALI = 1) THEN 		   		SUM(VENTA_IND_RECDA) OVER (PARTITION BY SUBG, REGION, PERIODO, COD_CLI_RECTE) 		   ELSE 		   	   0 		   END BENEFICIO,	 		   COD_CLIE_RECDO, 		   NOMBRE_RECDO, 		   VENTA_IND_RECDA   	    	FROM 	( 		SELECT SUBG.DES_SUBG_VENT SUBG, 			   REG.DES_REGI REGION, 			   CLI1.COD_CLIE COD_CLI_RECTE, 			   CLI1.VAL_APE1||' '||CLI1.VAL_APE2||' '||CLI1.VAL_NOM1||' '||CLI1.VAL_NOM2 NOMBRE_RECTE, 			   PERI.VAL_NOMB_PERI PERIODO, 			   ( 				   SELECT 1 				   FROM INC_SOLIC_CONCU_PUNTA SCP 				   WHERE SCP.CLIE_OID_CLIE = CRM.CLIE_OID_CLIE 				   		 AND SCP.COPA_OID_PARA_GRAL = CGP.OID_PARA_GRAL 						 AND SCP.PERD_OID_PERI = PERI.OID_PERI 		 	   ) L_CALI, 			   ( 				   SELECT PRM.VAL_CANT 				   FROM INC_PEDID_RECTE_MULTI PRM 				   WHERE PRM.CLR2_CLIE_OID_CLIE = CRM.CLIE_OID_CLIE 				   		 AND PRM.PERD_OID_PERI = PERI.OID_PERI 			   ) VENTA_IND_RECTE, 			   CLI2.COD_CLIE COD_CLIE_RECDO, 			   CLI2.VAL_APE1||' '||CLI2.VAL_APE2||' '||CLI2.VAL_NOM1||' '||CLI2.VAL_NOM2 NOMBRE_RECDO, 			   ( 			   	   SELECT PRD.NUM_CANT 				   FROM INC_PEDID_RECDA_MULTI PRD 				   WHERE PRD.CLRM_OID_CLIE_RECO_MULT = CRD.OID_CLIE_RECO_MULT 				   		 AND PRD.PERD_OID_PERI = PERI.OID_PERI 			   ) VENTA_IND_RECDA	   		FROM INC_CONCU_PARAM_GENER CGP, 			 ( 				 SELECT FEC_FINA  				 FROM CRA_PERIO  				 WHERE OID_PERI =   1    			 ) P_FF, 			 ( 			 SELECT * 			 FROM CRA_PERIO PE 			 WHERE PE.OID_PERI = ( 				 SELECT CASE WHEN (P_FI.FEC_INIC  < = P_5.FEC_INIC) THEN 				 			 P_5.OID_PERI 						ELSE 							 P_FI.OID_PERI 						END   				 FROM CRA_PERIO P_FI, 				 	  INC_CONCU_PARAM_GENER CPG, 					  ( 						  SELECT * 						  FROM CRA_PERIO P 						  WHERE P.OID_PERI =  ( 											  SELECT pq_apl_rep.FN_008_CALC_OID_PER_ANT( 1 , 1 , 1 , 1 ,5)	 											  FROM DUAL 											  ) 					  ) P_5 				 WHERE P_FI.OID_PERI = CPG.PERD_OID_PERI_DESD 				 	   AND CPG.OID_PARA_GRAL =  1  				) 			 ) P_FI, 			 CRA_PERIO PERI, 			 INC_PLANT_CONCU PLA, 			 INC_CONCU_PARAM_CONSU CPC, 			 INC_MONTO_VENTA_RECOM MVR, 			 INC_OBTEN_PUNTO OP, 			 INC_MULTI MUL, 			 INC_CLIEN_RECTE_MULTI CRM, 			 MAE_CLIEN_UNIDA_ADMIN CUA, 			 ZON_SUB_GEREN_VENTA SUBG, 			 ZON_REGIO REG, 			 ZON_ZONA ZONA, 			 ZON_SECCI SEC, 			 ZON_TERRI_ADMIN TA, 			 INC_CLIEN_RECDO_MULTI CRD, 			 MAE_CLIEN CLI1, 			 MAE_CLIEN CLI2  		WHERE CGP.OID_PARA_GRAL = CPC.COPA_OID_PARA_GRAL 			  AND MVR.COPA_OID_PARA_GRAL = CGP.OID_PARA_GRAL 			  AND OP.COPA_OID_PARA_GRAL = CGP.OID_PARA_GRAL 			  AND MUL.COPA_OID_PARA_GRAL = CGP.OID_PARA_GRAL 			  AND CRM.COPA_OID_PARA_GRAL = CGP.OID_PARA_GRAL 			  AND CGP.PLC2_OID_PLAN_CONC = PLA.OID_PLAN_CONC 			  AND P_FI.FEC_INIC  < = PERI.FEC_INIC 			  AND P_FF.FEC_FINA >= PERI.FEC_FINA 			  AND CUA.CLIE_OID_CLIE = CRM.CLIE_OID_CLIE 			  AND CUA.IND_ACTI = 1 			  AND CGP.IND_ACTI = 1 			  AND SUBG.OID_SUBG_VENT = REG.ZSGV_OID_SUBG_VENT 			  AND REG.OID_REGI = ZONA.ZORG_OID_REGI 			  AND ZONA.OID_ZONA = SEC.ZZON_OID_ZONA 			  AND SEC.OID_SECC = TA.ZSCC_OID_SECC 			  AND TA.OID_TERR_ADMI = CUA.ZTAD_OID_TERR_ADMI 			 AND CRM.OID_CLIE_RECO_MULT = CRD.CLR2_CLIE_OID_CLIE 			   AND CRM.CLIE_OID_CLIE = CLI1.OID_CLIE 			  AND CRD.CLIE_OID_CLIE = CLI2.OID_CLIE   			  AND P_FI.PAIS_OID_PAIS = PERI.PAIS_OID_PAIS 			  AND P_FI.MARC_OID_MARC = PERI.MARC_OID_MARC 			  AND P_FI.CANA_OID_CANA = PERI.CANA_OID_CANA     		  AND PLA.TVEN_OID_TIPO_VENT =  1      		          AND SUBG.OID_SUBG_VENT IN  ( 1 )  	   AND REG.OID_REGI IN ( 1 )   	  AND CGP.OID_PARA_GRAL =   1  	)		  ))  