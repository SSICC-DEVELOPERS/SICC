 SELECT GEN_COMIS.VAL_I18N AS COMISION, 	   PERI.VAL_NOMB_PERI, 	   SUBG.COD_SUBG_VENT,	   	   REG.COD_REGI, 	   REG.DES_REGI, 	   NVL(( 	   SELECT SUM(VEN_PRE.VAL_VENT_NETA_ESTA) 	   FROM INT_FUENT_VENTA_PREVI_SAP VEN_PRE  	   WHERE VEN_PRE.ZORG_OID_REGI = REG.OID_REGI 	   		 AND VEN_PRE.PERD_OID_PERI = COM_CAL.PERD_OID_PERI 	   GROUP BY VEN_PRE.ZORG_OID_REGI, 	   		    VEN_PRE.PERD_OID_PERI 	   ), 0) AS VENTA, 	   NVL(( 	   SELECT SUM(VEN_REA.IMP_VENT_NETA_ESTA) 	   FROM INT_FUENT_VENTA_REAL_VACUM VEN_REA 	   WHERE VEN_REA.PERD_OID_PERI = COM_CAL.PERD_OID_PERI 			 AND VEN_REA.ZORG_OID_REGI = REG.OID_REGI 	   GROUP BY VEN_REA.ZORG_OID_REGI, 	   		    VEN_REA.PERD_OID_PERI 	   ), 0) AS BASE_COMISION,    	   SUM(COM_CAL.IMP_COMI) IMPORTE_COMISION, 	   TRUNC(DECODE(NVL(( 	   SELECT SUM(VEN_PRE.VAL_VENT_NETA_ESTA) 	   FROM INT_FUENT_VENTA_PREVI_SAP VEN_PRE  	   WHERE VEN_PRE.ZORG_OID_REGI = REG.OID_REGI 	   		 AND VEN_PRE.PERD_OID_PERI = COM_CAL.PERD_OID_PERI 	   GROUP BY VEN_PRE.ZORG_OID_REGI, 	   		    VEN_PRE.PERD_OID_PERI 	   ), 0), 0, 0,NVL(( 	   SELECT SUM(VEN_REA.IMP_VENT_NETA_ESTA) 	   FROM INT_FUENT_VENTA_REAL_VACUM VEN_REA 	   WHERE VEN_REA.PERD_OID_PERI = COM_CAL.PERD_OID_PERI 			 AND VEN_REA.ZORG_OID_REGI = REG.OID_REGI 	   GROUP BY VEN_REA.ZORG_OID_REGI, 	   		    VEN_REA.PERD_OID_PERI 	   ), 0) / NVL(( 	   SELECT SUM(VEN_PRE.VAL_VENT_NETA_ESTA) 	   FROM INT_FUENT_VENTA_PREVI_SAP VEN_PRE  	   WHERE VEN_PRE.ZORG_OID_REGI = REG.OID_REGI 	   		 AND VEN_PRE.PERD_OID_PERI = COM_CAL.PERD_OID_PERI 	   GROUP BY VEN_PRE.ZORG_OID_REGI, 	   		    VEN_PRE.PERD_OID_PERI 	   ), 0)), 3) AS PARTICIPACION FROM ZON_SUB_GEREN_VENTA SUBG, 	 ZON_REGIO REG, 	 COM_COMIS_CALCU COM_CAL, 	 COM_COMIS COM, 	 CRA_PERIO PERI, 	 ( 		 SELECT GEN.VAL_OID, GEN.VAL_I18N 		 FROM V_GEN_I18N_SICC GEN 		 WHERE GEN.ATTR_ENTI = 'COM_COMIS' 		 	   AND GEN.IDIO_OID_IDIO =  1  	 ) GEN_COMIS WHERE SUBG.OID_SUBG_VENT = REG.ZSGV_OID_SUBG_VENT 	  AND PERI.OID_PERI = COM_CAL.PERD_OID_PERI 	  	    AND (INSTR( 	    ( 		    CASE WHEN (REG.PERD_OID_PERI_FINA IS NOT NULL) THEN 	   		 	 ( 				  	 SELECT PQ_APL_REP.FN_013_FACDTR_CONCAT_PERI(REG.PERD_OID_PERI_INIC, REG.PERD_OID_PERI_FINA) 					 FROM DUAL 				 ) 	 		  	ELSE 	   		 	 ( 				  	 SELECT PQ_APL_REP.FN_013_FACDTR_CONCAT_PERI(REG.PERD_OID_PERI_INIC,( 																		SELECT * 																		FROM 																			(		 																			SELECT P.OID_PERI     																				FROM CRA_PERIO P        																				WHERE P.MARC_OID_MARC =  1           																				AND P.CANA_OID_CANA = 1     																				AND  P.PAIS_OID_PAIS =  1    																				AND SYSDATE  < = P.FEC_FINA         																				AND SYSDATE >= P.FEC_INIC 																			ORDER BY FEC_FINA DESC 	 																			) 																		WHERE ROWNUM = 1 																		)) 					 FROM DUAL 				 ) 	 			END 		), 			 	    	  	 ','||COM_CAL.PERD_OID_PERI||','					 		) > 0) 	  AND COM_CAL.CLIE_OID_CLIE = REG.CLIE_OID_CLIE 	  AND COM_CAL.COMI_OID_COMI = COM.OID_COMI 	  AND COM.OID_COMI= GEN_COMIS.VAL_OID(+) 	  AND COM_CAL.PERD_OID_PERI IN ( 43 ) 	   AND SUBG.OID_SUBG_VENT IN ( 1 )  	  AND SUBG.MARC_OID_MARC =   1  	  AND SUBG.CANA_OID_CANA =   1  	  AND SUBG.PAIS_OID_PAIS =   1  	   AND REG.OID_REGI IN ( 1 )  	  AND COM.OID_COMI =   1  	  AND COM.IND_VENT_COBR =   'C' 	   GROUP BY  GEN_COMIS.VAL_I18N, 	  	  COM_CAL.PERD_OID_PERI,           PERI.VAL_NOMB_PERI, 	      SUBG.COD_SUBG_VENT,	             REG.COD_REGI, 	      REG.DES_REGI, 	  	 REG.OID_REGI 		 		 