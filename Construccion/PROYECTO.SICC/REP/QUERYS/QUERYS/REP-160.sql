 SELECT SUBSTR(ACUM.PERIODO, LENGTH(ACUM.PERIODO)-1) PERIODO, 	   			  ACUM.TIPO_OFER, 				  GEN_UNID_NEGO.VAL_I18N UN_NEG,   				  SUM(DIARIO.N_PED) OVER (PARTITION BY PERIODO) N_PEDIDOS_DIARIO, 				  SUM(ACUM.N_PED) OVER (PARTITION BY PERIODO) N_PEDIDOS_ACUM,				     				  DIARIO.MONTO MONTO_DIARIO, 				  DIARIO.PMP PMP_DIARIO, 				  DIARIO.UNID_ATEN UNID_ATEN_DIARIO, 				  DIARIO.PUP PUP_DIARIO, 				  ACUM.MONTO MONTO_ACUM, 				  ACUM.PMP PMP_ACUM, 				  ACUM.UNID_ATEN UNID_ATEN_ACUM, 				  ACUM.PUP PUP_ACUM FROM ( 		SELECT PER.OID_PERI, 			   			  RCA.OID_CODI_AGRU OID_CODI_AGRU, 						  MUN.OID_UNID_NEGO, 						  SUM(PSP.VAL_PREC_NETO_TOTA_LOCA) MONTO, 						  DECODE(COUNT(DISTINCT PSC.OID_SOLI_CABE),0,0, SUM(PSP.VAL_PREC_NETO_TOTA_LOCA)/COUNT(DISTINCT PSC.OID_SOLI_CABE)) PMP, 						  SUM(PSP.NUM_UNID_ATEN) UNID_ATEN, 						  DECODE(COUNT(DISTINCT PSC.OID_SOLI_CABE),0,0, SUM(PSP.NUM_UNID_ATEN)/COUNT(DISTINCT PSC.OID_SOLI_CABE)) PUP, 						  COUNT(DISTINCT PSC.OID_SOLI_CABE) N_PED 		FROM PED_SOLIC_CABEC PSC, 			 		  CRA_PERIO PER, 					  SEG_ACCES ACE, 					  SEG_SUBAC SUB, 					  PED_SOLIC_POSIC PSP, 					  MAE_NEGOC NEG, 					  MAE_UNIDA_NEGOC MUN, 					  MAE_PRODU MP, 					  CRA_PERIO PER_INI, 					  CRA_PERIO PER_FIN, 					  PRE_OFERT_DETAL POD, 					  REP_AGRUP_TIPO_OFERT ATO, 					  REP_CODIG_AGRUP RCA 		WHERE PER.OID_PERI = PSC.PERD_OID_PERI 			  AND PER.PAIS_OID_PAIS = PSC.PAIS_OID_PAIS 			  AND PSC.SBAC_OID_SBAC = SUB.OID_SBAC 			  AND SUB.ACCE_OID_ACCE = ACE.OID_ACCE 			  AND PSC.IND_PEDI_PRUE  < > 1 			  AND PSC.IND_TS_NO_CONSO = 1 			  AND PSP.SOCA_OID_SOLI_CABE = PSC.OID_SOLI_CABE 			  AND PSP.ESPO_OID_ESTA_POSI  < > 2 			  AND PSP.PROD_OID_PROD = MP.OID_PROD 			  AND MP.NEGO_OID_NEGO = NEG.OID_NEGO 			  AND MP.UNEG_OID_UNID_NEGO = MUN.OID_UNID_NEGO 		      AND MP.PERD_OID_PERI_INIC = PER_INI.OID_PERI(+)	 			  AND MP.PERD_OID_PERI_FIN = PER_FIN.OID_PERI(+) 			  AND ((PER_INI.OID_PERI IS NULL) OR (PER_INI.FEC_INIC  < = PER.FEC_INIC)) 			  AND ((PER_FIN.OID_PERI IS NULL) OR (PER_FIN.FEC_FINA >= PER.FEC_FINA)) 			  AND PSP.OFDE_OID_DETA_OFER(+) = POD.OID_DETA_OFER 			  AND ATO.CDAG_OID_CODI_AGRU = RCA.OID_CODI_AGRU 			  AND ATO.TOFE_OID_TIPO_OFER = POD.TOFE_OID_TIPO_OFER(+) 			 AND MUN.OID_UNID_NEGO IN ( 1 )		     		      AND NEG.OID_NEGO IN ( 1 )   		     AND PER.CANA_OID_CANA =   1  			 AND PER.MARC_OID_MARC =  1  			 AND PSC.PAIS_OID_PAIS =  1  			 AND PSC.PERD_OID_PERI =  57  			   AND ACE.OID_ACCE =  1   			 AND PSC.FEC_FACT = TO_DATE( '09/12/2009' , 'dd/MM/yyyy' )			 		GROUP BY PER.OID_PERI, 			  	 		  PER.VAL_NOMB_PERI, 			   			  RCA.OID_CODI_AGRU , 			   			  RCA.VAL_DESC_AGRU , 						  MUN.OID_UNID_NEGO ) DIARIO, ( 		SELECT PER.OID_PERI, 			   			  PER.VAL_NOMB_PERI PERIODO, 			   			  RCA.OID_CODI_AGRU OID_CODI_AGRU, 			   			  RCA.VAL_DESC_AGRU  TIPO_OFER, 						  MUN.OID_UNID_NEGO,						   						  SUM(PSP.VAL_PREC_NETO_TOTA_LOCA) MONTO, 						  DECODE(COUNT(DISTINCT PSC.OID_SOLI_CABE),0,0, SUM(PSP.VAL_PREC_NETO_TOTA_LOCA)/COUNT(DISTINCT PSC.OID_SOLI_CABE)) PMP, 						  SUM(PSP.NUM_UNID_ATEN) UNID_ATEN, 						  DECODE(COUNT(DISTINCT PSC.OID_SOLI_CABE),0,0, SUM(PSP.NUM_UNID_ATEN)/COUNT(DISTINCT PSC.OID_SOLI_CABE)) PUP,   						  COUNT(DISTINCT PSC.OID_SOLI_CABE) N_PED 		FROM PED_SOLIC_CABEC PSC, 			 		  CRA_PERIO PER, 					  SEG_ACCES ACE, 					  SEG_SUBAC SUB, 					  PED_SOLIC_POSIC PSP, 					  MAE_NEGOC NEG, 					  MAE_UNIDA_NEGOC MUN, 					  MAE_PRODU MP, 					  CRA_PERIO PER_INI, 					  CRA_PERIO PER_FIN, 					  PRE_OFERT_DETAL POD, 					  REP_AGRUP_TIPO_OFERT ATO, 					  REP_CODIG_AGRUP RCA 		WHERE PER.OID_PERI = PSC.PERD_OID_PERI 			  AND PER.PAIS_OID_PAIS = PSC.PAIS_OID_PAIS 			  AND PSC.SBAC_OID_SBAC = SUB.OID_SBAC 			  AND SUB.ACCE_OID_ACCE = ACE.OID_ACCE 			  AND PSC.IND_PEDI_PRUE  < > 1 			  AND PSC.IND_TS_NO_CONSO = 1 			  AND PSP.SOCA_OID_SOLI_CABE = PSC.OID_SOLI_CABE 			  AND PSP.ESPO_OID_ESTA_POSI  < > 2 			  AND PSP.PROD_OID_PROD = MP.OID_PROD 			  AND MP.NEGO_OID_NEGO = NEG.OID_NEGO 			  AND MP.UNEG_OID_UNID_NEGO = MUN.OID_UNID_NEGO 		      AND MP.PERD_OID_PERI_INIC = PER_INI.OID_PERI(+)	 			  AND MP.PERD_OID_PERI_FIN = PER_FIN.OID_PERI(+) 			  AND ((PER_INI.OID_PERI IS NULL) OR (PER_INI.FEC_INIC  < = PER.FEC_INIC)) 			  AND ((PER_FIN.OID_PERI IS NULL) OR (PER_FIN.FEC_FINA >= PER.FEC_FINA)) 			  AND PSP.OFDE_OID_DETA_OFER(+) = POD.OID_DETA_OFER 			  AND ATO.CDAG_OID_CODI_AGRU = RCA.OID_CODI_AGRU 			  AND ATO.TOFE_OID_TIPO_OFER = POD.TOFE_OID_TIPO_OFER(+) 		 	   AND MUN.OID_UNID_NEGO IN ( 1 )		       		       AND NEG.OID_NEGO IN ( 1 )   		      AND PER.CANA_OID_CANA =  1  			  AND PER.MARC_OID_MARC =  1  			  AND PSC.PAIS_OID_PAIS = 1  			  AND PSC.PERD_OID_PERI = 57  			   AND ACE.OID_ACCE =  1   		GROUP BY PER.OID_PERI, 			  	 		  PER.VAL_NOMB_PERI, 			   			  RCA.OID_CODI_AGRU , 			   			  RCA.VAL_DESC_AGRU , 						  MUN.OID_UNID_NEGO ) ACUM, (   	   SELECT GEN.VAL_OID, GEN.VAL_I18N 	   FROM V_GEN_I18N_SICC GEN 	   WHERE GEN.ATTR_ENTI = 'MAE_UNIDA_NEGOC' 	   		 			   AND GEN.IDIO_OID_IDIO =  1  )GEN_UNID_NEGO WHERE ACUM.OID_PERI = DIARIO.OID_PERI(+) 	  				AND ACUM.OID_CODI_AGRU = DIARIO.OID_CODI_AGRU(+) 					AND ACUM.OID_UNID_NEGO = DIARIO.OID_UNID_NEGO(+) 					AND ACUM.OID_UNID_NEGO = GEN_UNID_NEGO.VAL_OID(+)  