SELECT   DISTINCT zon.cod_zona, DECODE (his.ind_apta,                                1, 'APTA',                                'INVITADA'                               ) modalidad,                                           cur.fec_disp_curs, cur.fec_lanz,          cur.fec_fin_curs, cli.cod_clie,             cli.val_ape1          || ' '          || cli.val_ape2          || ' '          || cli.val_nom1          || ' '          || cli.val_nom2 nombre_completo, 	    PERIODOS.DESC_PER_N desc_periodo_n,  		  ( 			  SELECT SUM(SOL.VAL_PREC_CATA_TOTA_LOCA) 			  FROM ped_solic_cabec sol 			  WHERE sol.CLIE_OID_CLIE = cli.oid_clie 					AND SOL.IND_TS_NO_CONSO  < > 1  	  	    					AND sol.perd_oid_peri = PERIODOS.OID_PER_N 		  )periodo_n, 		  PERIODOS.DESC_PER_N1 desc_periodo_n_1,  		  ( 			  SELECT SUM(SOL.VAL_PREC_CATA_TOTA_LOCA) 			  FROM ped_solic_cabec sol 			  WHERE sol.CLIE_OID_CLIE = cli.oid_clie 					AND SOL.IND_TS_NO_CONSO  < > 1  	  	    					AND sol.perd_oid_peri = PERIODOS.OID_PER_N1 		  )periodo_n_1, 		  PERIODOS.DESC_PER_N2 desc_periodo_n_2,  		  ( 			  SELECT SUM(SOL.VAL_PREC_CATA_TOTA_LOCA) 			  FROM ped_solic_cabec sol 			  WHERE sol.CLIE_OID_CLIE = cli.oid_clie 					AND SOL.IND_TS_NO_CONSO  < > 1  	  	    					AND sol.perd_oid_peri = PERIODOS.OID_PER_N2 		  )periodo_n_2, 		  PERIODOS.DESC_PER_N3 desc_periodo_n_3,  		  ( 			  SELECT SUM(SOL.VAL_PREC_CATA_TOTA_LOCA) 			  FROM ped_solic_cabec sol 			  WHERE sol.CLIE_OID_CLIE = cli.oid_clie 					AND SOL.IND_TS_NO_CONSO  < > 1  	  	    					AND sol.perd_oid_peri = PERIODOS.OID_PER_N3 		  )periodo_n_3, 		   PERIODOS.DESC_PER_N4 desc_periodo_n_4,  		  ( 			  SELECT SUM(SOL.VAL_PREC_CATA_TOTA_LOCA) 			  FROM ped_solic_cabec sol 			  WHERE sol.CLIE_OID_CLIE = cli.oid_clie 					AND SOL.IND_TS_NO_CONSO  < > 1  	  	    					AND sol.perd_oid_peri = PERIODOS.OID_PER_N4 		  )periodo_n_4, 		  PERIODOS.DESC_PER_N5 desc_periodo_n_5,  		  ( 			  SELECT SUM(SOL.VAL_PREC_CATA_TOTA_LOCA) 			  FROM ped_solic_cabec sol 			  WHERE sol.CLIE_OID_CLIE = cli.oid_clie 					AND SOL.IND_TS_NO_CONSO  < > 1  	  	    					AND sol.perd_oid_peri = PERIODOS.OID_PER_N5 		  )periodo_n_5, 		  PERIODOS.DESC_PER_N6 desc_periodo_n_6,  		  ( 			  SELECT SUM(SOL.VAL_PREC_CATA_TOTA_LOCA) 			  FROM ped_solic_cabec sol 			  WHERE sol.CLIE_OID_CLIE = cli.oid_clie 					AND SOL.IND_TS_NO_CONSO  < > 1  	  	    					AND sol.perd_oid_peri = PERIODOS.OID_PER_N6 		  )periodo_n_6,           PERIODOS.DESC_PER_N7 desc_periodo_n_7,  		  ( 			  SELECT SUM(SOL.VAL_PREC_CATA_TOTA_LOCA) 			  FROM ped_solic_cabec sol 			  WHERE sol.CLIE_OID_CLIE = cli.oid_clie 					AND SOL.IND_TS_NO_CONSO  < > 1  	  	    					AND sol.perd_oid_peri = PERIODOS.OID_PER_N7 		  ) periodo_n_7, 		  PERIODOS.DESC_PER_N8 desc_periodo_n_8,  		  ( 			  SELECT SUM(SOL.VAL_PREC_CATA_TOTA_LOCA) 			  FROM ped_solic_cabec sol 			  WHERE sol.CLIE_OID_CLIE = cli.oid_clie 					AND SOL.IND_TS_NO_CONSO  < > 1  	  	    					AND sol.perd_oid_peri = PERIODOS.OID_PER_N8 		  )periodo_n_8, 		   PERIODOS.DESC_PER_N9 desc_periodo_n_9,  		  ( 			  SELECT SUM(SOL.VAL_PREC_CATA_TOTA_LOCA) 			  FROM ped_solic_cabec sol 			  WHERE sol.CLIE_OID_CLIE = cli.oid_clie 					AND SOL.IND_TS_NO_CONSO  < > 1  	  	    					AND sol.perd_oid_peri = PERIODOS.OID_PER_N9 		  )periodo_n_9 	     FROM edu_matri_curso cur,          edu_histo_curso his,          mae_clien cli,          mae_clien_unida_admin un_adm,          zon_terri_admin ter_adm,          zon_secci sec,          zon_zona zon, 			 ( 			  SELECT OID_PER_N, 				  				OID_PER_N1, 								OID_PER_N2, 								OID_PER_N3, 								OID_PER_N4, 								OID_PER_N5, 								OID_PER_N6, 								OID_PER_N7, 								OID_PER_N8, 								OID_PER_N9, 								( 								 		   SELECT PER.VAL_NOMB_PERI 										   FROM CRA_PERIO PER 										   WHERE PER.OID_PERI = OID_PER_N 								) DESC_PER_N, 								( 								 		   SELECT PER.VAL_NOMB_PERI 										   FROM CRA_PERIO PER 										   WHERE PER.OID_PERI = OID_PER_N1 								) DESC_PER_N1, 								( 								 		   SELECT PER.VAL_NOMB_PERI 										   FROM CRA_PERIO PER 										   WHERE PER.OID_PERI = OID_PER_N2 								) DESC_PER_N2, 								( 								 		   SELECT PER.VAL_NOMB_PERI 										   FROM CRA_PERIO PER 										   WHERE PER.OID_PERI = OID_PER_N3 								) DESC_PER_N3, 								( 								 		   SELECT PER.VAL_NOMB_PERI 										   FROM CRA_PERIO PER 										   WHERE PER.OID_PERI = OID_PER_N4 								) DESC_PER_N4, 								( 								 		   SELECT PER.VAL_NOMB_PERI 										   FROM CRA_PERIO PER 										   WHERE PER.OID_PERI = OID_PER_N5 								) DESC_PER_N5, 								( 								 		   SELECT PER.VAL_NOMB_PERI 										   FROM CRA_PERIO PER 										   WHERE PER.OID_PERI = OID_PER_N6 								) DESC_PER_N6, 								( 								 		   SELECT PER.VAL_NOMB_PERI 										   FROM CRA_PERIO PER 										   WHERE PER.OID_PERI = OID_PER_N7 								) DESC_PER_N7, 								( 								 		   SELECT PER.VAL_NOMB_PERI 										   FROM CRA_PERIO PER 										   WHERE PER.OID_PERI = OID_PER_N8 								) DESC_PER_N8, 								( 								 		   SELECT PER.VAL_NOMB_PERI 										   FROM CRA_PERIO PER 										   WHERE PER.OID_PERI = OID_PER_N9 								) DESC_PER_N9 				FROM						  				(							  						SELECT PQ_APL_REP.FN_008_CALC_OID_PER_ANT(PERI.PAIS_OID_PAIS,PERI.MARC_OID_MARC,PERI.CANA_OID_CANA,PERI.OID_PERI,1) OID_PER_N, 							   			  PQ_APL_REP.FN_008_CALC_OID_PER_ANT(PERI.PAIS_OID_PAIS,PERI.MARC_OID_MARC,PERI.CANA_OID_CANA,PERI.OID_PERI,2) OID_PER_N1, 										  PQ_APL_REP.FN_008_CALC_OID_PER_ANT(PERI.PAIS_OID_PAIS,PERI.MARC_OID_MARC,PERI.CANA_OID_CANA,PERI.OID_PERI,3) OID_PER_N2, 										  PQ_APL_REP.FN_008_CALC_OID_PER_ANT(PERI.PAIS_OID_PAIS,PERI.MARC_OID_MARC,PERI.CANA_OID_CANA,PERI.OID_PERI,4) OID_PER_N3, 										  PQ_APL_REP.FN_008_CALC_OID_PER_ANT(PERI.PAIS_OID_PAIS,PERI.MARC_OID_MARC,PERI.CANA_OID_CANA,PERI.OID_PERI,5) OID_PER_N4, 										  PQ_APL_REP.FN_008_CALC_OID_PER_ANT(PERI.PAIS_OID_PAIS,PERI.MARC_OID_MARC,PERI.CANA_OID_CANA,PERI.OID_PERI,6) OID_PER_N5, 										  PQ_APL_REP.FN_008_CALC_OID_PER_ANT(PERI.PAIS_OID_PAIS,PERI.MARC_OID_MARC,PERI.CANA_OID_CANA,PERI.OID_PERI,7) OID_PER_N6, 										  PQ_APL_REP.FN_008_CALC_OID_PER_ANT(PERI.PAIS_OID_PAIS,PERI.MARC_OID_MARC,PERI.CANA_OID_CANA,PERI.OID_PERI,8) OID_PER_N7, 										  PQ_APL_REP.FN_008_CALC_OID_PER_ANT(PERI.PAIS_OID_PAIS,PERI.MARC_OID_MARC,PERI.CANA_OID_CANA,PERI.OID_PERI,9) OID_PER_N8, 										  PQ_APL_REP.FN_008_CALC_OID_PER_ANT(PERI.PAIS_OID_PAIS,PERI.MARC_OID_MARC,PERI.CANA_OID_CANA,PERI.OID_PERI,10) OID_PER_N9				   						FROM CRA_PERIO PERI 						WHERE PERI.OID_PERI =  57 						  						)	 		) PERIODOS    WHERE his.mcur_oid_curs = cur.oid_curs      AND his.clie_oid_clie = cli.oid_clie      AND un_adm.clie_oid_clie = cli.oid_clie      AND un_adm.ztad_oid_terr_admi = ter_adm.oid_terr_admi      AND ter_adm.zscc_oid_secc = sec.oid_secc      AND sec.zzon_oid_zona = zon.oid_zona 	  AND cur.cana_oid_cana =  1         AND cur.marc_oid_marc =  1  	        AND cur.pais_oid_pais =  1         AND zon.oid_zona =  1         AND cur.OID_CURS =  1         AND cur.CPLC_OID_CABE_PLAN_CURS =  1  	 	  	 