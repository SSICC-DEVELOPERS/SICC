SELECT * FROM (  	SELECT PRO.STRINGVALUE SOCIEDAD_DEFECTO 	FROM PRINCIPALS PRI, 		PROPERTYVALUES PRO			 	WHERE PRI.NAME =  'USUARIO1'  	  	 		 AND PRO.IDPROPERTY = 48 		 AND PRO.IDPRINCIPAL = PRI.IDPRINCIPAL ), ( 	SELECT PAIS, 		   MARCA, 		   CANAL, 		   VAL_NOMB_PERI, 		   COD_REGI 		   GERENTE, 		   DES_REGI, 		   SUM(IMP_PENDIENTE) IMP_PENDIENTE, 		   SUM(PAG_21) PAG_21, 		   SUM(PAG_31) PAG_31, 		   SUM(PAG_42) PAG_42, 		   SUM(PAG_63) PAG_63, 		   SUM(PAG_84) PAG_84, 		   SUM(PAG_126) PAG_126, 		   SUM(PAG_189) PAG_189, 		   SUM(PAG_189_MAS) PAG_189_MAS, 		   SUM(TC_FACTURACION) TC_FACTURACION, 		   SUM(TC_CARGOS_D) TC_CARGOS_D, 		   SUM(TC_PAGO_FRAC) TC_PAGO_FRAC, 		   SUM(TA_DIRECTOS) TA_DIRECTOS,  		   SUM(TA_NOTA) TA_NOTA, 		   SUM(TA_PAGO_FRAC) TA_PAGO_FRAC, 		   SUM(TA_INCOBRA) TA_INCOBRA		   	    	FROM 		( 		SELECT GEN_PAIS.VAL_I18N PAIS, 			   MARCA.DES_MARC MARCA, 			   GEN_CANAL.VAL_I18N CANAL, 			   VAL_NOMB_PERI, 			   COD_REGI, 			   CASE WHEN (CLIE_OID_CLIE IS NULL) THEN 			   		'GERENTE NO ASIGNADO'  			   ELSE 			   	    CLI.VAL_NOM1||' '||CLI.VAL_APE1 			   END GERENTE, 			   DES_REGI, 			   NVL(( CASE WHEN (TIPO = 'A') THEN 			   		 SUM(IMP_PENDIENTE) 			   END),0) IMP_PENDIENTE, 			   NVL(( 			   	CASE WHEN (DIF_FECHA  <  = 21) THEN 			   			 SUM(PAG) 			    END 			   ),0) AS PAG_21, 			   NVL(( 			   CASE WHEN (DIF_FECHA  <  = 31) THEN 			   			 SUM(PAG) 			    END 			   ),0) AS PAG_31, 			   NVL(( 			   CASE WHEN (DIF_FECHA  <  = 42) THEN 			   			 SUM(PAG) 			    END 			   ),0) AS PAG_42, 			   NVL(( 			   CASE WHEN (DIF_FECHA  <  = 63) THEN 			   			 SUM(PAG) 			    END 			   ),0) AS PAG_63, 			   NVL(( 			   CASE WHEN (DIF_FECHA  <  = 84) THEN 			   			 SUM(PAG) 			    END 			   ),0) AS PAG_84, 			   NVL(( 			   CASE WHEN (DIF_FECHA  <  = 126) THEN 			   			 SUM(PAG) 			    END 			   ),0) AS PAG_126, 			   NVL(( 			   CASE WHEN (DIF_FECHA  <  = 189) THEN 			   			 SUM(PAG) 			    END 			   ),0) AS PAG_189, 			   NVL(( 			   CASE WHEN (DIF_FECHA > 189) THEN 			   			 SUM(PAG) 			    END 			   ),0) AS PAG_189_MAS, 			   NVL(( 			   CASE WHEN (TIPO = 'A' AND PROC_ORIGEN = 'CCC001' AND IMPORTE > 0 AND PROC_ULTIMO  <  > 'CCC006')  THEN 			   		SUM(IMPORTE) 			   END), 0) TC_FACTURACION, 			   NVL(( 			   CASE WHEN (TIPO = 'A' AND PROC_ORIGEN = 'CCC003' AND IMPORTE > 0 AND PROC_ULTIMO  <  > 'CCC006')  THEN 			   		SUM(IMPORTE) 			   END), 0) TC_CARGOS_D, 			   NVL(( 			   CASE WHEN (TIPO = 'A' AND PROC_ORIGEN  <  > 'CCC001' AND PROC_ORIGEN  <  > 'CCC003' AND IMPORTE > 0  AND PROC_ULTIMO  <  > 'CCC006') THEN 			   		SUM(IMPORTE) 			   END), 0) TC_PAGO_FRAC, 			   NVL(( 			   CASE WHEN (TIPO = 'B' AND PROC_ORIGEN = 'CCC003' AND IMPORTE  <   0 AND PROC_ULTIMO  <  > 'CCC006')  THEN 			   		SUM(IMPORTE) 			   END), 0) TA_DIRECTOS, 			   NVL(( 			   CASE WHEN (TIPO = 'B' AND PROC_ORIGEN = 'CCC001' AND IMPORTE  <   0 AND PROC_ULTIMO  <  > 'CCC006')  THEN 			   		SUM(IMPORTE) 			   END), 0) TA_NOTA, 			   NVL(( 			   CASE WHEN (TIPO = 'B' AND PROC_ORIGEN  <  > 'CCC001' AND PROC_ORIGEN  <  > 'CCC003' AND IMPORTE  <   0  AND PROC_ULTIMO  <  > 'CCC006') THEN 			   		SUM(IMPORTE) 			   END), 0) TA_PAGO_FRAC, 			   NVL(( 			   CASE WHEN (TIPO = 'B' AND PROC_ULTIMO = 'CCC006') THEN 			   		SUM(IMPORTE) 			   END), 0) TA_INCOBRA 		FROM 			( 				( 	 				SELECT SUBG.PAIS_OID_PAIS, 					   SUBG.MARC_OID_MARC, 					   SUBG.CANA_OID_CANA, 					   PERI.VAL_NOMB_PERI, 					   REG.COD_REGI, 					   REG.CLIE_OID_CLIE, 					   REG.DES_REGI, 					   TRUNC((MOV_CCC.FEC_ULTI_MOVI - MOV_CCC.FEC_DOCU)) DIF_FECHA, 					   MOV_CCC.IMP_PAGO PAG, 					   ( 					   SELECT PRO.COD_PROC 					   FROM CCC_SUBPR SUBP, 					   		CCC_PROCE PRO 					   WHERE SUBP.OID_SUBP = MOV_CCC.SUBP_OID_SUBP_CREA 					   		 AND SUBP.CCPR_OID_proc= PRO.OID_PROC 					   ) PROC_ORIGEN, 					   ( 					   SELECT PRO.COD_PROC 					   FROM CCC_SUBPR SUBP, 					   		CCC_PROCE PRO 					   WHERE SUBP.OID_SUBP = MOV_CCC.SUBP_OID_SUBP_ULTI 					   		 AND SUBP.CCPR_OID_proc= PRO.OID_PROC 					   ) PROC_ULTIMO, 					   'A' AS TIPO, 					   MOV_CCC.IMP_MOVI IMPORTE, 					   MOV_CCC.IMP_PEND IMP_PENDIENTE 				FROM CCC_MOVIM_CUENT_CORRI MOV_CCC, 					 ZON_SUB_GEREN_VENTA SUBG, 					 ZON_REGIO REG, 					 ZON_ZONA ZONA, 					 ZON_SECCI SEC, 					 CRA_PERIO PERI, 					 (   					 SELECT * 					 FROM	   					 	(	   						SELECT PERI.FEC_INIC  						FROM CRA_PERIO PERI 						WHERE PERI.OID_PERI =  60  	   						 			 						),	   						( 						SELECT PERI.FEC_FINA 						FROM CRA_PERIO PERI 						WHERE PERI.OID_PERI =  1 		   					 				   						)	  	   					) RANGO 				WHERE MOV_CCC.ZORG_OID_REGI = REG.OID_REGI 					  AND MOV_CCC.ZSCC_OID_SECC = SEC.OID_SECC  					  AND MOV_CCC.ZSGV_OID_SUBG_VENT = SUBG.OID_SUBG_VENT 					  AND SUBG.OID_SUBG_VENT = REG.ZSGV_OID_SUBG_VENT 					  AND REG.OID_REGI = ZONA.ZORG_OID_REGI 					  AND ZONA.OID_ZONA = SEC.ZZON_OID_ZONA 					  AND ZONA.IND_ACTI = 1 					  AND MOV_CCC.PERD_OID_PERI = PERI.OID_PERI 				 AND SEC.OID_SECC IN ( 1 ) 	   							  				  AND ZONA.OID_ZONA IN ( 1 )   		 				    AND REG.OID_REGI IN ( 1 )      			  	  AND SUBG.OID_SUBG_VENT IN (  1 ) 				  AND SUBG.CANA_OID_CANA =   1 		 			  	  AND SUBG.MARC_OID_MARC =   1 	   			  	  AND SUBG.PAIS_OID_PAIS =  1    					  AND PERI.FEC_INIC >= RANGO.FEC_INIC 					  AND PERI.FEC_FINA  <  = RANGO.FEC_FINA 				) 				UNION 				( 	 				SELECT SUBG.PAIS_OID_PAIS, 					   SUBG.MARC_OID_MARC, 					   SUBG.CANA_OID_CANA, 					   PERI.VAL_NOMB_PERI, 					   REG.COD_REGI, 					   REG.CLIE_OID_CLIE, 					   REG.DES_REGI, 					   (HTO.FEC_MOVI - HTO.FEC_DOCU),  					   HTO.IMP_PAGO, 					   ( 					   SELECT PRO.COD_PROC 					   FROM CCC_SUBPR SUBP, 					   		CCC_PROCE PRO 					   WHERE SUBP.OID_SUBP = MOV_CCC.SUBP_OID_SUBP_CREA 					   		 AND SUBP.CCPR_OID_proc= PRO.OID_PROC 					   ) PROC_ORIGEN, 					   ( 					   SELECT PRO.COD_PROC 					   FROM CCC_SUBPR SUBP, 					   		CCC_PROCE PRO 					   WHERE SUBP.OID_SUBP = MOV_CCC.SUBP_OID_SUBP_ULTI 					   		 AND SUBP.CCPR_OID_proc= PRO.OID_PROC 					   ) PROC_ULTIMO, 					   'B' AS TIPO, 					   HTO.IMP IMPORTE, 					   NULL AS IMP_PENDIENTE 				FROM CCC_HISTO_MOVIM_CC HTO, 					 CCC_MOVIM_CUENT_CORRI MOV_CCC, 					 ZON_SUB_GEREN_VENTA SUBG, 					 ZON_REGIO REG, 					 ZON_ZONA ZONA, 					 ZON_SECCI SEC, 				     CRA_PERIO PERI, 					 (   						SELECT * 						FROM	   						(	   						SELECT PERI.FEC_INIC  						FROM CRA_PERIO PERI 						WHERE PERI.OID_PERI =   60  						),	   						( 						SELECT PERI.FEC_FINA 						FROM CRA_PERIO PERI 						WHERE PERI.OID_PERI =  1  		   					 			 						)	  	   					 ) RANGO 				WHERE MOV_CCC.ZORG_OID_REGI = REG.OID_REGI 					  AND MOV_CCC.ZSCC_OID_SECC = SEC.OID_SECC  					  AND MOV_CCC.ZSGV_OID_SUBG_VENT = SUBG.OID_SUBG_VENT 					  AND SUBG.OID_SUBG_VENT = REG.ZSGV_OID_SUBG_VENT 					  AND REG.OID_REGI = ZONA.ZORG_OID_REGI 					  AND ZONA.OID_ZONA = SEC.ZZON_OID_ZONA 	  				  AND ZONA.IND_ACTI = 1 					  AND MOV_CCC.PERD_OID_PERI = PERI.OID_PERI 					  AND MOV_CCC.OID_MOVI_CC = HTO.MVCC_OID_MOVI_CC 				   AND SEC.OID_SECC IN ( 1 ) 	 			   	   AND ZONA.OID_ZONA IN ( 1 )    				    AND REG.OID_REGI IN ( 1 )      			 	  AND SUBG.OID_SUBG_VENT IN (  1 )	 				  AND SUBG.CANA_OID_CANA =   1 		 			 	  AND SUBG.MARC_OID_MARC =   1 	   			  	  AND SUBG.PAIS_OID_PAIS =  1  	 				  AND PERI.FEC_INIC >= RANGO.FEC_INIC 				  AND PERI.FEC_FINA  < = RANGO.FEC_FINA  					  AND PERI.FEC_INIC >= RANGO.FEC_INIC 					  AND PERI.FEC_FINA  <  = RANGO.FEC_FINA 				)  			) DATOS, 			( 			SELECT GEN.VAL_OID, GEN.VAL_I18N 			FROM V_GEN_I18N_SICC GEN 			WHERE GEN.ATTR_ENTI = 'SEG_PAIS'			 			 				  AND GEN.IDIO_OID_IDIO =  1   	 			) GEN_PAIS, 			( 			SELECT GEN.VAL_OID, GEN.VAL_I18N 			FROM V_GEN_I18N_SICC GEN 			WHERE GEN.ATTR_ENTI = 'SEG_CANAL'			 			 				  AND GEN.IDIO_OID_IDIO =  1   	 			) GEN_CANAL, 			SEG_MARCA MARCA, 			MAE_CLIEN CLI 			WHERE DATOS.PAIS_OID_PAIS = GEN_PAIS.VAL_OID(+) 				  AND DATOS.CANA_OID_CANA = GEN_CANAL.VAL_OID(+) 				  AND DATOS.MARC_OID_MARC = MARCA.OID_MARC 				  AND CLI.OID_CLIE(+) = DATOS.CLIE_OID_CLIE 		GROUP BY GEN_PAIS.VAL_I18N, 			  	 MARCA.DES_MARC, 			     GEN_CANAL.VAL_I18N, 				 VAL_NOMB_PERI, 				 COD_REGI, 				 CLIE_OID_CLIE, 				 CLI.VAL_NOM1||' '||CLI.VAL_APE1, 				 DES_REGI, 				 DIF_FECHA, 				 PROC_ORIGEN, 				 PROC_ULTIMO, 				 TIPO, 				 IMPORTE		    		) 	GROUP BY PAIS, 		  	 MARCA, 		     CANAL, 			 VAL_NOMB_PERI, 			 COD_REGI, 			 GERENTE, 			 DES_REGI )				