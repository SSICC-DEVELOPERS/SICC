 SELECT   gen_comis.val_i18n AS comision, peri.val_nomb_peri,          subg.cod_subg_vent, 		 reg.COD_REGI, 		 zon.COD_ZONA, 		 		 zon.DES_ZONA, 		           NVL ((SELECT SUM (ven_pre.val_vent_neta_esta)                   FROM int_fuent_venta_previ_sap ven_pre                    WHERE ven_pre.zorg_oid_regi = reg.oid_regi 				  		AND ven_pre.ZZON_OID_ZONA = zon.OID_ZONA					                       	AND ven_pre.perd_oid_peri = com_cal.perd_oid_peri					                   GROUP BY ven_pre.zorg_oid_regi, ven_pre.ZZON_OID_ZONA, ven_pre.perd_oid_peri),               0              ) AS venta, 			           NVL ((SELECT   SUM (ven_rea.imp_vent_neta_esta)                    FROM int_fuent_venta_real_vacum ven_rea                    WHERE ven_rea.perd_oid_peri = com_cal.perd_oid_peri                     AND ven_rea.zorg_oid_regi = reg.oid_regi 					AND ven_rea.ZZON_OID_ZONA = zon.OID_ZONA                     GROUP BY ven_rea.zorg_oid_regi,ven_rea.ZZON_OID_ZONA, ven_rea.perd_oid_peri),                    0                ) AS base_comision, 			           SUM (com_cal.imp_comi) importe_comision, 		           TRUNC             (DECODE (NVL ((SELECT   SUM (ven_pre.val_vent_neta_esta)                                FROM int_fuent_venta_previ_sap ven_pre                               WHERE ven_pre.zorg_oid_regi = reg.oid_regi 							  		AND ven_pre.ZZON_OID_ZONA = zon.OID_ZONA                                  	AND ven_pre.perd_oid_peri =  com_cal.perd_oid_peri                            GROUP BY ven_pre.zorg_oid_regi, ven_pre.ZZON_OID_ZONA, ven_pre.perd_oid_peri 						   ), 0 						  ),                        0, 0, 					                         NVL ((SELECT   SUM (ven_rea.imp_vent_neta_esta)                                  FROM int_fuent_venta_real_vacum ven_rea                                 WHERE ven_rea.perd_oid_peri = com_cal.perd_oid_peri                                   AND ven_rea.zorg_oid_regi = reg.oid_regi 								  AND ven_rea.ZZON_OID_ZONA = zon.OID_ZONA                               GROUP BY ven_rea.zorg_oid_regi,ven_rea.ZZON_OID_ZONA,                                        ven_rea.perd_oid_peri),                             0                            )                      / NVL ((SELECT   SUM (ven_pre.val_vent_neta_esta)                                  FROM int_fuent_venta_previ_sap ven_pre                                 WHERE ven_pre.zorg_oid_regi = reg.oid_regi 									  AND ven_pre.ZZON_OID_ZONA = zon.OID_ZONA                                   	  AND ven_pre.perd_oid_peri = com_cal.perd_oid_peri                              GROUP BY ven_pre.zorg_oid_regi,ven_pre.ZZON_OID_ZONA, ven_pre.perd_oid_peri),                             0                            )                     ),              3             ) AS participacion 			     FROM zon_sub_geren_venta subg,          zon_regio reg, 		 zon_zona zon,          com_comis_calcu com_cal,          com_comis com,          cra_perio peri,		          (SELECT gen.val_oid, gen.val_i18n             FROM v_gen_i18n_sicc gen            WHERE gen.attr_enti = 'COM_COMIS' AND gen.idio_oid_idio =  1 ) gen_comis    WHERE subg.oid_subg_vent = reg.zsgv_oid_subg_vent    	 AND reg.OID_REGI = zon.ZORG_OID_REGI 		      AND peri.oid_peri = com_cal.perd_oid_peri        	    AND (INSTR( 	    ( 		    CASE WHEN (ZON.PERD_OID_PERI_FINA IS NOT NULL) THEN 	   		 	 ( 				  	 SELECT PQ_APL_REP.FN_013_FACDTR_CONCAT_PERI(ZON.PERD_OID_PERI_INIC, ZON.PERD_OID_PERI_FINA) 					 FROM DUAL 				 ) 	 		  	ELSE 	   		 	 ( 				  	 SELECT PQ_APL_REP.FN_013_FACDTR_CONCAT_PERI(ZON.PERD_OID_PERI_INIC,( 																		SELECT * 																		FROM 																			(		 																			SELECT P.OID_PERI     																				FROM CRA_PERIO P        																				WHERE P.MARC_OID_MARC =  1           																				AND P.CANA_OID_CANA = 1     																				AND  P.PAIS_OID_PAIS =  1    																				AND SYSDATE  < = P.FEC_FINA         																				AND SYSDATE >= P.FEC_INIC 																			ORDER BY FEC_FINA DESC 	 																			) 																		WHERE ROWNUM = 1 																		)) 					 FROM DUAL 				 ) 	 			END 		), 			 	    	  	 ','||COM_CAL.PERD_OID_PERI||','					 		) > 0)      AND com_cal.clie_oid_clie = reg.clie_oid_clie  	 AND com_cal.clie_oid_clie = zon.CLIE_OID_CLIE       AND com_cal.comi_oid_comi = com.oid_comi      AND com.oid_comi = gen_comis.val_oid(+)       	AND com_cal.perd_oid_peri IN ( 43 )      AND subg.marc_oid_marc =  1        AND subg.cana_oid_cana =  1        AND subg.pais_oid_pais =  1   	  AND subg.OID_SUBG_VENT IN ( 1 )        AND reg.oid_regi IN ( 1 )   	 AND zon.OID_ZONA IN ( 1 )  	       	AND com.oid_comi =  1          AND com.ind_vent_cobr =  'C'  	  GROUP BY gen_comis.val_i18n,          com_cal.perd_oid_peri,          peri.val_nomb_peri,          subg.cod_subg_vent,          reg.cod_regi,          reg.oid_regi, 		 zon.OID_ZONA, 		 zon.COD_ZONA, 		 zon.DES_ZONA 		 