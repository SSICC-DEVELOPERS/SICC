SELECT GEN_PAIS.VAL_I18N PAIS, 	   MARC.DES_MARC MARCA, 	   GEN_CANAL.VAL_I18N CANAL, 	   DAT.VAL_NOMB_PERI, 	   GEN_AC.VAL_I18N ACCESO, 	   DAT.DES_REGI, 	   DAT.GER_REGI GERENTE_REG, 	   DAT.COD_ZONA, 	   DAT.DES_ZONA, 	   DAT.GER_ZONA GERENTE_ZON, 	   DAT.ESTIMADO, 	   DAT.RECIBIDO, 	   DAT.FACTURADO, 	   DAT.REAL_RECIBIDO, 	   DAT.REC_PER_ANTE RECIBIDO_PER_ANT, 	   DAT.PED_NUEVAS PEDIDOS_NUEVAS, 	   DAT.PORC_ALCAN POR_ALCANZADO FROM ( 	SELECT COMB.PAIS, 		   COMB.MARCA, 		   COMB.CANAL, 		   COMB.VAL_NOMB_PERI, 		   COMB.ACCE, 		   COMB.REGI, 		   COMB.DES_REGI, 		   COMB.GER_REGI, 		   SOLIC.GER_ZONA, 		   SOLIC.DES_ZONA, 		   SOLIC.COD_ZONA, 		   SOLIC.ESTIMADO, 		   SOLIC.RECIBIDO, 		   SOLIC.FACTURADO, 		   SOLIC.REAL_RECIBIDO, 		   SOLIC.REC_PER_ANTE, 		   SOLIC.PED_NUEVAS, 		   SOLIC.PORC_ALCAN 	FROM 	( 	 	SELECT PAIS, 			   MARCA, 			   CANAL, 			   PERI, 			   ACCE, 			   REGI, 			   GER_ZONA, 			   DES_ZONA, 			   COD_ZONA, 			   ESTIMADO, 			   RECIBIDO, 			   FACTURADO, 			   ESTIMADO-RECIBIDO REAL_RECIBIDO, 			   REC_PER_ANTE, 			   PED_NUEVAS, 			   ROUND(DECODE(ESTIMADO,0,0,(FACTURADO/ESTIMADO)*100),2) PORC_ALCAN 		FROM 			( 				SELECT PAIS, 					   MARCA, 					   CANAL, 					   PERI, 					   ACCE, 					   REGI, 					   GER_ZONA, 					   DES_ZONA, 					   COD_ZONA, 					   ( 					   	  SELECT NVL(SUM(FVP.NUM_ORDE),0) 						  FROM INT_FUENT_VENTA_PREVI_SAP FVP 						  WHERE FVP.PERD_OID_PERI = PERI 						  		AND FVP.ZZON_OID_ZONA = OID_ZONA 					   ) ESTIMADO, 					   SUM(RECIBIDO) RECIBIDO, 					   SUM(FACTURADO) FACTURADO, 					   SUM(PED_NUEVAS) PED_NUEVAS, 					   ( 					      SELECT COUNT(*) 						  FROM PED_SOLIC_CABEC PSC 						  WHERE PSC.IND_TS_NO_CONSO = 1 						  	  AND PSC.IND_PEDI_PRUE  < > 1 							  AND PSC.PERD_OID_PERI = PERI_ANTE 							  AND PSC.ZZON_OID_ZONA = OID_ZONA 							  AND PSC.FEC_FACT IS NULL	    					   ) REC_PER_ANTE 				FROM 				(		 					SELECT PER.PAIS_OID_PAIS PAIS, 					       MAR.OID_MARC MARCA, 						   CAN.OID_CANA CANAL, 						   PER.OID_PERI PERI, 						   PTS.ACCE_OID_ACCE ACCE, 						   REG.OID_REGI REGI, 						   MAE.OID_CLIE, 						   ZON.OID_ZONA, 						   ZON.COD_ZONA, 						   MAE.VAL_NOM1||' '||MAE.VAL_NOM2||' '||MAE.VAL_APE1||' '||MAE.VAL_APE2 GER_ZONA, 						   ZON.DES_ZONA, 						   CASE WHEN (PSC.FEC_FACT IS NULL) THEN 						   		1 						   ELSE 						   	    0 						   END RECIBIDO, 						   CASE WHEN (PSC.FEC_FACT IS NOT NULL) THEN 						   		1 						   ELSE 						   	    0 						   END FACTURADO,   				           PQ_APL_REP.FN_008_CALC_OID_PER_ANT(PER.PAIS_OID_PAIS,MAR.OID_MARC,CAN.OID_CANA,PER.OID_PERI,2) PERI_ANTE, 						   CASE WHEN (CDA.ESTA_OID_ESTA_CLIE = 2) THEN 						   		1 						   ELSE 						   	   0 						   END PED_NUEVAS		   		    					FROM PED_SOLIC_CABEC PSC, 						 PED_TIPO_SOLIC PTS, 						 PED_TIPO_SOLIC_PAIS TSP, 						 CRA_PERIO PER, 						 SEG_MARCA MAR, 						 SEG_CANAL CAN, 						 ZON_ZONA ZON, 						 ZON_REGIO REG, 						 MAE_CLIEN MAE, 						 MAE_CLIEN_DATOS_ADICI CDA	 					WHERE TSP.TSOL_OID_TIPO_SOLI = PTS.OID_TIPO_SOLI 						  AND PSC.TSPA_OID_TIPO_SOLI_PAIS = TSP.OID_TIPO_SOLI_PAIS 						  AND PER.OID_PERI = PSC.PERD_OID_PERI 						  AND PER.MARC_OID_MARC = MAR.OID_MARC 						  AND PER.CANA_OID_CANA = CAN.OID_CANA 						  AND ZON.OID_ZONA = PSC.ZZON_OID_ZONA 						  AND ZON.ZORG_OID_REGI = REG.OID_REGI 					      AND REG.CANA_OID_CANA = PER.CANA_OID_CANA 						  AND REG.MARC_OID_MARC = PER.MARC_OID_MARC 						  AND REG.PAIS_OID_PAIS = PER.PAIS_OID_PAIS 						  AND ZON.CLIE_OID_CLIE = MAE.OID_CLIE(+) 						  AND PSC.CLIE_OID_CLIE = CDA.CLIE_OID_CLIE 						  AND PSC.IND_TS_NO_CONSO = 1 						  AND PSC.IND_PEDI_PRUE  < > 1 						  AND PER.CANA_OID_CANA IN ( 1 ) 						  AND PER.MARC_OID_MARC =  1   						  AND TSP.PAIS_OID_PAIS =  1                        AND PTS.ACCE_OID_ACCE IN (  1  )  						  AND PER.OID_PERI IN ( 57 )  					 AND REG.OID_REGI IN (  1  )  					 AND REG.CLIE_OID_CLIE IN (  1  )  				)		 				GROUP BY PAIS, 				       MARCA, 					   CANAL, 					   PERI, 					   ACCE, 					   REGI, 					   GER_ZONA, 					   DES_ZONA, 					   OID_ZONA, 					   COD_ZONA, 					   PERI_ANTE 			) 	) SOLIC,	  	(			  		SELECT DISTINCT PER.PAIS_OID_PAIS PAIS, 		       PER.MARC_OID_MARC MARCA, 		       PER.CANA_OID_CANA CANAL, 		       PER.OID_PERI PERI, 			   PER.VAL_NOMB_PERI, 		       ACE.OID_ACCE ACCE, 		       REG.OID_REGI REGI, 			   REG.DES_REGI DES_REGI, 	   		   MAE.VAL_NOM1||' '||MAE.VAL_NOM2||' '||MAE.VAL_APE1||' '||MAE.VAL_APE2 GER_REGI 		FROM SEG_ACCES ACE, 		     CRA_PERIO PER, 		     ZON_REGIO REG, 			 MAE_CLIEN MAE 		WHERE ACE.CANA_OID_CANA = PER.CANA_OID_CANA 		     AND REG.CANA_OID_CANA = PER.CANA_OID_CANA 		     AND REG.MARC_OID_MARC = PER.MARC_OID_MARC 		     AND REG.PAIS_OID_PAIS = PER.PAIS_OID_PAIS 	         AND MAE.OID_CLIE(+) = REG.CLIE_OID_CLIE 			 AND PER.PAIS_OID_PAIS =  1   			 AND PER.MARC_OID_MARC =  1   			 AND PER.CANA_OID_CANA IN ( 1 ) 		     AND PER.OID_PERI IN ( 57 )   		      		   AND ACE.OID_ACCE IN (  1  )  			  AND REG.OID_REGI IN (  1  )   			  AND REG.CLIE_OID_CLIE IN (  1  )   	) COMB	  	WHERE SOLIC.PAIS(+) = COMB.PAIS 		  AND SOLIC.MARCA(+) = COMB.MARCA 		  AND SOLIC.CANAL(+) = COMB.CANAL  		  AND SOLIC.ACCE(+) = COMB.ACCE 		  AND SOLIC.PERI(+) = COMB.PERI 		  AND SOLIC.REGI(+) = COMB.REGI		  ) DAT, SEG_MARCA MARC, (  	SELECT GEN.VAL_OID, GEN.VAL_I18N 	FROM V_GEN_I18N_SICC GEN 	WHERE GEN.ATTR_ENTI = 'SEG_CANAL' 		  AND GEN.IDIO_OID_IDIO =   1  ) GEN_CANAL, (  	SELECT GEN.VAL_OID, GEN.VAL_I18N 	FROM V_GEN_I18N_SICC GEN 	WHERE GEN.ATTR_ENTI = 'SEG_PAIS' 		  AND GEN.IDIO_OID_IDIO =   1  ) GEN_PAIS, (  	SELECT GEN.VAL_OID, GEN.VAL_I18N 	FROM V_GEN_I18N_SICC GEN 	WHERE GEN.ATTR_ENTI = 'SEG_ACCES' 		  AND GEN.IDIO_OID_IDIO =   1  ) GEN_AC WHERE DAT.MARCA = MARC.OID_MARC 	  AND DAT.CANAL = GEN_CANAL.VAL_OID(+) 	  AND DAT.PAIS = GEN_PAIS.VAL_OID(+) 	  AND DAT.ACCE = GEN_AC.VAL_OID(+) ORDER BY PAIS, 	  MARCA, 	  CANAL, 	  VAL_NOMB_PERI, 	  ACCESO, 	  DES_REGI	 	   	   	  