 SELECT GEN_COMI.VAL_I18N COMISION, 	   SUBG.DES_SUBG_VENT SUBGEREN, 	   REG.DES_REGI REGION, 	   PERI.VAL_NOMB_PERI PERIODO, 	   ZONA.COD_ZONA, 	   ZONA.DES_ZONA, 	   CLI.VAL_NOM1||' '||CLI.VAL_APE1 NOMBRE, 	   COM_CAL.VAL_PORC_COMI, 	   COM_CAL.IMP_COMI IMPORTE_PAGAR,          DECODE(NVL(SUM(COM_CLI.VAL_PORC_COMI),0),0,0,(SUM(COM_CLI.IMP_MONT_PAGA) * SUM(COM_CLI.VAL_PORC_COMI) / 100)) MONTO_ABONAR FROM ZON_SUB_GEREN_VENTA SUBG, 	 ZON_REGIO REG, 	 ZON_ZONA ZONA, 	 COM_COMIS_CALCU COM_CAL, 	 COM_COMIS_COBRA_ACUMU_CLIEN COM_CLI, 	 COM_COMIS_COBRA_ACUMU COM_ACU, 	 CRA_PERIO PERI, 	 MAE_CLIEN CLI, 	 COM_COMIS COM, 	 ( 		 SELECT GEN.VAL_OID, GEN.VAL_I18N 		 FROM V_GEN_I18N_SICC GEN 		 WHERE GEN.ATTR_ENTI = 'COM_COMIS' 		 	   AND GEN.IDIO_OID_IDIO =  1  	 ) GEN_COMI WHERE SUBG.OID_SUBG_VENT = REG.ZSGV_OID_SUBG_VENT 	  AND REG.OID_REGI = ZONA.ZORG_OID_REGI 	  AND ZONA.CLIE_OID_CLIE = COM_CAL.CLIE_OID_CLIE 	  AND COM_CAL.COMI_OID_COMI = GEN_COMI.VAL_OID(+)	        AND PERI.OID_PERI = COM_CAL.PERD_OID_PERI         AND COM_CAL.PERD_OID_PERI =  61  	  AND COM.OID_COMI = COM_CAL.COMI_OID_COMI 	  AND ZONA.CLIE_OID_CLIE = CLI.OID_CLIE 	  AND COM_CLI.COC2_OID_COMI_COBR_ACUM = COM_ACU.OID_COMI_COBR_ACUM 	  AND COM_ACU.COMI_OID_COMI = COM_CAL.COMI_OID_COMI 	    AND (INSTR( 	    ( 		    CASE WHEN (ZONA.PERD_OID_PERI_FINA IS NOT NULL) THEN 	   		 	 ( 				  	 SELECT PQ_APL_REP.FN_013_FACDTR_CONCAT_PERI(ZONA.PERD_OID_PERI_INIC, ZONA.PERD_OID_PERI_FINA) 					 FROM DUAL 				 ) 	 		  	ELSE 	   		 	 ( 				  	 SELECT PQ_APL_REP.FN_013_FACDTR_CONCAT_PERI(ZONA.PERD_OID_PERI_INIC,( 																		SELECT * 																		FROM 																			(		 																			SELECT P.OID_PERI     																				FROM CRA_PERIO P        																				WHERE P.MARC_OID_MARC =  1           																				AND P.CANA_OID_CANA = 1     																				AND  P.PAIS_OID_PAIS =  1    																				AND SYSDATE  < = P.FEC_FINA         																				AND SYSDATE >= P.FEC_INIC 																			ORDER BY FEC_FINA DESC 	 																			) 																		WHERE ROWNUM = 1 																		)) 					 FROM DUAL 				 ) 	 			END 		), 			 	    	  	 ','|| 61 ||','					 		) > 0)       AND SUBG.PAIS_OID_PAIS =  1  	  AND SUBG.MARC_OID_MARC =  1  	  AND SUBG.CANA_OID_CANA =  1  	  AND COM_CAL.PERD_OID_PERI =  61  	  AND COM.IND_VENT_COBR =  'C'  	  AND COM_CAL.COMI_OID_COMI =  1319  	  AND SUBG.OID_SUBG_VENT IN ( 1 ) 	   AND REG.OID_REGI IN  ( 1 )  	   AND ZONA.OID_ZONA IN ( 1 )   GROUP BY GEN_COMI.VAL_I18N , 	   SUBG.DES_SUBG_VENT , 	   REG.DES_REGI, 	   PERI.VAL_NOMB_PERI , 	   ZONA.COD_ZONA, 	   ZONA.DES_ZONA, 	   CLI.VAL_NOM1||' '||CLI.VAL_APE1 , 	   COM_CAL.VAL_PORC_COMI, 	   COM_CAL.IMP_COMI     