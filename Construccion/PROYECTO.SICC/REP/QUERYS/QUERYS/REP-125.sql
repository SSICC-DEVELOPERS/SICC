( SELECT VIRTUAL.ETAPA, 	   VIRTUAL.ETAPA_FIN, 	   VIRTUAL.COD_PERI, 	   VIRTUAL.VAL_ANIO, 	   DATOS.IMP_DEUD_ASIG VENTA_COB, 	   DATOS.IMP_TOT_VEN TOTAL_VENTA, 	   DECODE(DATOS.IMP_TOT_VEN, 0, 0, (DATOS.IMP_DEUD_ASIG/DATOS.IMP_TOT_VEN)*100) VENTA_COB_PORC, 	   DATOS.IMP_DEUD_CANC COBRANZA, 	   DECODE(DATOS.IMP_DEUD_ASIG, 0, 0, (DATOS.IMP_DEUD_CANC / DATOS.IMP_DEUD_ASIG)*100) REC_PORC FROM	 (  SELECT PER_COR.OID_PERI, 	   NVL(SUM(ASI_COB.IMP_DEUD_ASIG), 0) IMP_DEUD_ASIG, 	   NVL(SUM(ASI_COB.IMP_DEUD_CANC), 0) IMP_DEUD_CANC, 	   NVL(( 		   SELECT SUM(SOL.VAL_TOTA_PAGA_LOCA) 		   FROM PED_SOLIC_CABEC SOL, 		   		ZON_SUB_GEREN_VENTA SUBG, 				ZON_ZONA ZONA, 				ZON_REGIO REG, 				ZON_SECCI SEC, 				ZON_TERRI_ADMIN TER_ADM, 				ZON_TERRI TER, 				CRA_PERIO PER 			WHERE SOL.PERD_OID_PERI = PER.OID_PERI 				AND SOL.ZZON_OID_ZONA = ZONA.OID_ZONA 				AND SOL.ZTAD_OID_TERR_ADMI = TER_ADM.OID_TERR_ADMI 				AND SOL.TERR_OID_TERR = TER.OID_TERR 				AND SUBG.OID_SUBG_VENT = REG.ZSGV_OID_SUBG_VENT 				AND REG.OID_REGI = ZONA.ZORG_OID_REGI 				AND ZONA.OID_ZONA = SEC.ZZON_OID_ZONA 				AND SEC.OID_SECC = TER_ADM.ZSCC_OID_SECC 				AND TER.OID_TERR = TER_ADM.TERR_OID_TERR 				AND PER.PERI_OID_PERI = PER_COR.OID_PERI 				AND SOL.IND_TS_NO_CONSO  < > 1 				AND SOL.IND_GENE_CC = 1 				AND SOL.IND_PEDI_PRUE  < > 1 				AND SOL.FEC_FACT IS NOT NULL 				 AND TER.COD_TERR >=  '1'  						   	  	  		 	     				 AND TER.COD_TERR  < =  '1'  						   	  	  		 	    		 				 AND SEC.OID_SECC =  1    				 	 			  		 	      				 AND ZONA.OID_ZONA=  1   				 	 			  		 	      				 AND REG.OID_REGI =  1    				 	 			  		 	      				 AND SUBG.MARC_OID_MARC =  1  			 	 			  		 	      				 AND SUBG.CANA_OID_CANA =  1  			 	 			  		 	     						 				AND SOL.PAIS_OID_PAIS =  1 				 			  		 	      			GROUP BY PER.PERI_OID_PERI 		), 0) IMP_TOT_VEN FROM SEG_PERIO_CORPO PER_COR, 	 COB_ASIGN_COBRA ASI_COB, 	 COB_CRONO_COBRA CRO_COB, 	 CRA_PERIO PER, 	 ZON_SECCI SEC, 	 ZON_TERRI_ADMIN TER_ADM, 	 ZON_TERRI TER, 	 COB_ETAPA_DEUDA ETAPA, 	 CCC_MOVIM_CUENT_CORRI MCC WHERE PER_COR.VAL_ANIO = (CASE WHEN -1 =  -1  THEN 							   	  				     	TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) 				     	ELSE 							( 							SELECT PC.VAL_ANIO 							FROM CRA_PERIO PER, 								 SEG_PERIO_CORPO PC 							WHERE PER.OID_PERI =  -1                            								  AND PC.OID_PERI = PER.PERI_OID_PERI 								   AND PER.MARC_OID_MARC =  1  			 	      								   AND PER.CANA_OID_CANA =  1  				      							) 						END) 		AND CRO_COB.OID_CRON_COBR = ASI_COB.CRCO_OID_CRON_COBR 		AND CRO_COB.ETDE_OID_ETAP_DEUD = ETAPA.OID_ETAP_DEUD  		AND CRO_COB.PERD_OID_PERI = PER.OID_PERI  		AND PER_COR.OID_PERI = PER.PERI_OID_PERI 		AND SEC.OID_SECC = TER_ADM.ZSCC_OID_SECC 		AND TER.OID_TERR = TER_ADM.TERR_OID_TERR 		AND MCC.OID_MOVI_CC = ASI_COB.MVCC_OID_MOVI_CC 		AND MCC.ZSCC_OID_SECC = SEC.OID_SECC 		AND MCC.ZTAD_OID_TERR_ADMI = TER_ADM.OID_TERR_ADMI 		 AND TER.COD_TERR >=  '1'  						   	  	  		 	     		 AND TER.COD_TERR  < =  '1'  				   	  	  		 	    		 		 AND SEC.OID_SECC =  1    				 	 			  		 	      		 AND SEC.ZZON_OID_ZONA=  1   				 	 			  		 	      		 AND MCC.ZORG_OID_REGI=  1    				 	 			  		 	      		AND ETAPA.OID_ETAP_DEUD =  1 				 			  		 	      		AND PER.PAIS_OID_PAIS =  1 				 			  		 	      GROUP BY PER_COR.OID_PERI ) DATOS, ( SELECT ( 	   SELECT ET.VAL_DESC||': '||ET.VAL_EDAD_INIC 	   FROM COB_ETAPA_DEUDA ET 	   WHERE ET.OID_ETAP_DEUD =  1  	   ) ETAPA, 	   ( 	   SELECT ET.VAL_EDAD_FINA 	   FROM COB_ETAPA_DEUDA ET 	   WHERE ET.OID_ETAP_DEUD =  1  	   ) ETAPA_FIN, 	   OID_PERI,  	   COD_PERI, 	   VAL_ANIO 			 FROM SEG_PERIO_CORPO PER_COR WHERE PER_COR.VAL_ANIO = (CASE WHEN -1 =  -1  THEN								   	  				     	TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) 				     	ELSE 							( 							SELECT PC.VAL_ANIO 							FROM CRA_PERIO PER, 								 SEG_PERIO_CORPO PC 							WHERE PER.OID_PERI =  -1                            								  AND PC.OID_PERI = PER.PERI_OID_PERI 								   AND PER.MARC_OID_MARC =  1  			 	      								   AND PER.CANA_OID_CANA =  1  				      							) 						END)  ) VIRTUAL			 WHERE DATOS.OID_PERI(+) = VIRTUAL.OID_PERI		 ) 						 UNION ALL ( SELECT VIRTUAL.ETAPA, 	   VIRTUAL.ETAPA_FIN, 	   VIRTUAL.COD_PERI, 	   VIRTUAL.VAL_ANIO, 	   DATOS.IMP_DEUD_ASIG VENTA_COB, 	   DATOS.IMP_TOT_VEN TOTAL_VENTA, 	   DECODE(DATOS.IMP_TOT_VEN, 0, 0, (DATOS.IMP_DEUD_ASIG/DATOS.IMP_TOT_VEN)*100) VENTA_COB_PORC, 	   DATOS.IMP_DEUD_CANC COBRANZA, 	   DECODE(DATOS.IMP_DEUD_ASIG, 0, 0, (DATOS.IMP_DEUD_CANC / DATOS.IMP_DEUD_ASIG)*100) REC_PORC FROM	 (  SELECT  	   PER_COR.OID_PERI, 	   NVL(SUM(ASI_COB.IMP_DEUD_ASIG), 0) IMP_DEUD_ASIG, 	   NVL(SUM(ASI_COB.IMP_DEUD_CANC), 0) IMP_DEUD_CANC, 	   ( 		   SELECT SUM(SOL.VAL_TOTA_PAGA_LOCA) 		   FROM PED_SOLIC_CABEC SOL, 		   		ZON_SUB_GEREN_VENTA SUBG, 				ZON_ZONA ZONA, 				ZON_REGIO REG, 				ZON_SECCI SEC, 				ZON_TERRI_ADMIN TER_ADM, 				ZON_TERRI TER, 				CRA_PERIO PER 			WHERE SOL.PERD_OID_PERI = PER.OID_PERI 				AND SOL.ZZON_OID_ZONA = ZONA.OID_ZONA 				AND SOL.ZTAD_OID_TERR_ADMI = TER_ADM.OID_TERR_ADMI 				AND SOL.TERR_OID_TERR = TER.OID_TERR 				AND SUBG.OID_SUBG_VENT = REG.ZSGV_OID_SUBG_VENT 				AND REG.OID_REGI = ZONA.ZORG_OID_REGI 				AND ZONA.OID_ZONA = SEC.ZZON_OID_ZONA 				AND SEC.OID_SECC = TER_ADM.ZSCC_OID_SECC 				AND TER.OID_TERR = TER_ADM.TERR_OID_TERR 				AND PER.PERI_OID_PERI = PER_COR.OID_PERI 				AND SOL.IND_TS_NO_CONSO  < > 1 				AND SOL.IND_GENE_CC = 1 				AND SOL.IND_PEDI_PRUE  < > 1 				AND SOL.FEC_FACT IS NOT NULL 				 AND TER.COD_TERR >=  '1'  						   	  	  		 	     				 AND TER.COD_TERR  < =  '1'  				   	  	  		 	    		 				 AND SEC.OID_SECC =  1    				 	 			  		 	      				 AND ZONA.OID_ZONA=  1   				 	 			  		 	      				 AND REG.OID_REGI =  1    				 	 			  		 	      				 AND SUBG.MARC_OID_MARC =  1  			 	 			  		 	      				 AND SUBG.CANA_OID_CANA =  1  			 	 			  		 	     						 				AND SOL.PAIS_OID_PAIS =  1 				 			  		 	      			GROUP BY PER.PERI_OID_PERI 		) IMP_TOT_VEN FROM SEG_PERIO_CORPO PER_COR, 	 COB_ASIGN_COBRA ASI_COB, 	 COB_CRONO_COBRA CRO_COB, 	 CRA_PERIO PER, 	 ZON_SECCI SEC, 	 ZON_TERRI_ADMIN TER_ADM, 	 ZON_TERRI TER, 	 COB_ETAPA_DEUDA ETAPA, 	 CCC_MOVIM_CUENT_CORRI MCC WHERE PER_COR.VAL_ANIO = ((CASE WHEN -1 =  -1  THEN								      	  				     	TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) 				     	ELSE 							( 							SELECT PC.VAL_ANIO 							FROM CRA_PERIO PER, 								 SEG_PERIO_CORPO PC 							WHERE PER.OID_PERI =  -1                            								  AND PC.OID_PERI = PER.PERI_OID_PERI 								   AND PER.MARC_OID_MARC =  1  			 	      								   AND PER.CANA_OID_CANA =  1  				      							) 						END) -1) 		AND CRO_COB.OID_CRON_COBR = ASI_COB.CRCO_OID_CRON_COBR 		AND CRO_COB.ETDE_OID_ETAP_DEUD = ETAPA.OID_ETAP_DEUD  		AND CRO_COB.PERD_OID_PERI = PER.OID_PERI  		AND PER_COR.OID_PERI = PER.PERI_OID_PERI 		AND SEC.OID_SECC = TER_ADM.ZSCC_OID_SECC 		AND TER.OID_TERR = TER_ADM.TERR_OID_TERR 		AND MCC.OID_MOVI_CC = ASI_COB.MVCC_OID_MOVI_CC 		AND MCC.ZSCC_OID_SECC = SEC.OID_SECC 		AND MCC.ZTAD_OID_TERR_ADMI = TER_ADM.OID_TERR_ADMI 		 AND TER.COD_TERR >=  '1'  						   	  	  		 	     		 AND TER.COD_TERR  < =  '1'  				   	  	  		 	    		 		 AND SEC.OID_SECC =  1    				 	 			  		 	      		 AND SEC.ZZON_OID_ZONA=  1   				 	 			  		 	      		 AND MCC.ZORG_OID_REGI =  1    				 	 			  		 	      		AND ETAPA.OID_ETAP_DEUD =  1 				 			  		 	      		AND PER.PAIS_OID_PAIS =  1 				 			  		 	      GROUP BY PER_COR.OID_PERI ) DATOS, ( SELECT ( 	   SELECT ET.VAL_DESC||': '||ET.VAL_EDAD_INIC 	   FROM COB_ETAPA_DEUDA ET 	   WHERE ET.OID_ETAP_DEUD =  1  	   ) ETAPA, 	   ( 	   SELECT ET.VAL_EDAD_FINA 	   FROM COB_ETAPA_DEUDA ET 	   WHERE ET.OID_ETAP_DEUD =  1  	   ) ETAPA_FIN, 	   OID_PERI,  	   COD_PERI, 	   VAL_ANIO 			 FROM SEG_PERIO_CORPO PER_COR WHERE PER_COR.VAL_ANIO = ((CASE WHEN -1 =  -1  THEN							   	  				     	TO_NUMBER(TO_CHAR(SYSDATE, 'YYYY')) 				     	ELSE 							( 							SELECT PC.VAL_ANIO 							FROM CRA_PERIO PER, 								 SEG_PERIO_CORPO PC 							WHERE PER.OID_PERI =  -1                            								  AND PC.OID_PERI = PER.PERI_OID_PERI 								   AND PER.MARC_OID_MARC =  1  			 	      								   AND PER.CANA_OID_CANA =  1  				      							) 						END) -1) ) VIRTUAL			 WHERE DATOS.OID_PERI(+) = VIRTUAL.OID_PERI ) 