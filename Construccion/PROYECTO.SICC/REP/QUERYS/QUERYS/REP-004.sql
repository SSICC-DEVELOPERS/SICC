select 	  a.periodo, 	  a.actividades, 	  a.diasem, 	  a.dianum, 	  a.mes, 	  a.fecha_prev, 	  a.fecha_fina, 	  a.pais, 	  a.val_anio, 	  a.grupo, 	  a.actividades_i18n from  ( 	select periodo, 	  	   CASE WHEN (decode((select fer.OID_FERI from cra_feria fer  		   where fer.CACT_OID_ACTI = OID_ACTI 		   		 and fer.CGZO_OID_CABE_GRUP_ZONA = OID_CABE_GRUP_ZONA 				 and fer.FEC_FERI = fecha_prev 				 and fer.IND_FEST = 1 				 ),NULL,'NO','SI') = 'SI') THEN 'FESTIVO' 		   ELSE 	   pq_apl_rep.FN_004_CONCAT_ACT( 		   						    57 ,  								   fecha_prev,  								    1071 ,  							   	    1 ,  							   	    1 ,  							   	    1  								  )  		   END AS actividades, 		   to_char(fecha_prev,'d') diasem, 		   to_char(fecha_prev,'dd') dianum, 		   to_char(fecha_prev,'mm') mes, 		   fecha_prev, fecha_fina, pais, val_anio, grupo,  		   pq_apl_rep.FN_004_CONCAT_ACT_I18N ( 							   		 1 ,  							   		 1 ,  							   		 1 , 							   		 1  								  ) as actividades_I18N 	from  	   ( 		select per.VAL_NOMB_PERI  periodo, act.COD_ACTI , gen_pais.val_i18n pais, cor.VAL_ANIO, gen_grupo.val_i18n grupo,  			   zon.COD_ZONA, cab.OID_CABE_GRUP_ZONA, act.oid_acti, cro.fec_prev fecha_prev, cro.fec_fina fecha_fina 		from cra_crono_grupo_zona cro, 			 cra_cabec_grupo_zona cab, 			 cra_perio per, 			 cra_activ act, 			 seg_perio_corpo cor, 			 cra_detal_grupo_zona det, 			 zon_zona zon, 			 (		 				select oid_peri  				from  				(		 					 select per.oid_peri, per.fec_inic, per.fec_fina 					 from 		 					 ( 			 		  	select per2.oid_peri, per2.fec_inic 						from cra_perio per2, 							 seg_perio_corpo pc 						where per2.oid_peri= 57  							     and pc.oid_peri = per2.peri_oid_peri							     					 )per_selec, 					 cra_perio per, 					 seg_perio_corpo pc 					 where per.fec_inic>=per_selec.fec_inic 			 	 	   and per.CANA_OID_CANA=  1  			 		   and per.MARC_OID_MARC=  1  			 		   and per.pais_oid_pais=  1         				   and pc.oid_peri = per.peri_oid_peri     	    		order by per.fec_inic 			  	)  		  	  where rownum in(1,2,3) 			 )tres_per, 			  ( 			   		select gen.VAL_OID, gen.VAL_I18N  					from v_gen_i18n_sicc gen  					where gen.ATTR_ENTI='SEG_PAIS' 						and gen.IDIO_OID_IDIO= 1  			  )gen_pais, 			  ( 			   		select gen.VAL_OID, gen.VAL_I18N  					from v_gen_i18n_sicc gen  					where gen.ATTR_ENTI='CRA_CABEC_GRUPO_ZONA' 						and gen.IDIO_OID_IDIO= 1  			  )gen_grupo 		where cro.CACT_OID_ACTI=act.OID_ACTI 			  and cro.PERD_OID_PERI=per.oid_peri 			  and per.PERI_OID_PERI=cor.oid_peri 			  and cro.CGZO_OID_CABE_GRUP_ZONA=cab.OID_CABE_GRUP_ZONA 			  and det.CGZO_OID_CABE_GRUP_ZONA=cab.OID_CABE_GRUP_ZONA 			  and det.ZZON_OID_ZONA=zon.oid_zona 			  and per.oid_peri=tres_per.oid_peri 			  and per.PAIS_OID_PAIS=gen_pais.val_oid 			  and cab.OID_CABE_GRUP_ZONA=gen_grupo.val_oid 			  and cab.OID_CABE_GRUP_ZONA= 1071  		) 	where fecha_prev is not null )a group by a.periodo, 	  a.actividades, 	  a.fecha_prev, 	  a.fecha_fina, 	  a.pais, 	  a.val_anio, 	  a.grupo, 	  a.actividades_i18n order by a.periodo,  a.diasem,a.fecha_prev, a.fecha_fina 