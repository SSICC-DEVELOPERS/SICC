		 SELECT GEN_PAIS.VAL_I18N PAIS, 	   GEN_SOCI.VAL_I18N SOCI, 	   DATOS.VAL_NOMB_PERI, 		DATOS.DES_REGI, 	   DATOS.GRUPO, 	   DATOS.FAC_NOREC_NOPRE, 	   DATOS.FAC_SOLO_PRE, 	   DATOS.FAC_SOLO_REC, 	   DATOS.FAC_PRE_REC FROM ( 	( 	SELECT PAIS_OID_PAIS, 		   SOCI_OID_SOCI, 		   VAL_NOMB_PERI, 		   DES_REGI, 		   'PEDIDOS FACTURADOS' GRUPO, 		   SUM(PED_FAC_NOREC_NOPRE) FAC_NOREC_NOPRE, 		   SUM(PED_FAC_SOLO_PRE) FAC_SOLO_PRE, 		   SUM(PED_FAC_SOLO_REC) FAC_SOLO_REC, 		   SUM(PED_FAC_REC_PRE) FAC_PRE_REC	    	FROM 	( 	 	SELECT PAIS_OID_PAIS, 			   SOCI_OID_SOCI, 			   VAL_NOMB_PERI, 	           DES_REGI,  			    			   SOCA_OID_SOLI_CABE, 			   CASE WHEN(SUM(PED_REC) = 0 AND SUM(PED_INC) = 0) THEN 			   		1 			   ELSE 			   	    0 			   END PED_FAC_NOREC_NOPRE, 			   CASE WHEN(SUM(PED_INC)  >  0 AND SUM(PED_REC) = 0) THEN 			   		1 			   ELSE 			   	    0 			   END PED_FAC_SOLO_PRE, 			   CASE WHEN(SUM(PED_REC)  >  0 AND SUM(PED_INC) = 0) THEN 			   		1 			   ELSE 			   	    0 			   END PED_FAC_SOLO_REC, 			   CASE WHEN((SUM(PED_INC) + SUM(PED_REC) = SUM(TOT_PED)) AND SUM(PED_INC)  >  0 AND SUM(PED_REC)  >  0 ) THEN 			   		1 			   ELSE 			   	    0 			   END PED_FAC_REC_PRE 	 	FROM 	 	    ( 			SELECT SOL_CAB.PAIS_OID_PAIS, 				   SOL_CAB.SOCI_OID_SOCI, 				   PERI.VAL_NOMB_PERI, 				   REG.DES_REGI, 				   SOL_CAB.SOCA_OID_SOLI_CABE, 				   COUNT(SOL_CAB.OID_SOLI_CABE) TOT_PED, 				   NVL(CASE WHEN (MODU.COD_MODU = 15) THEN 				   		COUNT(SOL_CAB.OID_SOLI_CABE) 				   END, 0) PED_REC, 				   NVL(CASE WHEN (MODU.COD_MODU = 13) THEN 				   		COUNT(SOL_CAB.OID_SOLI_CABE) 				   END, 0) PED_INC	   		 			FROM PED_SOLIC_CABEC SOL_CAB, 				 CRA_PERIO PERI, 				 ZON_ZONA ZONA, 				 ZON_REGIO REG, 				 SEG_MODUL MODU, 				 ( 				 SELECT FEC_INIC 				 FROM CRA_PERIO 				 WHERE OID_PERI =  57  				 ) FI, 				 ( 				 SELECT FEC_FINA 				 FROM CRA_PERIO 				 WHERE OID_PERI =  DECODE( -1 ,-1,  57 , -1 )  				 ) FF	  			WHERE PERI.FEC_INIC  > = FI.FEC_INIC 				  AND SOL_CAB.ZZON_OID_ZONA = ZONA.OID_ZONA 				  AND SOL_CAB.PERD_OID_PERI = PERI.OID_PERI 				  AND SOL_CAB.MODU_OID_MODU = MODU.OID_MODU 				  AND REG.OID_REGI = ZONA.ZORG_OID_REGI 				  AND PERI.FEC_FINA  < = FF.FEC_FINA 				  AND SOL_CAB.FEC_FACT IS NOT NULL 				  AND SOL_CAB.IND_TS_NO_CONSO = 1 				  AND PERI.PAIS_OID_PAIS =  1 	  				  AND PERI.CANA_OID_CANA =   1  				  AND PERI.MARC_OID_MARC =  1  				     AND ZONA.ZORG_OID_REGI IN ( 1 )    			GROUP BY SOL_CAB.PAIS_OID_PAIS, 				   SOL_CAB.SOCI_OID_SOCI, 				   SOL_CAB.SBAC_OID_SBAC, 				   SOL_CAB.SOCA_OID_SOLI_CABE, 		   		   REG.DES_REGI, 				   PERI.VAL_NOMB_PERI, 				   MODU.COD_MODU 			) 		GROUP BY PAIS_OID_PAIS, 			   SOCI_OID_SOCI, 			   VAL_NOMB_PERI, 			   SOCA_OID_SOLI_CABE, 	           DES_REGI 	)	   	GROUP BY PAIS_OID_PAIS, 		   SOCI_OID_SOCI, 		   VAL_NOMB_PERI, 		   DES_REGI, 		   'PEDIDOS FACTURADOS' 	)	   	UNION ALL 	( 	SELECT PAIS_OID_PAIS, 		   SOCI_OID_SOCI, 		   VAL_NOMB_PERI, 		   DES_REGI, 		   'PEDIDOS DE SERVICIOS' GRUPO, 		   SUM(PED_REC) SERV_SOLO_REC, 		   SUM(PED_PRE) SERV_SOLO_PREMIOS, 		   SUM(0) SERV_REC_PED_VENT, 		   SUM(0) SERV_PED_FACT	    	FROM 	( 		SELECT SOL_CAB.PAIS_OID_PAIS, 			   SOL_CAB.SOCI_OID_SOCI, 			   PERI.VAL_NOMB_PERI, 			   REG.DES_REGI, 			   NVL(CASE WHEN (MODU.COD_MODU = 15) THEN 			   		COUNT(SOL_CAB.OID_SOLI_CABE) 			   END, 0) PED_REC, 			   NVL(CASE WHEN (MODU.COD_MODU = 13) THEN 			   		COUNT(SOL_CAB.OID_SOLI_CABE) 			   END, 0) PED_PRE	   		 		FROM PED_SOLIC_CABEC SOL_CAB, 			 CRA_PERIO PERI, 			 ZON_REGIO REG, 			 ZON_ZONA ZONA, 			 SEG_MODUL MODU, 			 ( 			 SELECT FEC_INIC 			 FROM CRA_PERIO 			 WHERE OID_PERI =  57  			 ) FI, 			 ( 			 SELECT FEC_FINA 			 FROM CRA_PERIO 			 WHERE OID_PERI = DECODE( -1 ,-1,  57 , -1 ) 			 ) FF	  		WHERE PERI.FEC_INIC  > = FI.FEC_INIC 			  AND SOL_CAB.ZZON_OID_ZONA = ZONA.OID_ZONA 			  AND SOL_CAB.PERD_OID_PERI = PERI.OID_PERI 			  AND SOL_CAB.MODU_OID_MODU = MODU.OID_MODU 			  AND ZONA.ZORG_OID_REGI = REG.OID_REGI 			  AND PERI.FEC_FINA  < = FF.FEC_FINA 			  AND SOL_CAB.FEC_FACT IS NULL 			  AND PERI.PAIS_OID_PAIS =  1 	 			  AND PERI.CANA_OID_CANA =  1  			  AND PERI.MARC_OID_MARC =  1  			     AND ZONA.ZORG_OID_REGI IN ( 1 )    		GROUP BY SOL_CAB.PAIS_OID_PAIS, 			   SOL_CAB.SOCI_OID_SOCI, 			   PERI.VAL_NOMB_PERI, 			   REG.DES_REGI, 			   MODU.COD_MODU 	)	   	GROUP BY PAIS_OID_PAIS, 		   SOCI_OID_SOCI, 		   VAL_NOMB_PERI, 		   DES_REGI, 		   'PEDIDOS DE SERVICIOS' 	)	   ) DATOS, ( SELECT GEN.VAL_OID, GEN.VAL_I18N FROM V_GEN_I18N_SICC GEN WHERE GEN.ATTR_ENTI = 'SEG_PAIS' 	  AND GEN.IDIO_OID_IDIO =  1  ) GEN_PAIS, ( SELECT GEN.VAL_OID, GEN.VAL_I18N FROM V_GEN_I18N_SICC GEN WHERE GEN.ATTR_ENTI = 'SEG_SOCIE' 	  AND GEN.IDIO_OID_IDIO =  1  ) GEN_SOCI WHERE DATOS.PAIS_OID_PAIS = GEN_PAIS.VAL_OID(+) 	  AND DATOS.SOCI_OID_SOCI = GEN_SOCI.VAL_OID(+)   ORDER BY PAIS, 	  	 SOCI, 		 VAL_NOMB_PERI, 		 DES_REGI, 		 GRUPO DESC   